<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Indexing your Data | Couchbase Docs</title>
<link rel="canonical" href="localhost::/5000/couchbase-lite/3.0/android/indexing.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Couchbase Lite database data model concepts - indexes">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="couchbase-lite">
<meta name="dcterms.identifier" content="3.0">
<meta name="generator" content="Antora 2.3.3">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com">
                    <img src="../../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="localhost::/5000/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../../tutorials/index.html">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <form class="navbar-item search">
                  <input type="text" placeholder="Search Docs" class="query" id="search-query" />
                  <button type="button" class="search-btn">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
                <a class="btn btn-primary try-btn" href="https://www.couchbase.com/downloads">
                  Downloads
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<nav class="nav">
<div class="left-sidebar-menu">
<div class="version-control-box">
<div class="component-frame">
<div class="frame-icon">
<img src="../../../_/img/server-icon.png" alt="">
</div>
<div class="frame-body">
<h4 class="title"><span class="">Couchbase Lite</span></h4>
<a class="frame-link component" href="../index.html"> <span class="version">3.0</span></a>
</div>
</div>
</div>
<div class="nav-menu">
<ul class="nav-list">
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../index.html">Introduction</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../cbl-whatsnew.html">What&#8217;s New</a>
</span>
</li>
</ul>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="quickstart.html">Android</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="gs-prereqs.html">Start Here!</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="gs-build.html">Build and Run</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="database.html">Databases</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="prebuilt-database.html">Pre-built Database</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="document.html">Documents</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="blob.html">Blobs</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Queries</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="querybuilder.html">QueryBuilder</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="querybuilder-n1ql.html">N1QL Queries</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="query-live.html">Live Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="query-predictive.html">Predictive Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="query-troubleshooting.html">Query Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="fts.html">Full Text Search</a>
</span>
</li>
<li class="nav-item is-current-page is-active is-active-depth-2  " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="landing-replications.html">Data Sync</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="dbreplica.html">Intra-Device</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="replication.html">Remote Sync Gateway</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="p2psync-websocket.html">Peer-to-Peer</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="p2psync-custom.html">Integrate a Custom Listener</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="conflict.html">Handling Data Conflicts</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="https://ibsoln.github.io/api/mobile/3.0/couchbase-lite-android/">API&#160;References</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="dep-upgrade.html">Upgrade</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="troubleshooting-logs.html">Using Logs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="troubleshooting-queries.html">Troubleshooting Queries</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:android:{cbl-pg-releasenotes}">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="supported-os.html">Supported OS</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../csharp/quickstart.html">C#.Net</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Start Here!</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/gs-build.html">Build and Run</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/database.html">Databases</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/prebuilt-database.html">Pre-built Database</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/document.html">Documents</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/blob.html">Blobs</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Queries</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/querybuilder.html">QueryBuilder</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/querybuilder-n1ql.html">N1QL Queries</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/query-live.html">Live Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/query-predictive.html">Predictive Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/query-troubleshooting.html">Query Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/fts.html">Full Text Search</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../csharp/landing-replications.html">Data Sync</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/dbreplica.html">Intra-Device</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/replication.html">Remote Sync Gateway</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../csharp/p2psync-websocket.html">Peer-to-Peer</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../csharp/p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../csharp/p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../csharp/p2psync-custom.html">Integrate a Custom Listener</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/conflict.html">Handling Data Conflicts</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="https://ibsoln.github.io/api/mobile/3.0/couchbase-lite-net">API&#160;References</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/dep-upgrade.html">Upgrade</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/troubleshooting-logs.html">Using Logs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/troubleshooting-queries.html">Troubleshooting Queries</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:csharp:{cbl-pg-releasenotes}">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../csharp/supported-os.html">Supported OS</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../csharp/refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../clang/quickstart.html">C</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="#{cbl-pg-prereqs}">Start Here!</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-install}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-build}</span>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-database}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-database-prebuilt}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-document}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-blob}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Queries</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{querybuilder&#8212;&#8203;xref}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{querybuilder-n1ql&#8212;&#8203;xref}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-query-live}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-query-predictive}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-query-troubleshooting}</span>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-fts}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{indexing&#8212;&#8203;xref}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="#{cbl-pg-landing-replications}">Data Sync</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#{cbl-pg-dbreplica}">Intra-Device</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#{cbl-pg-replication}">Remote Sync Gateway</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="#{cbl-pg-p2psync-websocket}">Peer-to-Peer</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<span class="nav-text ">{xref-cbl-pg-dbo-p2psync-websocket-using-passive}</span>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<span class="nav-text ">{xref-cbl-pg-dbo-p2psync-websocket-using-active}</span>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="#{cbl-pg-p2psync-custom}">Integrate a Custom Listener</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-conflict}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{url-api-references}[API&#160;References]</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-dep-upgrade}</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-troubleshooting-logs}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-troubleshooting-queries}</span>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-releasenotes}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-compatibility}</span>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="nav-text ">{xref-cbl-pg-supported-os}</span>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">{xref-cbl-pg-refer-glossary}</span>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../java/quickstart.html">Java</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../java/gs-prereqs.html">Start Here!</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/gs-build.html">Build and Run</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/database.html">Databases</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/prebuilt-database.html">Pre-built Database</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/document.html">Documents</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/blob.html">Blobs</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Queries</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/querybuilder.html">QueryBuilder</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/querybuilder-n1ql.html">N1QL Queries</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/query-live.html">Live Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/query-predictive.html">Predictive Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/query-troubleshooting.html">Query Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/fts.html">Full Text Search</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../java/landing-replications.html">Data Sync</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/dbreplica.html">Intra-Device</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/replication.html">Remote Sync Gateway</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../java/p2psync-websocket.html">Peer-to-Peer</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../java/p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../java/p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../java/p2psync-custom.html">Integrate a Custom Listener</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/conflict.html">Handling Data Conflicts</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="https://ibsoln.github.io/api/mobile/3.0/couchbase-lite-java/index.html?">API&#160;References</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/dep-upgrade.html">Upgrade</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/troubleshooting-logs.html">Using Logs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/troubleshooting-queries.html">Troubleshooting Queries</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:java:{cbl-pg-releasenotes}">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../java/supported-os.html">Supported OS</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../java/refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../objc/quickstart.html">Objective-C</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../objc/gs-prereqs.html">Start Here!</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/gs-build.html">Build and Run</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/database.html">Databases</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/prebuilt-database.html">Pre-built Database</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/document.html">Documents</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/blob.html">Blobs</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Queries</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/querybuilder.html">QueryBuilder</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/querybuilder-n1ql.html">N1QL Queries</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/query-live.html">Live Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/query-predictive.html">Predictive Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/query-troubleshooting.html">Query Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/fts.html">Full Text Search</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../objc/landing-replications.html">Data Sync</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/dbreplica.html">Intra-Device</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/replication.html">Remote Sync Gateway</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../objc/p2psync-websocket.html">Peer-to-Peer</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../objc/p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../objc/p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../objc/p2psync-custom.html">Integrate a Custom Listener</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/conflict.html">Handling Data Conflicts</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="https://ibsoln.github.io/api/mobile/3.0/couchbase-lite-objc">API&#160;References</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/dep-upgrade.html">Upgrade</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/troubleshooting-logs.html">Using Logs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/troubleshooting-queries.html">Troubleshooting Queries</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/troubleshooting-crashes.html">Decoding Crash Logs</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:objc:{cbl-pg-releasenotes}">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/compatibility.html">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../objc/supported-os.html">Supported OS</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../objc/refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../swift/quickstart.html">Swift</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../swift/gs-prereqs.html">Start Here!</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/gs-install.html">Install</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/gs-build.html">Build and Run</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/database.html">Databases</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/prebuilt-database.html">Pre-built Database</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/document.html">Documents</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/blob.html">Blobs</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Queries</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/querybuilder.html">QueryBuilder</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/querybuilder-n1ql.html">N1QL Queries</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/query-live.html">Live Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/query-predictive.html">Predictive Query</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/query-troubleshooting.html">Query Troubleshooting</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/fts.html">Full Text Search</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/indexing.html">Indexing</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<a class="nav-link" href="../swift/landing-replications.html">Data Sync</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/dbreplica.html">Intra-Device</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/replication.html">Remote Sync Gateway</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<a class="nav-link" href="../swift/p2psync-websocket.html">Peer-to-Peer</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../swift/p2psync-websocket-using-passive.html">Passive Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../swift/p2psync-websocket-using-active.html">Active Peer</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../swift/p2psync-custom.html">Integrate a Custom Listener</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/conflict.html">Handling Data Conflicts</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="https://ibsoln.github.io/api/mobile/3.0/couchbase-lite-swift">API&#160;References</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/dep-upgrade.html">Upgrade</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Troubleshooting</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/troubleshooting-logs.html">Using Logs</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/troubleshooting-queries.html">Troubleshooting Queries</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift/troubleshooting-crashes.html">Decoding Crash Logs</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:swift:{cbl-pg-releasenotes}">Release Notes</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:swift:compatibility.adoc">Compatibility</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="#couchbase-lite:swift:supported-os.adoc">Supported OS</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../swift/refer-glossary.html">Glossary</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../javascript.html">JavaScript</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../javascript.html">JavaScript</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<a class="nav-link" href="../../../sync-gateway/3.0/introduction.html">Sync&#160;Gateway</a>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../sync-gateway/3.0/configuration-schema-static.html">Configure</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../../sync-gateway/3.0/rest-api-admin.html">REST API</a>
</span>
</li>
</ul>
</li>
</ul>
</div>
<a href="#" class="menu-expand-toggle"> <span>Navigation</span> <i class="fas fa-times-circle"></i> <i class="fas fa-chevron-circle-left"></i></a>
</div></nav>
<aside class="toc sidebar">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/ianbridge/CouchbaseDocs/bau/cbl/modules/android/pages/indexing.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../index.html">Couchbase Lite</a></li>
<li class="crumb"><a href="quickstart.html">Android</a></li>
<li class="crumb"><a href="indexing.html">Indexing</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Indexing your Data</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Description&#8201;&#8212;&#8201;<em>Couchbase Lite database data model concepts - indexes</em><br>
Related Content&#8201;&#8212;&#8201;<a href="database.html" class="page">Databases</a> | <a href="document.html" class="page">Documents</a> | <a href="indexing.html" class="page">Indexing</a> |</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before we begin querying documents, let&#8217;s briefly mention the importance of having an appropriate and balanced approach to indexes.</p>
</div>
<div class="paragraph">
<p>Creating indexes can speed up the performance of queries.
A query will typically return results more quickly if it can take advantage of an existing database index to search, narrowing down the set of documents to be examined.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Constraints</div>
Couchbase Lite for android does not currently support partial value indexes; indexes with non-property expressions.
You should only index with properties that you plan to use in the query.
</td>
</tr>
</table>
</div>
<div class="exampleblock">
<div class="title">Example 1. Creating a new index</div>
<div class="content">
<div class="paragraph">
<p>This example creates a new index for the <code>type</code> and <code>name</code> properties, shown in this data model:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "_id": "hotel123",
    "type": "hotel", <i class="conum" data-value="1"></i><b>(1)</b>
    "name": "Apple Droid"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The code to create the index will look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-Kotlin hljs" data-lang="Kotlin" data-source-url="https://github.com/ibsoln/docs-couchbase-lite/blob/undefined/modules/android/examples/snippets/app/src/main/kotlin/com/couchbase/code_snippets/Examples.kt">            database.createIndex(
                "TypeNameIndex",
                IndexBuilder.valueIndex(
                    ValueIndexItem.property("type"),
                    ValueIndexItem.property("name")
                )
            )
        }
    }

    // ### SELECT statement
    fun testSelectStatement() {
        run {

            val query: Query = QueryBuilder
                .select(
                    SelectResult.expression(Meta.id),
                    SelectResult.property("name"),
                    SelectResult.property("type")
                )
                .from(DataSource.database(database))
                .where(Expression.property("type").equalTo(Expression.string("hotel")))
                .orderBy(Ordering.expression(Meta.id))
            try {
                val rs: ResultSet = query.execute()
                for (result in rs) {
                    Log.i(
                        "Sample",
                        java.lang.String.format("hotel id -&gt; %s", result.getString("id"))
                    )
                    Log.i(
                        "Sample",
                        java.lang.String.format("hotel name -&gt; %s", result.getString("name"))
                    )
                }
            } catch (e: CouchbaseLiteException) {
                Log.e("Sample", e.getLocalizedMessage())
            }
        }
    }

    // META function
    @Throws(CouchbaseLiteException::class)
    fun testMetaFunction() {
        // For Documentation
        run {
            val query: Query = QueryBuilder
                .select(SelectResult.expression(Meta.id))
                .from(DataSource.database(database))
                .where(Expression.property("type").equalTo(Expression.string("airport")))
                .orderBy(Ordering.expression(Meta.id))
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.w(
                    "Sample",
                    java.lang.String.format("airport id -&gt; %s", result.getString("id"))
                )
                Log.w(
                    "Sample",
                    java.lang.String.format("airport id -&gt; %s", result.getString(0))
                )
            }
        }
    }

    // ### all(*)
    @Throws(CouchbaseLiteException::class)
    fun testSelectAll() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))
                .where(Expression.property("type").equalTo(Expression.string("hotel")))

            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))

            // Adds a query change listener.
            // Changes will be posted on the main queue.
            val token: ListenerToken = query.addChangeListener({ change -&gt;
                for (result in change.getResults()) {
                    Log.d(TAG, "results: " + result.getKeys())
                    /* Update UI */
                }
            })

            // Start live query.
            query.execute() <i class="conum" data-value="1"></i><b>(1)</b>

            query.removeChangeListener(token)
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i(
                    "Sample",
                    java.lang.String.format(
                        "hotel -&gt; %s",
                        result.getDictionary(DATABASE_NAME).toMap()
                    )
                )
            }
        }
    }

    // ###　WHERE statement
    @Throws(CouchbaseLiteException::class)
    fun testWhereStatement() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))
                .where(Expression.property("type").equalTo(Expression.string("hotel")))
                .limit(Expression.intValue(10))
            val rs: ResultSet = query.execute()
            for (result in rs) {
                val all: Dictionary = result.getDictionary(DATABASE_NAME)
                Log.i(
                    "Sample",
                    java.lang.String.format("name -&gt; %s", all.getString("name"))
                )
                Log.i(
                    "Sample",
                    java.lang.String.format("type -&gt; %s", all.getString("type"))
                )
            }
        }
    }

    fun testQueryDeletedDocuments() {
        // Query documents that have been deleted
        val query: Where = QueryBuilder
            .select(SelectResult.expression(Meta.id))
            .from(DataSource.database(database))
            .where(Meta.deleted)
    }

    // ####　Collection Operators
    @Throws(CouchbaseLiteException::class)
    fun testCollectionStatement() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(
                    SelectResult.expression(Meta.id),
                    SelectResult.property("name"),
                    SelectResult.property("public_likes")
                )
                .from(DataSource.database(database))
                .where(
                    Expression.property("type").equalTo(Expression.string("hotel"))
                        .and(
                            ArrayFunction
                                .contains(
                                    Expression.property("public_likes"),
                                    Expression.string("Armani Langworth")
                                )
                        )
                )
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i(
                    "Sample",
                    java.lang.String.format(
                        "public_likes -&gt; %s",
                        result.getArray("public_likes").toList()
                    )
                )
            }
        }
    }

    // IN operator
    @Throws(CouchbaseLiteException::class)
    fun testInOperator() {
        // For Documentation
        run {

            val values: Array&lt;Expression&gt; = arrayOf&lt;Expression&gt;(
                Expression.property("first"),
                Expression.property("last"),
                Expression.property("username")
            )
            val query: Query = QueryBuilder.select(SelectResult.all())
                .from(DataSource.database(database))
                .where(Expression.string("Armani").`in`(values))
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.w(
                    "Sample",
                    java.lang.String.format("%s", result.toMap().toString())
                )
            }
        }
    }

    // Pattern Matching
    @Throws(CouchbaseLiteException::class)
    fun testPatternMatching() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(
                    SelectResult.expression(Meta.id),
                    SelectResult.property("country"),
                    SelectResult.property("name")
                )
                .from(DataSource.database(database))
                .where(
                    Expression.property("type").equalTo(Expression.string("landmark"))
                        .and(
                            Function.lower(Expression.property("name"))
                                .like(Function.Expression.string("royal engineers museum"))
                        )
                )
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i(
                    "Sample",
                    java.lang.String.format("name -&gt; %s", result.getString("name"))
                )
            }
        }
    }

    // ### Wildcard Match
    @Throws(CouchbaseLiteException::class)
    fun testWildcardMatch() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(
                    SelectResult.expression(Meta.id),
                    SelectResult.property("country"),
                    SelectResult.property("name")
                )
                .from(DataSource.database(database))
                .where(
                    Expression.property("type").equalTo(Expression.string("landmark"))
                        .and(
                            Function.lower(Expression.property("name"))
                                .like(Expression.string("eng%e%"))
                        )
                )
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i(
                    "Sample",
                    java.lang.String.format("name -&gt; %s", result.getString("name"))
                )
            }
        }
    }

    // Wildcard Character Match
    @Throws(CouchbaseLiteException::class)
    fun testWildCharacterMatch() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(
                    SelectResult.expression(Meta.id),
                    SelectResult.property("country"),
                    SelectResult.property("name")
                )
                .from(DataSource.database(database))
                .where(
                    Expression.property("type").equalTo(Expression.string("landmark"))
                        .and(
                            Function.lower(Expression.property("name"))
                                .like(Expression.string("eng____r"))
                        )
                )
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i(
                    "Sample",
                    java.lang.String.format("name -&gt; %s", result.getString("name"))
                )
            }
        }
    }

    // ### Regex Match
    @Throws(CouchbaseLiteException::class)
    fun testRegexMatch() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(
                    SelectResult.expression(Meta.id),
                    SelectResult.property("country"),
                    SelectResult.property("name")
                )
                .from(DataSource.database(database))
                .where(
                    Expression.property("type").equalTo(Expression.string("landmark"))
                        .and(
                            Function.lower(Expression.property("name"))
                                .regex(Expression.string("\\beng.*r\\b"))
                        )
                )
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i(
                    "Sample",
                    java.lang.String.format("name -&gt; %s", result.getString("name"))
                )
            }
        }
    }

    // JOIN statement
    @Throws(CouchbaseLiteException::class)
    fun testJoinStatement() {
        // For Documentation
        run {

            val query: Query = QueryBuilder.select(
                SelectResult.expression(Expression.property("name").from("airline")),
                SelectResult.expression(Expression.property("callsign").from("airline")),
                SelectResult.expression(Expression.property("destinationairport").from("route")),
                SelectResult.expression(Expression.property("stops").from("route")),
                SelectResult.expression(Expression.property("airline").from("route"))
            )
                .from(DataSource.database(database).`as`("airline"))
                .join(
                    Join.join(DataSource.database(database).`as`("route"))
                        .on(
                            Meta.id.from("airline")
                                .equalTo(Expression.property("airlineid").from("route"))
                        )
                )
                .where(
                    Expression.property("type").from("route").equalTo(Expression.string("route"))
                        .and(
                            Expression.property("type").from("airline")
                                .equalTo(Expression.string("airline"))
                        )
                        .and(
                            Expression.property("sourceairport").from("route")
                                .equalTo(Expression.string("RIX"))
                        )
                )
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.w(
                    "Sample",
                    java.lang.String.format("%s", result.toMap().toString())
                )
            }
        }
    }

    // ### GROUPBY statement
    @Throws(CouchbaseLiteException::class)
    fun testGroupByStatement() {
        // For Documentation
        run {

            val query: Query = QueryBuilder.select(
                SelectResult.expression(Function.count(Expression.string("*"))),
                SelectResult.property("country"),
                SelectResult.property("tz")
            )
                .from(DataSource.database(database))
                .where(
                    Expression.property("type").equalTo(Expression.string("airport"))
                        .and(
                            Expression.property("geo.alt")
                                .greaterThanOrEqualTo(Expression.intValue(300))
                        )
                )
                .groupBy(
                    Expression.property("country"),
                    Expression.property("tz")
                )
                .orderBy(Ordering.expression(Function.count(Expression.string("*"))).descending())
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i(
                    "Sample",
                    java.lang.String.format(
                        "There are %d airports on the %s timezone located in %s and above 300ft",
                        result.getInt("$1"),
                        result.getString("tz"),
                        result.getString("country")
                    )
                )
            }
        }
    }

    // ### ORDER BY statement
    @Throws(CouchbaseLiteException::class)
    fun testOrderByStatement() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(
                    SelectResult.expression(Meta.id),
                    SelectResult.property("name")
                )
                .from(DataSource.database(database))
                .where(Expression.property("type").equalTo(Expression.string("hotel")))
                .orderBy(Ordering.property("name").ascending())
                .limit(Expression.intValue(10))
            val rs: ResultSet = query.execute()
            for (result in rs) {
                Log.i("Sample", java.lang.String.format("%s", result.toMap()))
            }
        }
    }

    // ### EXPLAIN statement
    @Throws(CouchbaseLiteException::class)
    fun testExplainStatement() {
        // For Documentation
        run {

            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))
                .where(Expression.property("type").equalTo(Expression.string("university")))
                .groupBy(Expression.property("country"))
                .orderBy(Ordering.property("name").descending()) <i class="conum" data-value="1"></i><b>(1)</b>
            Log.i(query.explain()) <i class="conum" data-value="2"></i><b>(2)</b>
            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))
                .where(Expression.property("type").like(Expression.string("%hotel%"))) <i class="conum" data-value="3"></i><b>(3)</b>
            Log.i(query.explain())
            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))
                .where(
                    Expression.property("type").like(Expression.string("hotel%")) <i class="conum" data-value="4"></i><b>(4)</b>
                        .and(Expression.property("name").like(Expression.string("%royal%")))
                )
            Log.i(query.explain())
            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))
                .where(
                    Function.lower(
                        Expression.property("type").equalTo(Expression.string("hotel"))
                    )
                ) <i class="conum" data-value="5"></i><b>(5)</b>
            Log.i(query.explain())
            val query: Query = QueryBuilder
                .select(SelectResult.all())
                .from(DataSource.database(database))
                .where(Expression.property("type").equalTo(Expression.string("hotel"))) <i class="conum" data-value="6"></i><b>(6)</b>
            Log.i(query.explain())
        }
    }

    // end query-explain
    @Throws(CouchbaseLiteException::class)
    fun prepareIndex() {
        database.createIndex(
            "nameFTSIndex",
            IndexBuilder.fullTextIndex(FullTextIndexItem.property("name")).ignoreAccents(false)
        )
    }

    @Throws(CouchbaseLiteException::class)
    fun testFTS() {
        val whereClause: Expression = FullTextExpression.index("nameFTSIndex").match("buy")
        val ftsQuery: Query = QueryBuilder.select(SelectResult.expression(Meta.id))
            .from(DataSource.database(database))
            .where(whereClause)
        val ftsQueryResult: ResultSet = ftsQuery.execute()
        for (result in ftsQueryResult) {
            Log.i(
                TAG,
                java.lang.String.format("document properties %s", result.getString(0))
            )
        }
    }

    /* The `tag::replication[]` example is inlined in java.adoc */
    fun testTroubleshooting() {
        Database.setLogLevel(LogDomain.REPLICATOR, LogLevel.VERBOSE)
    }

    @Throws(URISyntaxException::class)
    fun testReplicationBasicAuthentication() {
        val target = URLEndpoint(URI("ws://localhost:4984/mydatabase"))
        val config = ReplicatorConfiguration(database, target)
        config.setAuthenticator(BasicAuthenticator("username", "password"))

        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)
        replicator.start()
    }

    @Throws(URISyntaxException::class)
    fun testReplicationSessionAuthentication() {
        val target = URLEndpoint(URI("ws://localhost:4984/mydatabase"))
        val config = ReplicatorConfiguration(database, target)
        config.setAuthenticator(SessionAuthenticator("904ac010862f37c8dd99015a33ab5a3565fd8447"))

        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)
        replicator.start()
    }

    @Throws(URISyntaxException::class)
    fun testReplicationStatus() {
        val uri = URI("ws://localhost:4984/db")
        val endpoint: Endpoint = URLEndpoint(uri)
        val config = ReplicatorConfiguration(database, endpoint)
        config.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PULL)
        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)

        replicator.addChangeListener({ change -&gt;
            if (change.getStatus().getActivityLevel() === Replicator.ActivityLevel.STOPPED) {
                Log.i(TAG, "Replication stopped")
            }
        })
    }

    internal inner class PendingDocsExample {
        private val database: Database? = null
        private var replicator: Replicator? = null

        //  BEGIN PendingDocuments IB -- 11/Feb/21 --
        @Throws(URISyntaxException::class, CouchbaseLiteException::class)
        fun testReplicationPendingDocs() {
            // ... include other code as required
            //
            val endpoint: Endpoint = URLEndpoint(URI("ws://localhost:4984/db"))
            val config: ReplicatorConfiguration = ReplicatorConfiguration(database, endpoint)
                .setReplicatorType(ReplicatorConfiguration.ReplicatorType.PUSH)
            replicator = Replicator(config)
            val pendingDocs: Set&lt;String&gt; = replicator.getPendingDocumentIds() <i class="conum" data-value="7"></i><b>(7)</b>

            replicator.addChangeListener({ change -&gt;
                onStatusChanged(
                    pendingDocs,
                    change.getStatus()
                )
            })
            replicator.start()

            // ... include other code as required
        }

        //
        //
        private fun onStatusChanged(
            @NonNull pendingDocs: Set&lt;String&gt;,
            @NonNull status: Replicator.Status
        ) {
            // ... sample onStatusChanged function
            //
            Log.i(
                Companion.TAG,
                "Replicator activity level is " + status.getActivityLevel().toString()
            )

            // iterate and report-on previously
            // retrieved pending docids 'list'
            val itr = pendingDocs.iterator()
            while (itr.hasNext()) {
                val docId = itr.next()
                try {
                    if (!replicator.isDocumentPending(docId)) {
                        continue
                    } <i class="conum" data-value="8"></i><b>(8)</b>
                    itr.remove()
                    Log.i(
                        Companion.TAG,
                        "Doc ID $docId has been pushed"
                    )
                } catch (e: CouchbaseLiteException) {
                    Log.w(
                        Companion.TAG,
                        "isDocumentPending failed",
                        e
                    )
                }
            }

        //  END PendingDocuments BM -- 19/Feb/21 --
        companion object {
            private const val TAG = "SCRATCH"
        }
    }

    @Throws(URISyntaxException::class)
    fun testHandlingNetworkErrors() {
        val endpoint: Endpoint = URLEndpoint(URI("ws://localhost:4984/db"))
        val config = ReplicatorConfiguration(database, endpoint)
        config.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PULL)
        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)

        replicator.addChangeListener({ change -&gt;
            val error: CouchbaseLiteException = change.getStatus().getError()
            if (error != null) {
                Log.w(TAG, "Error code:: %d", error)
            }
        })
        replicator.start()
        replicator.stop()
    }

    @Throws(URISyntaxException::class)
    fun testReplicatorDocumentEvent() {
        val endpoint: Endpoint = URLEndpoint(URI("ws://localhost:4984/db"))
        val config = ReplicatorConfiguration(database, endpoint)
        config.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PULL)
        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)

        val token: ListenerToken = replicator.addDocumentReplicationListener({ replication -&gt;
            if (replication.isPush()) Log.i(
                TAG,
                "Replication type: " + "Push"
            ) else Log.i(TAG, "Replication type: " + "Pull")
            for (document in replication.getDocuments()) {
                Log.i(TAG, "Doc ID: " + document.getID())
                val err: CouchbaseLiteException = document.getError()
                if (err != null) {
                    // There was an error
                    Log.e(TAG, "Error replicating document: ", err)
                    return@addDocumentReplicationListener
                }
                if (document.flags().contains(DocumentFlag.DocumentFlagsDeleted)) {
                    Log.i(
                        TAG,
                        "Successfully replicated a deleted document"
                    )
                }
            }
        })
        replicator.start()

        replicator.removeChangeListener(token)
    }

    @Throws(URISyntaxException::class)
    fun testReplicationCustomHeader() {
        val uri = URI("ws://localhost:4984/db")
        val endpoint: Endpoint = URLEndpoint(uri)

        val config = ReplicatorConfiguration(database, endpoint)
        val headers: MutableMap&lt;String, String&gt; =
            HashMap()
        headers["CustomHeaderName"] = "Value"
        config.setHeaders(headers)
    }

    // ### Certificate Pinning
    @Throws(URISyntaxException::class, IOException::class)
    fun testCertificatePinning() {
        val uri = URI("ws://localhost:4984/db")
        val endpoint: Endpoint = URLEndpoint(uri)
        val config = ReplicatorConfiguration(database, endpoint)

        val `is`: InputStream = getAsset("cert.cer")
        val cert: ByteArray = IOUtils.toByteArray(`is`)
        if (`is` != null) {
            try {
                `is`.close()
            } catch (ignore: IOException) {
            }
        }
        config.setPinnedServerCertificate(cert)
    }

    // ### Reset replicator checkpoint
    @Throws(URISyntaxException::class)
    fun testReplicationResetCheckpoint() {
        val uri = URI("ws://localhost:4984/db")
        val endpoint: Endpoint = URLEndpoint(uri)
        val config = ReplicatorConfiguration(database, endpoint)
        config.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PULL)
        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)
        replicator.start()

        replicator.resetCheckpoint()
        replicator.start()
        replicator.stop()
    }

    @Throws(URISyntaxException::class)
    fun testReplicationPushFilter() {
        val target = URLEndpoint(URI("ws://localhost:4984/mydatabase"))
        val config = ReplicatorConfiguration(database, target)
        config.setPushFilter({ document, flags -&gt; flags.contains(DocumentFlag.DocumentFlagsDeleted) }) <i class="conum" data-value="1"></i><b>(1)</b>

        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)
        replicator.start()
    }

    @Throws(URISyntaxException::class)
    fun testReplicationPullFilter() {
        val target = URLEndpoint(URI("ws://localhost:4984/mydatabase"))
        val config = ReplicatorConfiguration(database, target)
        config.setPullFilter({ document, flags -&gt; "draft" == document.getString("type") }) <i class="conum" data-value="1"></i><b>(1)</b>

        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(config)
        replicator.start()
    }

    @Throws(URISyntaxException::class)
    fun testCustomRetryConfig() {
        val target = URLEndpoint(URI("ws://localhost:4984/mydatabase"))
        val config = ReplicatorConfiguration(database, target)

        //  other config as required . . .
        config.setHeartbeat(150L) <i class="conum" data-value="9"></i><b>(9)</b>
        config.setMaxRetries(20L) <i class="conum" data-value="10"></i><b>(10)</b>
        config.setMaxRetryWaitTime(600L) <i class="conum" data-value="11"></i><b>(11)</b>
        val repl = Replicator(config)

    }

    @Throws(CouchbaseLiteException::class)
    fun testDatabaseReplica() {
        var config: DatabaseConfiguration? = DatabaseConfiguration()
        val database1 = Database("mydb", config)
        config = DatabaseConfiguration()
        val database2 = Database("db2", config)

        /* EE feature: code below might throw a compilation error
           if it's compiled against CBL Android Community. */
        val targetDatabase = DatabaseEndpoint(database2)
        val replicatorConfig =
            ReplicatorConfiguration(database1, targetDatabase)
        replicatorConfig.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PUSH)

        // Create replicator (be sure to hold a reference somewhere that will prevent the Replicator from being GCed)
        replicator = Replicator(replicatorConfig)
        replicator.start()
    }

    @Throws(CouchbaseLiteException::class)
    fun testPredictiveModel() {
        val config = DatabaseConfiguration()
        val database = Database("mydb", config)

        Database.prediction.registerModel("ImageClassifier", ImageClassifierModel())

        val index: ValueIndex =
            IndexBuilder.valueIndex(ValueIndexItem.expression(Expression.property("label")))
        database.createIndex("value-index-image-classifier", index)

        Database.prediction.unregisterModel("ImageClassifier")
    }

    @Throws(CouchbaseLiteException::class)
    fun testPredictiveIndex() {
        val config = DatabaseConfiguration()
        val database = Database("mydb", config)

        val inputMap: MutableMap&lt;String, Any&gt; =
            HashMap()
        inputMap["numbers"] = Expression.property("photo")
        val input: Expression = Expression.map(inputMap)
        val index: PredictiveIndex = IndexBuilder.predictiveIndex("ImageClassifier", input, null)
        database.createIndex("predictive-index-image-classifier", index)
    }

    @Throws(CouchbaseLiteException::class)
    fun testPredictiveQuery() {
        val config = DatabaseConfiguration()
        val database = Database("mydb", config)

        val inputProperties: MutableMap&lt;String, Any&gt; =
            HashMap()
        inputProperties["photo"] = Expression.property("photo")
        val input: Expression = Expression.map(inputProperties)
        val prediction: PredictionFunction =
            PredictiveModel.predict("ImageClassifier", input) <i class="conum" data-value="1"></i><b>(1)</b>
        val query: Query = QueryBuilder
            .select(SelectResult.all())
            .from(DataSource.database(database))
            .where(
                Expression.property("label").equalTo(Expression.string("car"))
                    .and(
                        Expression.property("probability")
                            .greaterThanOrEqualTo(Expression.doubleValue(0.8))
                    )
            )

        // Run the query.
        val result: ResultSet = query.execute()
        Log.d(TAG, "Number of rows: " + result.allResults().size())
    }

    @Throws(URISyntaxException::class)
    fun testReplicationWithCustomConflictResolver() {
        val target = URLEndpoint(URI("ws://localhost:4984/mydatabase"))
        val config = ReplicatorConfiguration(database, target)
        config.setConflictResolver(LocalWinConflictResolver())
        val replication = Replicator(config)
        replication.start()
    }

    @Throws(CouchbaseLiteException::class)
    fun testSaveWithCustomConflictResolver() {
        val doc: Document = database.getDocument("xyz") ?: return
        val mutableDocument: MutableDocument = doc.toMutable()
        mutableDocument.setString("name", "apples")
        database.save(
            mutableDocument,
            { newDoc, curDoc -&gt;  <i class="conum" data-value="12"></i><b>(12)</b>
                if (curDoc == null) {
                    return@save false
                } <i class="conum" data-value="13"></i><b>(13)</b>
                val dataMap: MutableMap&lt;String, Any&gt; =
                    curDoc.toMap()
                dataMap.putAll(newDoc.toMap()) <i class="conum" data-value="14"></i><b>(14)</b>
                newDoc.setData(dataMap)
                true <i class="conum" data-value="15"></i><b>(15)</b>
            }) <i class="conum" data-value="16"></i><b>(16)</b>
    }

    companion object {
        private const val TAG = "EXAMPLE"
        private const val DATABASE_NAME = "database"
    }


// Using replConfig.setConflictResolver(new LocalWinConflictResolver());
internal class LocalWinConflictResolver : ConflictResolver {
    fun resolve(conflict: Conflict): Document {
        return conflict.getLocalDocument()
    }

// Using replConfig.setConflictResolver(new RemoteWinConflictResolver());
internal class RemoteWinConflictResolver : ConflictResolver {
    fun resolve(conflict: Conflict): Document {
        return conflict.getRemoteDocument()
    }

// Using replConfig.setConflictResolver(new MergeConflictResolver());
internal class MergeConflictResolver : ConflictResolver {
    fun resolve(conflict: Conflict): Document {
        val merge: MutableMap&lt;String, Any&gt; =
            conflict.getLocalDocument().toMap()
        merge.putAll(conflict.getRemoteDocument().toMap())
        return MutableDocument(conflict.getDocumentId(), merge)
    }

/* ----------------------------------------------------------- */ /* ---------------------  ACTIVE SIDE  ----------------------- */ /* ----------------------------------------------------------- */
internal class BrowserSessionManager private constructor(private val context: Context) :
    MessageEndpointDelegate {
    private var replicator: Replicator? = null

    @Throws(CouchbaseLiteException::class)
    fun initCouchbase() {
        val databaseConfiguration = DatabaseConfiguration(context)
        val database = Database("mydb", databaseConfiguration)

        // The delegate must implement the `MessageEndpointDelegate` protocol.
        val messageEndpointTarget = MessageEndpoint(
            "UID:123",
            "active",
            ProtocolType.MESSAGE_STREAM,
            this
        )

        val config =
            ReplicatorConfiguration(database, messageEndpointTarget)

        // Create the replicator object.
        replicator = Replicator(config)
        // Start the replication.
        replicator.start()
    }

    /* implementation of MessageEndpointDelegate */
    @NonNull
    fun createConnection(@NonNull endpoint: MessageEndpoint?): MessageEndpointConnection {
        return ActivePeerConnection() /* implements MessageEndpointConnection */

}

internal class ActivePeerConnection : MessageEndpointConnection {
    private var replicatorConnection: ReplicatorConnection? = null
    fun disconnect() {
        replicatorConnection.close(null)
    }

    /* implementation of MessageEndpointConnection */
    fun open(
        @NonNull connection: ReplicatorConnection?,
        @NonNull completion: MessagingCompletion
    ) {
        replicatorConnection = connection
        completion.complete(true, null)
    }

    fun close(
        error: Exception?,
        @NonNull completion: MessagingCloseCompletion
    ) {
        /* disconnect with communications framework */
        /* ... */
        /* call completion handler */
        completion.complete()
    }

    /* implementation of MessageEndpointConnection */
    fun send(@NonNull message: Message?, @NonNull completion: MessagingCompletion) {
        /* send the data to the other peer */
        /* ... */
        /* call the completion handler once the message is sent */
        completion.complete(true, null)
    }

    fun receive(message: Message?) {
        replicatorConnection.receive(message)
    }
} /* ----------------------------------------------------------- */ /* ---------------------  PASSIVE SIDE  ---------------------- */ /* ----------------------------------------------------------- */

internal class PassivePeerConnection private constructor(private val context: Context) :
    MessageEndpointConnection {
    private var messageEndpointListener: MessageEndpointListener? = null
    private var replicatorConnection: ReplicatorConnection? = null

    @Throws(CouchbaseLiteException::class)
    fun startListener() {
        val databaseConfiguration = DatabaseConfiguration()
        val database = Database("mydb", databaseConfiguration)
        val listenerConfiguration =
            MessageEndpointListenerConfiguration(
                database,
                ProtocolType.MESSAGE_STREAM
            )
        messageEndpointListener = MessageEndpointListener(listenerConfiguration)
    }

    fun stopListener() {
        messageEndpointListener.closeAll()
    }

    fun accept() {
        val connection = PassivePeerConnection(context) /* implements
        MessageEndpointConnection */
        messageEndpointListener.accept(connection)
    }

    fun disconnect() {
        replicatorConnection.close(null)
    }

    /* implementation of MessageEndpointConnection */
    fun open(
        @NonNull connection: ReplicatorConnection?,
        @NonNull completion: MessagingCompletion
    ) {
        replicatorConnection = connection
        completion.complete(true, null)
    }

    /* implementation of MessageEndpointConnection */
    fun close(
        error: Exception?,
        @NonNull completion: MessagingCloseCompletion
    ) {
        /* disconnect with communications framework */
        /* ... */
        /* call completion handler */
        completion.complete()
    }

    /* implementation of MessageEndpointConnection */
    fun send(@NonNull message: Message?, @NonNull completion: MessagingCompletion) {
        /* send the data to the other peer */
        /* ... */
        /* call the completion handler once the message is sent */
        completion.complete(true, null)
    }

    fun receive(message: Message?) {
        replicatorConnection.receive(message)
    }


// `tensorFlowModel` is a fake implementation
// this would be the implementation of the ml model you have chosen
internal class ImageClassifierModel : PredictiveModel {
    fun predict(@NonNull input: Dictionary): Dictionary? {
        val blob: Blob = input.getBlob("photo") ?: return null

        // `tensorFlowModel` is a fake implementation
        // this would be the implementation of the ml model you have chosen
        return MutableDictionary(TensorFlowModel.predictImage(blob.getContent())) <i class="conum" data-value="1"></i><b>(1)</b>
    }
}

internal object TensorFlowModel {
    fun predictImage(data: ByteArray?): Map&lt;String, Any&gt;? {
        return null
    }

internal class LogTestLogger(@NonNull level: LogLevel) : Logger {
    @NonNull
    private val level: LogLevel

    @NonNull
    fun getLevel(): LogLevel {
        return level
    }

    fun log(
        @NonNull level: LogLevel?,
        @NonNull domain: LogDomain?,
        @NonNull message: String?
    ) {
        // this method will never be called if param level &lt; this.level
        // handle the message, for example piping it to a third party framework
    }

    init {
        this.level = level
    }
}

class CertAuthListener {
    companion object {
        private const val TAG = "PWD"
        private var CERT_ATTRIBUTES: Map&lt;String, String&gt;? = null

        init {
            val m: Map&lt;String, String&gt; =
                HashMap()
            com.couchbase.code_snippets.m.put(TLSIdentity.CERT_ATTRIBUTE_COMMON_NAME, "CBL Test")
            com.couchbase.code_snippets.m.put(TLSIdentity.CERT_ATTRIBUTE_ORGANIZATION, "Couchbase")
            com.couchbase.code_snippets.m.put(
                TLSIdentity.CERT_ATTRIBUTE_ORGANIZATION_UNIT,
                "Mobile"
            )
            com.couchbase.code_snippets.m.put(
                TLSIdentity.CERT_ATTRIBUTE_EMAIL_ADDRESS,
                "lite@couchbase.com"
            )
            CERT_ATTRIBUTES =
                Collections.unmodifiableMap(com.couchbase.code_snippets.m)
        }
    }

    // start a server and connect to it with a replicator
    @Throws(CouchbaseLiteException::class, IOException::class)
    fun run() {
        val localDb = Database("localDb")
        var doc = MutableDocument()
        doc.setString("dog", "woof")
        localDb.save(doc)
        val remoteDb = Database("remoteDb")
        doc = MutableDocument()
        doc.setString("cat", "meow")
        localDb.save(doc)
        val serverIdentity: TLSIdentity = TLSIdentity.createIdentity(
            true,
            CERT_ATTRIBUTES,
            null,
            "server"
        )
        val clientIdentity: TLSIdentity = TLSIdentity.createIdentity(
            false,
            CERT_ATTRIBUTES,
            null,
            "client"
        )
        val uri = startServer(remoteDb, serverIdentity, clientIdentity.getCerts())
            ?: throw IOException("Failed to start the server")
        Thread(Runnable {
            try {
                startClient(uri, serverIdentity.getCerts().get(0), clientIdentity, localDb)
                Log.e(TAG, "Success!!")
                deleteIdentity("server")
                Log.e(TAG, "Alias deleted: server")
                deleteIdentity("client")
                Log.e(TAG, "Alias deleted: client")
            } catch (e: Exception) {
                Log.e(TAG, "Failed!!", e)
            }
        }).start()
    }

    // start a client replicator
    @Throws(CertificateEncodingException::class, InterruptedException::class)
    fun startClient(
        @NonNull uri: URI?,
        @NonNull cert: Certificate,
        @NonNull clientIdentity: TLSIdentity,
        @NonNull db: Database?
    ) {
        val config = ReplicatorConfiguration(db, URLEndpoint(uri))
        config.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PUSH_AND_PULL)
        config.setContinuous(false)
        configureClientCerts(config, cert, clientIdentity)
        val completionLatch = CountDownLatch(1)
        val repl = Replicator(config)
        repl.addChangeListener({ change -&gt;
            if (change.getStatus()
                    .getActivityLevel() === AbstractReplicator.ActivityLevel.STOPPED
            ) {
                completionLatch.countDown()
            }
        })
        repl.start(false)
        completionLatch.await()
    }
    /**
     * Snippet 2: create a ListenerCertificateAuthenticator and configure the listener with it
     *
     *
     * Start a listener for db that accepts connections from a client identified by any of the passed certs
     *
     * @param db    the database to which the listener is attached
     * @param certs the name of the single valid user
     * @return the url at which the listener can be reached.
     * @throws CouchbaseLiteException on failure
     */
    @Nullable
    @Throws(CouchbaseLiteException::class)
    fun startServer(
        @NonNull db: Database?,
        @NonNull serverId: TLSIdentity?,
        @NonNull certs: List&lt;Certificate?&gt;?
    ): URI? {
        val config = URLEndpointListenerConfiguration(db)
        config.setPort(0) // this is the default
        config.setDisableTls(false)
        config.setTlsIdentity(serverId)
        config.setAuthenticator(ListenerCertificateAuthenticator(certs))
        val listener = URLEndpointListener(config)
        listener.start()
        val urls: List&lt;URI&gt; = listener.getUrls()
        return if (urls.isEmpty()) {
            null
        } else urls[0]
    }
    /**
     * Delete an identity from the keystore
     *
     * @param alias the alias for the identity to be deleted
     */
    @Throws(
        KeyStoreException::class,
        CertificateException::class,
        NoSuchAlgorithmException::class,
        IOException::class
    )
    fun deleteIdentity(alias: String?) {
        val keyStore: KeyStore = KeyStore.getInstance("AndroidKeyStore")
        keyStore.load(null)
        keyStore.deleteEntry(alias) <i class="conum" data-value="17"></i><b>(17)</b>
    }
    /**
     * Snippet 4: Create a ClientCertificateAuthenticator and use it in a replicator
     * Snippet 5: Specify a pinned certificate as a byte array
     *
     *
     * Configure Client (active) side certificates
     *
     * @param config         The replicator configuration
     * @param cert           The expected server side certificate
     * @param clientIdentity the identity offered to the server as authentication
     * @throws CertificateEncodingException on certifcate encoding error
     */
    @Throws(CertificateEncodingException::class)
    private fun configureClientCerts(
        config: ReplicatorConfiguration,
        @NonNull cert: Certificate,
        @NonNull clientIdentity: TLSIdentity
    ) {

        // Snippet 4: create an authenticator that provides the client identity
        config.setAuthenticator(ClientCertificateAuthenticator(clientIdentity))

        // Configure the pinned certificate passing a byte array.
        config.setPinnedServerCertificate(cert.getEncoded())
    }
    /**
     * Snippet 5 (supplement): Copy a cert from a resource bundle
     *
     *
     * Configure Client (active) side certificates
     *
     * @param context Android context
     * @param resId   resource id for resource: R.id.foo
     * @throws IOException on copy error
     */
    @Throws(IOException::class)
    private fun readCertMaterialFromBundle(
        @NonNull context: Context,
        resId: Int
    ): ByteArray {
        val out = ByteArrayOutputStream()
        val `in` = context.resources.openRawResource(resId)
        val buf = ByteArray(1024)
        var n: Int
        while (`in`.read(buf).also { n = it } &gt;= 0) {
            out.write(buf, 0, n)
        }
        return out.toByteArray()
    }
}

class PasswordAuthListener {
    // start a server and connect to it with a replicator
    @Throws(CouchbaseLiteException::class, IOException::class)
    fun run() {
        val localDb = Database("localDb")
        var doc = MutableDocument()
        doc.setString("dog", "woof")
        localDb.save(doc)
        val remoteDb = Database("remoteDb")
        doc = MutableDocument()
        doc.setString("cat", "meow")
        localDb.save(doc)
        val uri = startServer(remoteDb, "fox", "wa-pa-pa-pa-pa-pow".toCharArray())
            ?: throw IOException("Failed to start the server")
        Thread(Runnable {
            try {
                runClient(uri, "fox", "wa-pa-pa-pa-pa-pow".toCharArray(), localDb)
                Log.e(TAG, "Success!!")
            } catch (e: Exception) {
                Log.e(TAG, "Failed!!", e)
            }
        }).start()
    }

    // start a client replicator
    @Throws(InterruptedException::class)
    fun runClient(
        @NonNull uri: URI?,
        @NonNull username: String?,
        @NonNull password: CharArray?,
        @NonNull db: Database?
    ) {
        val config = ReplicatorConfiguration(db, URLEndpoint(uri))
        config.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PUSH_AND_PULL)
        config.setContinuous(false)
        config.setAuthenticator(BasicAuthenticator(username, password))
        val completionLatch = CountDownLatch(1)
        val repl = Replicator(config)
        repl.addChangeListener({ change -&gt;
            if (change.getStatus()
                    .getActivityLevel() === AbstractReplicator.ActivityLevel.STOPPED
            ) {
                completionLatch.countDown()
            }
        })
        repl.start(false)
        completionLatch.await()
    }
    /**
     *
     * Start a listener for db that accepts connections using exactly the passed username and password
     *
     *
     * @param db       the database to which the listener is attached
     * @param username the name of the single valid user
     * @param password the password for the user
     * @return the url at which the listener can be reached.
     * @throws CouchbaseLiteException on failure
     */
    @Nullable
    fun startServer(
        @NonNull db: Database?,
        @NonNull username: String?,
        @NonNull password: CharArray?
    ): URI?

    companion object {
        private const val TAG = "PWD"
    }

    init {
        val config = URLEndpointListenerConfiguration(db)
        config.setPort(0) // this is the default
        config.setDisableTls(true)
        config.setAuthenticator(
            ListenerPasswordAuthenticator { validUser, pwd -&gt;
                username.equals(validUser) &amp;&amp; Arrays.equals(
                    validPassword,
                    pwd
                )
            }
        )
        val listener = URLEndpointListener(config)
        listener.start()
        val urls: List&lt;URI&gt; = listener.getUrls()
        return if (urls.isEmpty()) {
            null
        } else urls[0]
    }
}


class ExamplesP2p(private val context: Context) {
    private val database: Database? = null
    private var replicator: Replicator? = null

    //@Test
    @Throws(CouchbaseLiteException::class, URISyntaxException::class)
    fun testGettingStarted() {

        // Initialize the Couchbase Lite system
        CouchbaseLite.init(context)

        /* do some stuff here */
    }

    // PASSIVE PEER STUFF
    fun ibListenerSimple() {
        val thisConfig =
            URLEndpointListenerConfiguration(thisDB) /* &lt;.&gt; */
        thisConfig.setAuthenticator(
            ListenerPasswordAuthenticator { username, password -&gt;
                username.equals("valid.User") &amp;&amp;
                        Arrays.equals(password, valid.password.string)
            }
        ) /* &lt;.&gt; */
        val thisListener = URLEndpointListener(thisConfig) /* &lt;.&gt; */
        thisListener.start() /* &lt;.&gt; */

    }

    fun ibReplicatorSimple() {
        var uri: URI? = null
        try {
            uri = URI("wss://10.0.2.2:4984/db")
        } catch (e: URISyntaxException) {
            e.printStackTrace()
        }
        val theListenerEndpoint: Endpoint = URLEndpoint(uri) /* &lt;.&gt; */
        val thisConfig =
            ReplicatorConfiguration(database, theListenerEndpoint) /* &lt;.&gt; */
        thisConfig.setAcceptOnlySelfSignedServerCertificate(true) /* &lt;.&gt; */
        val thisAuth = BasicAuthenticator(
            "valid.user",
            "valid.password.string"
        )
        thisConfig.setAuthenticator(thisAuth) /* &lt;.&gt; */
        replicator = Replicator(config) /* &lt;.&gt; */
        replicator.start() /* &lt;.&gt; */

    }

    fun ibPassListener() {
// EXAMPLE 1
        // Initialize the listener config
        val thisConfig =
            URLEndpointListenerConfiguration(thisDB) /* &lt;.&gt; */

        thisConfig.setPort(55990) /* &lt;.&gt; */

        thisConfig.setNetworkInterface("10.1.1.10") /* &lt;.&gt; */

        thisConfig.setEnableDeltaSync(false) /* &lt;.&gt; */

        // Configure server security
        thisConfig.setDisableTls(false) /* &lt;.&gt; */

        // Use an Anonymous Self-Signed Cert
        thisConfig.setTlsIdentity(null) /* &lt;.&gt; */


        // Configure Client Security using an Authenticator
        // For example, Basic Authentication <i class="conum" data-value="18"></i><b>(18)</b>
        thisConfig.setAuthenticator(
            ListenerPasswordAuthenticator { validUser, validPassword -&gt;
                username.equals(validUser) &amp;&amp;
                        Arrays.equals(password, validPassword)
            }
        )

        // Initialize the listener
        val thisListener = URLEndpointListener(thisConfig) /* &lt;.&gt; */

        // Start the listener
        thisListener.start() /* &lt;.&gt; */

    }

    fun ibListenerGetNetworkInterfaces() {
        val thisConfig =
            URLEndpointListenerConfiguration(database)
        val thisListener = URLEndpointListener(thisConfig)
        thisListener.start()
        Log.i(
            TAG,
            "URLS are " + thisListener.getUrls()
        )

    }

    fun ibListenerLocalDb() {
        // . . . preceding application logic . . .
        CouchbaseLite.init(context) /* &lt;.&gt; */
        val thisDB = Database("passivepeerdb")

    }

    fun ibListenerConfigTlsDisable() {
        thisConfig.setDisableTls(true) /* &lt;.&gt; */

    }

    fun ibListenerConfigTlsIdFull() {
        // Use CA Cert
        // Import a key pair into secure storage
        // Create a TLSIdentity from the imported key-pair
        val thisKeyPair: InputStream = FileInputStream()
        thisKeyPair.javaClass.getResourceAsStream("serverkeypair.p12") /* &lt;.&gt; */
        val thisIdentity: TLSIdentity = importIdentity(
            EXTERNAL_KEY_STORE_TYPE,  // KeyStore type, eg: "PKCS12"
            thisKeyPair,  // An InputStream from the keystore
            password,  // The keystore password
            EXTERNAL_KEY_ALIAS,  // The alias to be used (in external keystore)
            null,  // The key password
            "test-alias" // The alias for the imported key
        )


        // Set the TLS Identity
        thisConfig.setTlsIdentity(thisIdentity) /* &lt;.&gt; */

    }

    fun ibListenerConfigClientAuthRoot() {
        // Configure the client authenticator
        // to validate using ROOT CA
        // thisClientID.certs is a list containing a client cert to accept
        // and any other certs needed to complete a chain between the client cert
        // and a CA
        val validId: TLSIdentity =
            TLSIdentity.getIdentity("Our Corporate Id")
                ?: throw IllegalStateException("Cannot find corporate id") // get the identity <i class="conum" data-value="19"></i><b>(19)</b>
        thisConfig.setTlsIdentity(validId)
        thisConfig.setAuthenticator(
            ListenerCertificateAuthenticator(validId.getCerts())
        ) /* &lt;.&gt; */
        // accept only clients signed by the corp cert
        val thisListener = URLEndpointListener(thisConfig)

    }

    fun ibListenerConfigTlsDisable() {

        thisConfig.disableTLS(true)

    }

    fun ibListenerStatusCheck() {
        val connectionCount: Int = thisListener.getStatus().getConnectionCount() /* &lt;.&gt; */
        val activeConnectionCount: Int =
            thisListener.getStatus().getActiveConnectionCount() /* &lt;.&gt; */

    }

    fun ibListenerStop() {

        thisListener.stop()

    }

    // ACTIVE PEER STUFF
    // Replication code
    @Throws(CouchbaseLiteException::class, URISyntaxException::class)
    fun testActPeerSync() {
        // initialize the replicator configuration
        val thisConfig = ReplicatorConfiguration(
            thisDB,
            URLEndpoint(URI("wss://listener.com:8954"))
        ) /* &lt;.&gt; */

        // Set replicator type
        thisConfig.setReplicatorType(
            ReplicatorConfiguration.ReplicatorType.PUSH_AND_PULL
        )

        // Configure Sync Mode
        thisConfig.setContinuous(false) // default value

        // Configure Server Authentication --
        // only accept self-signed certs
        thisConfig.setAcceptOnlySelfSignedServerCertificate(true) /* &lt;.&gt; */

        // Configure the credentials the
        // client will provide if prompted
        val thisAuth: BasicAuthenticator /* &lt;.&gt; */
        thisAuth = BasicAuthenticator("Our Username", "Our PasswordValue")
        thisConfig.setAuthenticator(thisAuth)

        /* Optionally set custom conflict resolver call back */thisConfig.setConflictResolver() /* &lt;.&gt; */

        // Create replicator
        // Consider holding a reference somewhere
        // to prevent the Replicator from being GCed
        val thisReplicator = Replicator(thisConfig) /* &lt;.&gt; */

        // Optionally add a change listener <i class="conum" data-value="20"></i><b>(20)</b>
        val thisListener: ListenerToken = addChangeListener { change -&gt;
            val err: CouchbaseLiteException = change.getStatus().getError()
            if (err != null) {
                Log.i(
                    TAG,
                    "Error code ::  " + err.getCode(),
                    e
                )
            }
        }

        // Start replicator
        thisReplicator.start(false) /* &lt;.&gt; */

    }

    fun ibReplicatorConfig() {
        // BEGIN additional snippets
        // Configure Server Security
        // -- only accept CA attested certs
        thisConfig.setAcceptOnlySelfSignedServerCertificate(false) /* &lt;.&gt; */


        // Return the remote pinned cert (the listener's cert)
        val returnedCert: Byte =
            ByteArray(thisConfig.getPinnedCertificate()) // Get listener cert if pinned

        // ... other replicator configuration
        // Provide a client certificate to the server for authentication
        val thisClientId: TLSIdentity = TLSIdentity.getIdentity("clientId")
            ?: throw IllegalStateException("Cannot find client id") /* &lt;.&gt; */
        thisConfig.setAuthenticator(ClientCertificateAuthenticator(thisClientId)) /* &lt;.&gt; */
        // ... other replicator configuration
        val thisReplicator = Replicator(thisConfig)


        // Use the pinned certificate from the byte array (cert)
        thisConfig.setPinnedServerCertificate(cert.getEncoded()) /* &lt;.&gt; */
    }

    fun ibP2pReplicatorStatus() {
        Log.i(
            TAG, "The Replicator is currently " +
                    thisReplicator.getStatus().getActivityLevel()
        )
        Log.i(
            TAG,
            "The Replicator has processed $t"
        )
        if (thisReplicator.getStatus().getActivityLevel() ===
            Replicator.ActivityLevel.BUSY
        ) {
            Log.i(
                TAG,
                "Replication Processing"
            )
            Log.i(
                TAG, "It has completed " +
                        thisReplicator.getStatus().getProgess().getTotal().toString() +
                        " changes"
            )
        }
    }

    fun ibP2pReplicatorStop() {
        // Stop replication.
        thisReplicator.stop() /* &lt;.&gt; */
    }

    fun ibP2pListener() {
        CouchbaseLite.init(context)
        val thisDB = Database("passivepeerdb") /* &lt;.&gt; */
        // Initialize the listener config
        val thisConfig =
            URLEndpointListenerConfiguration(database)
        thisConfig.setPort(55990) /* &lt;.&gt;  Optional; defaults to auto */
        thisConfig.setDisableTls(false) /* &lt;.&gt;  Optional; defaults to false */
        thisConfig.setEnableDeltaSync(true) /* &lt;.&gt; Optional; defaults to false */

        // Configure the client authenticator (if using basic auth)
        val auth = ListenerPasswordAuthenticator(
            "username", "password"
        ) /* &lt;.&gt; */
        thisConfig.setAuthenticator(auth) /* &lt;.&gt; */

        // Initialize the listener
        val listener = URLEndpointListener(thisConfig) /* &lt;.&gt; */

        // Start the listener
        listener.start() /* &lt;.&gt; */



//        Map&lt;String, String&gt; X509_ATTRIBUTES = mapOf(
//                TLSIdentity.CERT_ATTRIBUTE_COMMON_NAME to "Couchbase Demo",
//                TLSIdentity.CERT_ATTRIBUTE_ORGANIZATION to "Couchbase",
//                TLSIdentity.CERT_ATTRIBUTE_ORGANIZATION_UNIT to "Mobile",
//                TLSIdentity.CERT_ATTRIBUTE_EMAIL_ADDRESS to "noreply@couchbase.com"
//        );
        val thisIdentity: TLSIdentity = createIdentity(true, X509_ATTRIBUTES, null, "test-alias")




        val thisAlias = "alias-to-delete"
        val thisKeyStore: KeyStore = KeyStore.getInstance("AndroidKeyStore")
        thisKeyStore.load(null)
        thisKeyStore.deleteEntry(thisAlias)


        // OPTIONALLY:: Retrieve a stored TLS identity using its alias/label
        val thisIdentity: TLSIdentity = getIdentity("couchbase-docs-cert")
    }

    fun ibRplicatorPull() {
        var database: Database
        var replicator: Replicator /* &lt;.&gt; */
        var uri: URI? = null
        try {
            uri = URI("wss://10.0.2.2:4984/db") /* &lt;.&gt; */
        } catch (e: URISyntaxException) {
            e.printStackTrace()
        }
        val endpoint: Endpoint = URLEndpoint(uri)
        val config = ReplicatorConfiguration(database, endpoint)
        config.setReplicatorType(ReplicatorConfiguration.ReplicatorType.PULL)
        this.replicator = Replicator(config)
        this.replicator.start()
    }

    // initialize the replicator configuration
    val thisConfig: ReplicatorConfiguration = ReplicatorConfiguration(
        thisDB,
        URLEndpoint(URI("wss://10.0.2.2:8954/travel-sample"))

    /* C A L L O U T S

// Listener Callouts


    &lt;.&gt; Initialize the listener instance using the configuration settings.
    &lt;.&gt; Start the listener, ready to accept connections and incoming data from active peers.



  &lt;.&gt; `connectionCount` -- the total number of connections served by the listener
  &lt;.&gt; `activeConnectionCount` -- the number of active (BUSY) connections currently being served by the listener
  //



  &lt;.&gt; Configure the pinned certificate using data from the byte array `cert`

  &lt;.&gt; Attempt to get the identity from secure storage
  &lt;.&gt; Set the authenticator to ClientCertificateAuthenticator and configure it to use the retrieved identity


  &lt;.&gt; A replication is an asynchronous operation.
  To keep a reference to the `replicator` object, you can set it as an instance property.
  &lt;.&gt; The URL scheme for remote database URLs uses `ws:`, or `wss:` for SSL/TLS connections over wb sockets.
  In this example the hostname is `10.0.2.2` because the Android emulator runs in a VM that is generally accessible on `10.0.2.2` from the host machine (see https://developer.android.com/studio/run/emulator-networking[Android Emulator networking] documentation).
  +
  NOTE: As of Android Pie, version 9, API 28, cleartext support is disabled, by default.
  Although `wss:` protocol URLs are not affected, in order to use the `ws:` protocol, applications must target API 27 or lower, or must configure application network security as described https://developer.android.com/training/articles/security-config#CleartextTrafficPermitted[here].

  */
}</code></pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When planning the indexes you need for your database, remember that while indexes make queries faster, they may also:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Make writes slightly slower, because each index must be updated whenever a document is updated</p>
</li>
<li>
<p>Make your Couchbase Lite database slightly larger.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So too many indexes may hurt performance.
Optimal performance depends on designing and creating the <em>right</em> indexes to go along with your queries.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-content"><a class="anchor" href="#related-content"></a>Related Content</h2>
<div class="sectionbody">
<div class="card-row three-column-row">
<div class="sect5 column">
<h6 id=""><a class="anchor" href="#"></a></h6>
<div class="ulist">
<div class="title">How to . . .</div>
<ul>
<li>
<p><a href="gs-prereqs.html" class="page">Prerequisites</a></p>
</li>
<li>
<p><a href="gs-install.html" class="page">Install</a></p>
</li>
<li>
<p><a href="gs-build.html" class="page">Build and Run</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-2"><a class="anchor" href="#-2"></a></h6>
<div class="ulist">
<div class="title">Learn more . . .</div>
<ul>
<li>
<p><a href="database.html" class="page">Databases</a></p>
</li>
<li>
<p><a href="document.html" class="page">Documents</a></p>
</li>
<li>
<p><a href="blob.html" class="page">Blobs</a></p>
</li>
<li>
<p><a href="replication.html" class="page">Remote Sync using Sync Gateway</a></p>
</li>
<li>
<p><a href="conflict.html" class="page">Handling Data Conflicts</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-3"><a class="anchor" href="#-3"></a></h6>
<div class="ulist">
<div class="title">Dive Deeper . . .</div>
<ul>
<li>
<p><a href="https://forums.couchbase.com/c/mobile/14">Forum</a> <strong>|</strong> <a href="https://blog.couchbase.com/">Blog</a> <strong>|</strong> <a href="https://docs.couchbase.com/tutorials/index.html">Tutorials</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase_logo_black.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2021 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
