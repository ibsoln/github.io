<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Build a React Native Module with Couchbase Lite on iOS | Couchbase Docs Preview Site</title>
<link rel="canonical" href="https://ibsoln.github.io/tutorials/hotel-finder/ios.html">
<link rel="stylesheet" href="../../_/css/site.css">
<script src="../../_/js/vendor/jquery.js"></script>
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="tutorials">
<meta name="dcterms.identifier" content="master">
<meta name="generator" content="Antora 2.3.3">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">

              <a class="navbar-brand" href="https://www.couchbase.com">
                <img src="../../_/img/couchbase-documentation-logo.svg" alt="Couchbase" />
              </a>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://ibsoln.github.io/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../index.html">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <form class="navbar-item search">
                  <input type="text" placeholder="Search Docs" class="query" id="search-query" />
                  <button type="button" class="search-btn">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
                <a class="btn btn-primary try-btn" href="https://www.couchbase.com/downloads">
                  Downloads
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<nav class="nav">
<div class="left-sidebar-menu">
<div class="nav-menu">
<ul class="nav-list">
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Developer Bootstrap Exercises</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-docker-image-manual-cb65.html">Couchbase Server Example Configuration</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-nosdk-webUI-firstquery-cb65.html">SQL JSON Upsert and Lookup via Web UI</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-java3-native-intellij-firstquery-cb65.html">Java with Couchbase SDK 3 and IntelliJ</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-java27-native-intellij-firstquery-cb65.html">Java with Couchbase SDK 2.7 and IntelliJ</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-java27-springdata32-intellij-firstquery-cb65.html">Java with Spring Data Couchbase and IntelliJ</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-dotnet27-aspnetcore31-visualstudio-firstquery-cb65.html">ASP.NET Core First Query</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-dotnet27-linq-vscode-firstquery-cb65.html">.NET Core with Linq2Couchbase First Query</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-nodejs26-ottoman-vscode-firstquery-cb65.html">Upsert and Lookup via Ottoman 2.6 &amp; NodeJS SDK 2.6</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../quick-start/quickstart-python3-native-firstquery-cb65.html">Native Python SDK First Query</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Couchbase Server</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">Session Storage
Unresolved include directive in modules/ROOT/nav.adoc - include::session-storage:partial$nav.adoc[]</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">User Profile Storage
Unresolved include directive in modules/ROOT/nav.adoc - include::profile-store:partial$nav.adoc[]</span>
</span>
</li>
</ul>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Couchbase Mobile</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Travel Sample</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../mobile-travel-sample/introduction.html">Introduction</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Swift</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<span class="in-toggle" data-depth="3"></span>
<a class="nav-link" href="../mobile-travel-sample/swift/installation/index.html">Backend Installation</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/swift/installation/manual.html">Manual</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/swift/installation/docker.html">Docker (Local)</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/swift/installation/cloud.html">Cloud (RightScale)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/installation/travel-mobile-app.html">Installation</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/design/data-modeling.html">Data Modeling</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/develop/mvp-architecture.html">MVP Architecture</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/develop/the-basics.html">The Basics</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/develop/security.html">Security</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/develop/sync.html">Sync</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/develop/pre-built-database.html">Pre-built database</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/develop/query.html">Query</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/swift/develop/full-text-search.html">Full Text Search</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Android-Java</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<span class="in-toggle" data-depth="3"></span>
<a class="nav-link" href="../mobile-travel-sample/android/installation/index.html">Backend Installation</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/android/installation/manual.html">Manual</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/android/installation/docker.html">Docker (Local)</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/android/installation/cloud.html">Cloud (RightScale)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/installation/travel-mobile-app.html">Installation</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/design/data-modeling.html">Data Modeling</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/develop/mvp-architecture.html">MVP Architecture</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/develop/the-basics.html">The Basics</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/develop/security.html">Security</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/develop/sync.html">Sync</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/develop/pre-built-database.html">Pre-built database</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/develop/query.html">Query</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/android/develop/full-text-search.html">Full Text Search</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">Java</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<span class="in-toggle" data-depth="3"></span>
<a class="nav-link" href="../mobile-travel-sample/java/installation/index.html">Backend Installation</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/java/installation/manual.html">Manual</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/java/installation/docker.html">Docker (Local)</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/java/installation/cloud.html">Cloud (RightScale)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/installation/travel-mobile-app.html">Installation</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/design/data-modeling.html">Data Modeling</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/develop/mvp-architecture.html">MVP Architecture</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/develop/the-basics.html">The Basics</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/develop/security.html">Security</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/develop/sync.html">Sync</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/develop/pre-built-database.html">Pre-built database</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/develop/query.html">Query</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/java/develop/full-text-search.html">Full Text Search</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<span class="in-toggle" data-depth="2"></span>
<span class="nav-text ">C#</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<span class="in-toggle" data-depth="3"></span>
<a class="nav-link" href="../mobile-travel-sample/csharp/installation/index.html">Backend Installation</a>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/csharp/installation/manual.html">Manual</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/csharp/installation/docker.html">Docker (Local)</a>
</span>
</li>
<li class="nav-item " data-depth="4">

<span class="nav-line "  data-depth="4">
<a class="nav-link" href="../mobile-travel-sample/csharp/installation/cloud.html">Cloud (RightScale)</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/installation/travel-mobile-app.html">Installation</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/design/data-modeling.html">Data Modeling</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/develop/mvvm-architecture.html">MVVM Architecture</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/develop/the-basics.html">The Basics</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/develop/security.html">Security</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/develop/sync.html">Sync</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/develop/pre-built-database.html">Pre-built database</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/develop/query.html">Query</a>
</span>
</li>
<li class="nav-item " data-depth="3">

<span class="nav-line "  data-depth="3">
<a class="nav-link" href="../mobile-travel-sample/csharp/develop/full-text-search.html">Full Text Search</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../../userprofile-couchbase-mobile/standalone/userprofile/userprofile_basic.html">Getting Started on iOS</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="#standalone@userprofile-couchbase-mobile:userprofile:xamarin/userprofile_basic.adoc">Getting Started on Xamarin</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="#standalone@userprofile-couchbase-mobile:userprofile:android/userprofile_basic.adoc">Getting Started on Android</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Getting Started with Peer-to-Peer Sync</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../cbl-p2p-sync-websockets/swift/cbl-p2p-sync-websockets.html">iOS/Swift</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../cbl-p2p-sync-websockets/dotnet/cbl-p2p-sync-websockets.html">Xamarin/C#</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Xcode Playground</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../swift-playground/overview.html">Overview</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">Recycler Views with Live Queries$nav.adoc[]</span>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Build a Cordova Plugin</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../hotel-lister/introduction.html">Introduction</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../hotel-lister/ios.html">iOS</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../hotel-lister/android.html">Android</a>
</span>
</li>
</ul>
</li>
<li class="nav-item is-current-path is-active is-active-depth-2  " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Build a React Native Module</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="introduction.html">Introduction</a>
</span>
</li>
<li class="nav-item is-current-page is-active is-active-depth-2  " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="ios.html">iOS</a>
</span>
</li>
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="android.html">Android</a>
</span>
</li>
</ul>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">OpenID Connect Tutorial</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../openid-connect-implicit-flow/index.html">OpenID Connect Auth for Sync Gateway</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Build Your Own</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="nav-text ">Tutorial Template
Unresolved include directive in modules/ROOT/nav.adoc - include::tutorial-template:partial$nav.adoc[]</span>
</span>
</li>
</ul>
</li>
</ul>
</div>
<a href="#" class="menu-expand-toggle"> <span>Navigation</span> <i class="fas fa-times-circle"></i> <i class="fas fa-chevron-circle-left"></i></a>
</div></nav>
<aside class="toc sidebar">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="https://github.com/couchbaselabs/hotel-finder-react-native/edit/master/modules/hotel-finder/pages/ios.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="../index.html">Tutorials</a></li>
<li class="crumb">Couchbase Mobile</li>
<li class="crumb">Build a React Native Module</li>
<li class="crumb"><a href="ios.html">iOS</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Build a React Native Module with Couchbase Lite on iOS</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this tutorial, you will learn how to use Couchbase Lite in a React Native project.</p>
</div>
<div class="paragraph">
<p>The sample project is an application that allows users to search and bookmark hotels from a Couchbase Lite database.
The application contains 2 screens:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Bookmarks Screen:</strong> to list the bookmarked hotels. You can unbookmark a previously bookmarked hotel from this screen</p>
</li>
<li>
<p><strong>Search Screen:</strong> to search for hotels by providing a country and/or full-text search query. You can bookmark (or unbookmark) a hotel from this screen.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/ios_flow.jpg" alt="ios flow">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="pre-requisites"><a class="anchor" href="#pre-requisites"></a>Pre-requisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This tutorial requires the following components and versions to run successfully.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Xcode 10.2 or above</p>
</li>
<li>
<p>Swift 5.1</p>
</li>
<li>
<p>Couchbase Lite 2.6</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The tutorial also assumes that the reader has a basic understanding of developing apps with React Native and Swift</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="getting-started"><a class="anchor" href="#getting-started"></a>Getting Started</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>The User Interface has already been implemented in the starter project.
You will add the code to persist and query data.</strong></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download the <a href="_attachments/starter-project.zip">starter project</a>.</p>
</li>
<li>
<p>Unzip <strong>starter-project.zip</strong>.</p>
</li>
<li>
<p>Open the <strong>starter-project/HotelFinder/</strong> directory in the JavaScript editor of your choice (for example, <a href="https://code.visualstudio.com/">Visual Studio Code</a> or <a href="https://www.jetbrains.com/webstorm/">WebStorm</a>).</p>
</li>
<li>
<p>The User Interface code is located in <strong>ui/Bookmarks.js</strong> and <strong>ui/Search.js</strong>.</p>
</li>
<li>
<p>Run the following commands in your Terminal.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">cd HotelFinder
npm install -g react-native-cli
npm install
react-native link</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>react-native link</code> command bundles native dependencies in your Xcode project.
It is required in the <a href="https://react-native-training.github.io/react-native-elements/docs/0.19.0/getting_started.html">react-native-elements</a> installation process.</p>
</div>
</li>
<li>
<p>Start the React Native development server.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">npm run start</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>npm run start</code> command starts a web server that bundles and serves the JavaScript code to the application.
You should see the following in the output.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">Metro Bundler ready.

Loading dependency graph...</code></pre>
</div>
</div>
</li>
<li>
<p>Open the Xcode project at <strong>HotelFinder/ios/HotelFinder.xcodeproj</strong>.</p>
</li>
<li>
<p>Build and run.</p>
</li>
<li>
<p>You can click on the <strong>Hotels</strong> button to run a search query.
The result of the query will be empty.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the next section, you will setup the Native Module interface which is the first step for establishing communication between native code and JavaScript.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="native-modules-setup"><a class="anchor" href="#native-modules-setup"></a>Native Modules Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>With <a href="https://facebook.github.io/react-native/docs/native-modules-ios">Native Modules</a>, you can write native code and have access to it from JavaScript.
It is helpful when an app needs access to native APIs, and React Native doesn&#8217;t have a corresponding module yet.
In this tutorial, you will use the Native Modules API to implement methods in Swift and call them from the JavaScript code.
These methods will do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Full Text Search for terms in a Couchbase Lite database.</p>
</li>
<li>
<p>Query documents in a Couchbase Lite database.</p>
</li>
<li>
<p>Create and Update documents in a Couchbase Lite database.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="swiftobjective-c-setup"><a class="anchor" href="#swiftobjective-c-setup"></a>Swift/Objective-C Setup</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Select the <kbd>File &gt; New &gt; File&#8230;&#8203; &gt; Objective-C File</kbd> menu and create a new file called <strong>HotelFinder-RCTBridge.m</strong>. This file defines the methods that exported to the JS layer.</p>
</li>
<li>
<p>Insert the following in <strong>HotelFinder-RCTBridge.m</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">#import &lt;Foundation/Foundation.h&gt;
#import "React/RCTBridgeModule.h"

@interface RCT_EXTERN_MODULE(HotelFinderNative, NSObject)

/* code will be added here later. */

+ (BOOL)requiresMainQueueSetup
{
  return YES;
}
@end</code></pre>
</div>
</div>
</li>
<li>
<p>Select the <kbd>File &gt; New &gt; File&#8230;&#8203; &gt; Objective-C File</kbd> menu and create a new file called <strong>HotelFinderNative.swift</strong>. This file contains the native implementation of the APIs that are exported to the JS layer.</p>
</li>
<li>
<p>Insert the following in <strong>HotelFinderNative.swift</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">import Foundation

@objc (HotelFinderNative)
class HotelFinderNative: NSObject {

	/* code will be added here later. */

}</code></pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>You are now ready to implement functionalities in Swift.
The next step is to import the Couchbase Lite framework in your project.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="couchbase-lite-setup"><a class="anchor" href="#couchbase-lite-setup"></a>Couchbase Lite Setup</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download Couchbase Lite from <a href="https://www.couchbase.com/downloads">here</a>.</p>
</li>
<li>
<p>Unzip the file and drag <strong>CouchbaseLiteSwift.framework</strong> to the <strong>Frameworks</strong> folder in the Xcode project navigator.</p>
<div class="imageblock">
<div class="content">
<img src="_images/drag-framework.png" alt="drag framework">
</div>
</div>
</li>
<li>
<p>Navigate to <strong>Project &gt; General &gt; Embedded Binary</strong> and drag <strong>CouchbaseLiteSwift.framework</strong> over the list.</p>
<div class="imageblock">
<div class="content">
<img src="_images/drag-embedded.png" alt="drag embedded">
</div>
</div>
</li>
<li>
<p>Import the Swift framework in <strong>HotelFinderNative.swift</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">import CouchbaseLiteSwift</code></pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="database-setup"><a class="anchor" href="#database-setup"></a>Database Setup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In our example, we will start with a pre-built Couchbase Lite database that contains a bunch of hotel documents.
We will make our queries against the documents in this database.
Note that in a real world application, the data could be synced down from other Couchbase Lite clients or from Sync Gateway in the cloud.</p>
</div>
<div class="paragraph">
<p>The pre-built database needs to be added to the Xcode project.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Download <a href="_attachments/travel-sample.cblite2.zip">travel-sample.cblite2.zip</a> and drag it over the Xcode project navigator.
Be sure to select the <strong>Copy items if needed</strong> checkbox.</p>
</li>
<li>
<p>You will use the singleton pattern to setup the database instance.
Create a new file named <strong>DatabaseManager.swift</strong> and insert the following.</p>
<div class="paragraph">
<p>In this code, you first check if a database named "travel-sample" exists.
If it doesn&#8217;t exist, the bundled database file is copied to the default Couchbase Lite directory.
The database is then opened and the instance is set.
The <code>createIndex</code> method creates the Full-Text Search index on the <code>description</code> property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/DatabaseManager.swift#L10-L53">import CouchbaseLiteSwift

class DatabaseManager {

  private static var privateSharedInstance: DatabaseManager?

  var database: Database

  let DB_NAME = "travel-sample"

  class func sharedInstance() -&gt; DatabaseManager   {
    guard let privateInstance = DatabaseManager.privateSharedInstance else {
      DatabaseManager.privateSharedInstance = DatabaseManager()
      return DatabaseManager.privateSharedInstance!
    }
    return privateInstance
  }

  private init() {
    let path = Bundle.main.path(forResource: self.DB_NAME, ofType: "cblite2")!
    if !Database.exists(withName: self.DB_NAME) {
      do {
        try Database.copy(fromPath: path, toDatabase: self.DB_NAME, withConfig: nil)
      } catch {
        fatalError("Could not copy database")
      }
    }
    do {
      self.database = try Database(name: "travel-sample")
      self.createIndex(database)
    } catch {
      fatalError("Could not copy database")
    }
  }

  func createIndex(_ database: Database) {
    do {
      try database.createIndex(IndexBuilder.fullTextIndex(items: FullTextIndexItem.property("description")).ignoreAccents(false), withName: "descFTSIndex")
    } catch {
      print(error)
    }
  }

}</code></pre>
</div>
</div>
</li>
<li>
<p>Next, add the following properties in <strong>HotelFinderNative.swift</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift">let database = DatabaseManager.sharedInstance().database
let DOC_TYPE = "bookmarkedhotels"</code></pre>
</div>
</div>
<div class="paragraph">
<p>This code adds the database as an instance property on the <code>HotelFinderNative</code> class.</p>
</div>
</li>
<li>
<p>Build &amp; run. The project should build successfully.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the next sections, you will use this instance variable to perform various operations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="search-hotels"><a class="anchor" href="#search-hotels"></a>Search Hotels</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In this section, you will add the functionality to search for hotels.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>First, we import the appropriate ReactNative module. For this, add the following to the top of <strong>HotelFinder/ui/Search.js</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ui/Search.js#L18-L19">import { NativeModules } from 'react-native';
let HotelFinderNative = NativeModules.HotelFinderNative;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>HotelFinderNative</code> constant corresponds to the native module that was created in the <a href="#swift-objective-c-setup">Swift/Objective-C Setup</a> section.</p>
</div>
</li>
<li>
<p>Next, you must implement a method in the <code>HotelFinderNative</code> module before it can be accessed in JavaScript.
Insert a new method signature in <strong>HotelFinder-RCTBridge.m</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-objectivec hljs" data-lang="objectivec" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinder-RCTBridge.m#L15">RCT_EXTERN_METHOD(search :(NSString *)description :(NSString *)location :(RCTResponseSenderBlock)errorCallback :(RCTResponseSenderBlock)successCallback)</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>RCT_EXTERN_METHOD()</code> is a React Native macro to specify that this method must be exported to JavaScript.</p>
</div>
</li>
<li>
<p>Implement this method in <strong>HotelFinderNative.swift</strong>.</p>
<div class="paragraph">
<p>This code creates the Full-text search query using the <code>match()</code> operator.</p>
</div>
<div class="paragraph">
<p>In this particular example, the match expression looks for the <code>descriptionText</code> value in the <code>description</code> property.
This match expression is logically ANDed with an <code>equalTo</code> comparison expression which looks for the <code>locationText</code> value in the <code>country</code>, <code>city</code>, <code>state</code> or <code>address</code> properties.This expression is then used in the <code>where</code> clause of the query in the usual way.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinderNative.swift#L19-L58">@objc func search(_ description: String?, _ location: String = "", _ errorCallback: @escaping () -&gt; Void, _ successCallback: @escaping ([[[AnyHashable : Any]]]) -&gt; Void) {

  let locationExpression = Expression.property("country")
    .like(Expression.string("%\(location)%"))
    .or(Expression.property("city").like(Expression.string("%\(location)%")))
    .or(Expression.property("state").like(Expression.string("%\(location)%")))
    .or(Expression.property("address").like(Expression.string("%\(location)")))

  var searchExpression: ExpressionProtocol = locationExpression
  if let text = description {
    let descriptionFTSExpression = FullTextExpression.index("descFTSIndex").match(text)
    searchExpression = descriptionFTSExpression.and(locationExpression)
  }

  let query = QueryBuilder
    .select(
      SelectResult.expression(Meta.id),
      SelectResult.expression(Expression.property("name")),
      SelectResult.expression(Expression.property("address")),
      SelectResult.expression(Expression.property("phone"))
    )
    .from(DataSource.database(self.database))
    .where(
      Expression.property("type").equalTo(Expression.string("hotel"))
        .and(searchExpression)
  )

  do {
    let resultSet = try query.execute()
    var array: [[AnyHashable : Any]] = []
    for result in resultSet {
      let map = result.toDictionary()
      array.append(map)
    }
    successCallback([array])
  } catch {
    print(error)
    errorCallback();
  }
}</code></pre>
</div>
</div>
</li>
<li>
<p>You can call the <code>search</code> swift method from <strong>Search.js</strong>. For this, add the following text to the <code>onChangeText</code> method in <strong>Search.js</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ui/Search.js#L40-L44">HotelFinderNative.search(descriptionText, locationText, err =&gt; {
  console.log(err);
}, hotels =&gt; {
  this.setState({hotels: hotels});
});</code></pre>
</div>
</div>
</li>
<li>
<p>Build &amp; run.</p>
</li>
<li>
<p>Tap on "Hotels" button to get to the "Search" screen.</p>
</li>
<li>
<p>In search screen. enter "UK" in the <em>Country</em> input field and press the <strong>Lookup</strong> button.
You should now see a list of hotels in the search result.</p>
<div class="imageblock">
<div class="content">
<img src="_images/search-hotel.gif" alt="search hotel">
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bookmark-hotel"><a class="anchor" href="#bookmark-hotel"></a>Bookmark Hotel</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Bookmarked hotel IDs are persisted in a separate document of type <code>bookmarkedhotels</code>.</p>
<div class="paragraph">
<p>The first time a hotel is bookmarked, the <code>bookmarkedhotels</code> document is created.
Subsequently, every time a new hotel is bookmarked, the hotel ID is appended to the <code>hotels</code> array of the existing document.
You will add a method to find or create the document of type <code>bookmarkedhotels</code>.
Add the following <code>findOrCreateBookmarkDocument</code> method in <strong>HotelFinderNative.swift</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinderNative.swift#L145-L174">func findOrCreateBookmarkDocument() -&gt; MutableDocument {
  let query = QueryBuilder
    .select(
      SelectResult.expression(Meta.id),
      SelectResult.property("hotels")
    )
    .from(DataSource.database(database))
    .where(
      Expression.property("type")
        .equalTo(Expression.string(DOC_TYPE))
  )

  do {
    let resultSet = try query.execute()
    let array = resultSet.allResults()
    if (array.count == 0) {
      let mutableDocument = MutableDocument()
        .setString(DOC_TYPE, forKey: "type")
        .setArray(MutableArrayObject(), forKey: "hotels")
      try database.saveDocument(mutableDocument)
      return mutableDocument
    } else {
      let documentId = array[0].string(forKey: "id")!
      let document = database.document(withID: documentId)!
      return document.toMutable()
    }
  } catch {
    fatalError(error.localizedDescription);
  }
}</code></pre>
</div>
</div>
</li>
<li>
<p>You will now add the method to update the document when a hotel is bookmarked.
Insert a new method signature in <strong>HotelFinder-RCTBridge.m</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-objectivec hljs" data-lang="objectivec" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinder-RCTBridge.m#L19">RCT_EXTERN_METHOD(bookmark :(NSString *)hotelId :(RCTResponseSenderBlock)errorCallback :(RCTResponseSenderBlock)successCallback)</code></pre>
</div>
</div>
</li>
<li>
<p>Implement the corresponding method natively in <strong>HotelFinderNative.swift</strong>.
Every time a new hotel is bookmarked, the hotel ID is appended to the <code>hotels</code> array and the update is saved to the database.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinderNative.swift#L62-L75">@objc func bookmark(_ hotelId: String, _ errorCallback: @escaping ([Any]) -&gt; Void, _ successCallback: @escaping ([Any]) -&gt; Void) {
  let mutableDocument = findOrCreateBookmarkDocument()
  mutableDocument
    .array(forKey: "hotels")!
    .addString(hotelId)
  do {
    try database.saveDocument(mutableDocument)
    let array = mutableDocument.array(forKey: "hotels")!.toArray()
    successCallback([array])
  } catch {
    errorCallback([error.localizedDescription])
    fatalError(error.localizedDescription)
  }
}</code></pre>
</div>
</div>
</li>
<li>
<p>You can now call it from <strong>Search.js</strong>. Add the following to the <code>bookmark</code> method in <strong>Search.js</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ui/Search.js#L49-L53">HotelFinderNative.bookmark(hotelId, err =&gt; {
  console.log(err);
}, bookmarkIds =&gt; {
  this.setState({bookmarkIds: bookmarkIds});
});</code></pre>
</div>
</div>
</li>
<li>
<p>While searching for hotels, the app should also display an icon on hotels that are previously bookmarked .
To do so, you will add a new method to query hotel Ids.
Insert a new method signature in <strong>HotelFinder-RCTBridge.m</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-objectivec hljs" data-lang="objectivec" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinder-RCTBridge.m#L23">RCT_EXTERN_METHOD(queryBookmarkIds :(RCTResponseSenderBlock)errorCallback :(RCTResponseSenderBlock)successCallback)</code></pre>
</div>
</div>
</li>
<li>
<p>Implement the corresponding method natively in <strong>HotelFinderNative.swift</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinderNative.swift#L79-L83">@objc func queryBookmarkIds(_ errorCallback: @escaping ([Any]) -&gt; Void, _ successCallback: @escaping ([Any]) -&gt; Void) {
  let mutableDocument = findOrCreateBookmarkDocument()
  let array = mutableDocument.array(forKey: "hotels")!.toArray()
  successCallback([array])
}</code></pre>
</div>
</div>
</li>
<li>
<p>You can now call <code>queryBookmarkIds</code> java method from <strong>Search.js</strong>. For that, add the following to the <code>queryBookmarkIds</code> method in <strong>Search.js</strong></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ui/Search.js#L67-L71">HotelFinderNative.queryBookmarkIds(err =&gt; {
  console.log(err);
}, hotels =&gt; {
  this.setState({bookmarkIds: hotels});
});</code></pre>
</div>
</div>
</li>
<li>
<p>Build &amp; run.</p>
</li>
<li>
<p>Click <strong>Hotels</strong> and search for a hotel (type "UK" in the country field for example).</p>
</li>
<li>
<p>You can now swipe a table view row to bookmark a hotel.
The bookmark icon is displayed.</p>
<div class="imageblock">
<div class="content">
<img src="_images/swipe-row.gif" alt="swipe row">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>In the next section, you will query the bookmarked hotels to display them on the <em>Bookmarks</em> screen.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="list-bookmarks"><a class="anchor" href="#list-bookmarks"></a>List Bookmarks</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Insert a new method signature in <strong>HotelFinder-RCTBridge.m</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-objectivec hljs" data-lang="objectivec" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinder-RCTBridge.m#L27">RCT_EXTERN_METHOD(queryBookmarkDocuments :(RCTResponseSenderBlock)errorCallback :(RCTResponseSenderBlock)successCallback)</code></pre>
</div>
</div>
</li>
<li>
<p>Implement the corresponding method natively in <strong>HotelFinderNative.swift</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-swift hljs" data-lang="swift" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ios/HotelFinder/HotelFinderNative.swift#L87-L121">@objc func queryBookmarkDocuments(_ errorCallback: @escaping ([Any]) -&gt; Void, _ successCallback: @escaping ([Any]) -&gt; Void) {
  // Do a JOIN Query to fetch bookmark document and for every hotel Id listed
  // in the "hotels" property, fetch the corresponding hotel document
  let bookmarkDS = DataSource.database(database).as("bookmarkDS")
  let hotelsDS = DataSource.database(database).as("hotelsDS")

  let hotelsExpr = Expression.property("hotels").from("bookmarkDS")
  let hotelIdExpr = Meta.id.from("hotelsDS")

  let joinExpr = ArrayFunction.contains(hotelsExpr, value: hotelIdExpr)
  let join = Join.join(hotelsDS).on(joinExpr);

  let typeExpr = Expression.property("type").from("bookmarkDS")

  let bookmarkAllColumns = SelectResult.all().from("bookmarkDS")
  let hotelsAllColumns = SelectResult.all().from("hotelsDS")

  let query = QueryBuilder.select(bookmarkAllColumns, hotelsAllColumns)
    .from(bookmarkDS)
    .join(join)
    .where(typeExpr.equalTo(Expression.string(DOC_TYPE)));

  do {
    let resultSet = try query.execute()
    var array: [Any] = []
    for (_, item) in resultSet.enumerated() {
      let dictionary = item.dictionary(forKey: "hotelsDS")!
      array.append(dictionary.toDictionary())
    }
    successCallback([array])
  } catch {
    errorCallback([error.localizedDescription])
    fatalError(error.localizedDescription)
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To query bookmark documents, you will write a JOIN query between the document of type <code>bookmarkedhotels</code> which contains hotel Ids and documents of type <code>hotels</code> which contain all the other fields (<code>name</code>, <code>address</code>, <code>phone</code> etc.)</p>
</div>
</li>
<li>
<p>On the JavaScript side, you must first import the <code>HotelFinderNative</code> ReactNative module.
Add the following to the top of <strong>HotelFinder/ui/Bookmarks.js</strong>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ui/Bookmarks.js#L13-L14">import {NativeModules} from 'react-native';
let HotelFinderNative = NativeModules.HotelFinderNative;</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can now call the <code>queryBookmarkDocuments</code> native method from <strong>Bookmarks.js</strong>. Add the following text to the <code>queryBookmarkDocuments</code> method in <strong>Bookmarks.js</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript" data-source-url="https://github.com/couchbaselabs/hotel-finder-react-native/blob/9a6a1a800314879a8d58c67bee5e85edd4984a64/modules/hotel-finder/examples/HotelFinder/ui/Bookmarks.js#L51-L55">HotelFinderNative.queryBookmarkDocuments(err =&gt; {
  console.log(err);
}, bookmarks =&gt; {
  this.setState({bookmarkDocuments: bookmarks});
});</code></pre>
</div>
</div>
</li>
<li>
<p>Build and run.</p>
</li>
<li>
<p>You should now see the hotel that was bookmarked in the <a href="#bookmark-hotel">Bookmark Hotel</a> section listed in the <em>bookmarks</em> screen.</p>
<div class="imageblock">
<div class="content">
<img src="_images/home-screen.png" alt="home screen">
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>By now, the pattern should seem very familiar and essentially consists of the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Declare the method to be exported in <strong>HotelFinder-RCTBridge.m</strong></p>
</li>
<li>
<p>Implement the method natively in <strong>HotelFinderNative.swift</strong>.
This layer will interact with the native iOS implementation of Couchbase Lite for data persistence functions.</p>
</li>
<li>
<p>Invoke the exported method from JavaScript (you will have to import the React Native module the very first time).</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="conclusion"><a class="anchor" href="#conclusion"></a>Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>Well done!</strong> You have learned how to import Couchbase Lite in a React Native project, and how to add search and persistence functionalities to your application!</p>
</div>
<div class="paragraph">
<p>As an exercise, you can follow the same procedure to implement the functionality to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Unbookmark a hotel on the Bookmarks screen.</p>
</li>
<li>
<p>Unbookmark a hotel on the Search screen.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can find a working copy of the <strong>completed project</strong> in the <a href="_attachments/final-project.zip">final project</a> zip file. Follow the instructions in the <strong>Couchbase Lite Setup</strong> section to integrate Couchbase Lite into your final project. To build and run the final project, follow the steps in the <strong>Getting Started</strong> section.
The final project also implements the missing functionalities mentioned above.</p>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/couchbase_logo_black.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2020 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../_/js/vendor/fontawesome.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
</body>
</html>
