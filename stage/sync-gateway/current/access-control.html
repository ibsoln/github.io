<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(

{'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MVPNN2');</script>
<!-- End Google Tag Manager --><title>Access Control | Couchbase Docs</title>
<link rel="canonical" href="http://127.0.0.1:5000/sync-gateway/current/access-control.html">
<link rel="stylesheet" href="../../_/css/site.css">
<script src="../../_/js/vendor/jquery.js"></script>
<meta name="description" content="How to implement Sync Gateway access controls in the Sync Function using access grants, users, roles and channels">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="sync-gateway">
<meta name="dcterms.identifier" content="3.0">
<meta name="page-url" content="/sync-gateway/current/access-control.html">
<meta name="generator" content="Antora 3.0.0-alpha.6">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://docs.couchbase.com">
                    <img src="../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="http://127.0.0.1:5000/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/mobile.html">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../tutorials/index.html">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a href="https://cloud.couchbase.com/sign-up" class="free-trial-link" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  <i class="fas fa-cloud"></i>
                  Free Trial
                </a>
                <a class="btn btn-primary try-btn"  onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
<div class="components">
  <div class="components_group-title">
    <a href="../../home/mobile.html">Mobile</a>
  </div>
  <ul class="components_list">
    <li class="components_list-items">
      <div class="component_list-version">
        <span class="component_list_title">Couchbase Lite</span>
        <select class="version_list">
          <option value="2.8" selected>2.8</option>
        </select>
      </div>
      <div class="version_items hide" data-version="2.8">
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/index.html">Introduction</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/cbl-whatsnew.html">What&#8217;s New</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/quickstart.html">Android</a>
    </span>
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/gs-prereqs.html">Start Here!</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/gs-install.html">Install</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/gs-build.html">Build and Run</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/database.html">Databases</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/prebuilt-database.html">Pre-built Database</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/document.html">Documents</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/blob.html">Blobs</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Queries</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/querybuilder.html">QueryBuilder</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/query-live.html">Live Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/query-predictive.html">Predictive Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/query-troubleshooting.html">Query Troubleshooting</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/fts.html">Full Text Search</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/indexing.html">Indexing</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/landing-replications.html">Data Sync</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/dbreplica.html">Intra-Device</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/replication.html">Remote Sync Gateway</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="2">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/p2psync-websocket.html">Peer-to-Peer</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/p2psync-websocket-using-passive.html">Passive Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/p2psync-websocket-using-active.html">Active Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/p2psync-custom.html">Integrate a Custom Listener</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/conflict.html">Handling Data Conflicts</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="http://docs.couchbase.com/mobile/2.8.0/couchbase-lite-android/">API&#160;References</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/dep-upgrade.html">Upgrade</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Troubleshooting</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/troubleshooting-logs.html">Using Logs</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/troubleshooting-queries.html">Troubleshooting Queries</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Product Notes</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/release-notes.html">Release Notes</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/compatibility.html">Compatibility</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/supported-os.html">Supported OS</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/android/refer-glossary.html">Glossary</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/quickstart.html">C#.Net</a>
    </span>
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Start Here!</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/gs-install.html">Install</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/gs-build.html">Build and Run</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/database.html">Databases</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/prebuilt-database.html">Pre-built Database</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/document.html">Documents</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/blob.html">Blobs</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Queries</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/querybuilder.html">QueryBuilder</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/query-live.html">Live Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/query-predictive.html">Predictive Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/query-troubleshooting.html">Query Troubleshooting</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/fts.html">Full Text Search</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/indexing.html">Indexing</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/landing-replications.html">Data Sync</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/dbreplica.html">Intra-Device</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/replication.html">Remote Sync Gateway</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="2">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/p2psync-websocket.html">Peer-to-Peer</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/p2psync-websocket-using-passive.html">Passive Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/p2psync-websocket-using-active.html">Active Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/p2psync-custom.html">Integrate a Custom Listener</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/conflict.html">Handling Data Conflicts</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="http://docs.couchbase.com/mobile/2.8.0/couchbase-lite-net">API&#160;References</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/dep-upgrade.html">Upgrade</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Troubleshooting</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/troubleshooting-logs.html">Using Logs</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/troubleshooting-queries.html">Troubleshooting Queries</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Product Notes</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/release-notes.html">Release Notes</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/compatibility.html">Compatibility</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/supported-os.html">Supported OS</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/csharp/refer-glossary.html">Glossary</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/quickstart.html">Java</a>
    </span>
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/gs-prereqs.html">Start Here!</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/gs-install.html">Install</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/gs-build.html">Build and Run</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/database.html">Databases</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/prebuilt-database.html">Pre-built Database</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/document.html">Documents</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/blob.html">Blobs</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Queries</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/querybuilder.html">QueryBuilder</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/query-live.html">Live Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/query-predictive.html">Predictive Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/query-troubleshooting.html">Query Troubleshooting</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/fts.html">Full Text Search</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/indexing.html">Indexing</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/landing-replications.html">Data Sync</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/dbreplica.html">Intra-Device</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/replication.html">Remote Sync Gateway</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="2">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/p2psync-websocket.html">Peer-to-Peer</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/p2psync-websocket-using-passive.html">Passive Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/p2psync-websocket-using-active.html">Active Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/p2psync-custom.html">Integrate a Custom Listener</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/conflict.html">Handling Data Conflicts</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="http://docs.couchbase.com/mobile/2.8.0/couchbase-lite-java/index.html?">API&#160;References</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/dep-upgrade.html">Upgrade</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Troubleshooting</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/troubleshooting-logs.html">Using Logs</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/troubleshooting-queries.html">Troubleshooting Queries</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Product Notes</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/release-notes.html">Release Notes</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/compatibility.html">Compatibility</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/supported-os.html">Supported OS</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/java/refer-glossary.html">Glossary</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/quickstart.html">Objective-C</a>
    </span>
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/gs-prereqs.html">Start Here!</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/gs-install.html">Install</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/gs-build.html">Build and Run</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/database.html">Databases</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/prebuilt-database.html">Pre-built Database</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/document.html">Documents</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/blob.html">Blobs</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Queries</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/querybuilder.html">QueryBuilder</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/query-live.html">Live Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/query-predictive.html">Predictive Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/query-troubleshooting.html">Query Troubleshooting</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/fts.html">Full Text Search</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/indexing.html">Indexing</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/landing-replications.html">Data Sync</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/dbreplica.html">Intra-Device</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/replication.html">Remote Sync Gateway</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="2">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/p2psync-websocket.html">Peer-to-Peer</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/p2psync-websocket-using-passive.html">Passive Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/p2psync-websocket-using-active.html">Active Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/p2psync-custom.html">Integrate a Custom Listener</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/conflict.html">Handling Data Conflicts</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="http://docs.couchbase.com/mobile/2.8.0/couchbase-lite-objc">API&#160;References</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/dep-upgrade.html">Upgrade</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Troubleshooting</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/troubleshooting-logs.html">Using Logs</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/troubleshooting-queries.html">Troubleshooting Queries</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/troubleshooting-crashes.html">Decoding Crash Logs</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Product Notes</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/release-notes.html">Release Notes</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/compatibility.html">Compatibility</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/supported-os.html">Supported OS</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/objc/refer-glossary.html">Glossary</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/quickstart.html">Swift</a>
    </span>
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/gs-prereqs.html">Start Here!</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/gs-install.html">Install</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/gs-build.html">Build and Run</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/database.html">Databases</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/prebuilt-database.html">Pre-built Database</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/document.html">Documents</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/blob.html">Blobs</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Queries</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/querybuilder.html">QueryBuilder</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/query-live.html">Live Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/query-predictive.html">Predictive Query</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/query-troubleshooting.html">Query Troubleshooting</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/fts.html">Full Text Search</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/indexing.html">Indexing</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/landing-replications.html">Data Sync</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/dbreplica.html">Intra-Device</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/replication.html">Remote Sync Gateway</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="2">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/p2psync-websocket.html">Peer-to-Peer</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/p2psync-websocket-using-passive.html">Passive Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/p2psync-websocket-using-active.html">Active Peer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/p2psync-custom.html">Integrate a Custom Listener</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/conflict.html">Handling Data Conflicts</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="http://docs.couchbase.com/mobile/2.8.0/couchbase-lite-swift">API&#160;References</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/dep-upgrade.html">Upgrade</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Troubleshooting</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/troubleshooting-logs.html">Using Logs</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/troubleshooting-queries.html">Troubleshooting Queries</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/troubleshooting-crashes.html">Decoding Crash Logs</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Product Notes</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/release-notes.html">Release Notes</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/compatibility.html">Compatibility</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/supported-os.html">Supported OS</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/swift/refer-glossary.html">Glossary</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="../../couchbase-lite/current/javascript.html">JavaScript</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="../../couchbase-lite/current/javascript.html">JavaScript</a>
    </span>
  </li>
</ul>
  </li>
</ul>
      </div>
    </li>
    <li class="components_list-items">
      <div class="component_list-version">
        <span class="component_list_title">Sync Gateway</span>
        <select class="version_list">
          <option value="3.0" selected>3.0</option>
        </select>
      </div>
      <div class="version_items hide" data-version="3.0">
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="introduction.html">Introduction</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="index.html">Quick Start</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="whatsnew.html">What&#8217;s New</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Start Here!</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="get-started-prepare.html">Prepare</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="get-started-install.html">Install</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="get-started-verify-install.html">Verify</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="data-modeling.html">Data Modeling</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <span class="menu_title menu_text"></span>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Configuration</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="configuration-overview.html">Configuration Overview</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Static</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="configuration-schema-static.html">Static Configuration Schema</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="configuration-javascript-functions.html">Configuration Javascript Functions</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="configuration-environment-variables.html">Configuration Environment Variables</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Dynamic Persistent</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="configuration-schema-bootstrap.html">Bootstrap Configuration Schema</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="configuration-schema-database.html">Database Configuration Schema</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="configuration-rest-api.html">Configuration REST API</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="rest-api-admin-database.html">Database Configuration API</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="rest-api-admin-access-control.html">User Configuration API</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="#sync-gateway::rest-api-admin-isgr.adoc">Inter-Sync Gateway Configuration API</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">REST API</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="rest-api-access.html">REST API Access</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="rest-api.html">Public REST API</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="rest-api-admin.html">Admin REST API</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="rest-api-metrics.html">Metrics REST API</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="rest-api-client-app.html">Use the REST API?</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Security</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="authentication-users.html">User Authentication</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="authentication-certs.html">TLS Certificate Authentication</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Access Control</span>
    </span>
<ul class="menu_row">
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="access-control-concepts.html">Concepts</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="access-control-model.html">Access Model</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="channels.html">Channels</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="roles.html">Roles</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="users.html">Users</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Sync Function</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-overview.html">Overview</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="2">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="sync-function-api.html">API Reference</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-access-cmd.html">access()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-channel-cmd.html">channel()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-expiry-cmd.html">expiry()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-require-access-cmd.html">requireAccess()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-require-admin-cmd.html">requireAdmin()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-require-role-cmd.html">requireRole()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-require-user-cmd.html">requireUser()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-role-cmd.html">role()</a>
    </span>
  </li>
  <li class="menu_list" data-depth="3">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-api-throw-cmd.html">throw()</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="access-control-how.html">How-To</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="access-control-how-create-users.html">Create Users</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="access-control-how-create-roles.html">Create Roles</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="access-control-how-add-roles-to-users.html">Assign Roles to Users</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="access-control-how-control-document-access.html">Control Document Access</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="access-control-how-inspect-access.html">Verify Access</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="access-control-how-using-xattrs-for-access-grants.html">Using XATTRs for Access Grants</a>
    </span>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Sync</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-with-couchbase-server.html">Sync with Couchbase Server</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-using-app.html">Sync Using App</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Inter-Sync Gateway Replication</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-inter-syncgateway-overview.html">Overview</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-inter-syncgateway-run.html">Initialize</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-inter-syncgateway-manage.html">Manage</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-inter-syncgateway-monitor.html">Monitor</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <span class="menu_title menu_text">{sgw-xref}sync-inter-syncgateway-conflict-resolution.adoc[Conflict Resolution]</span>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sync-function-from-sync-nav.html">Sync Function</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="revisions.html">Revisions</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="what-are-tombstones.html">Tombstones</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="managing-tombstones.html">Managing Tombstones</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="delta-sync.html">Delta Sync</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="resync.html">Resync</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="import-filter.html">Import filter</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Manage</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="stats-monitoring.html">Stats Monitoring</a>
    </span>
  </li>
  <li class="menu_list is-parent closed" data-depth="1">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Logging and Troubleshooting</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="logging.html">Logging</a>
    </span>
  </li>
  <li class="menu_list" data-depth="2">
    <span class="menu_line">
      <a class="menu_title menu_link" href="sgcollect-info.html">SGCollect Info</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="database-offline.html">Database Offline</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Deploy</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="deployment.html">Overview</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="command-line-options.html">Command Line Options</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="load-balancer.html">Load Balancer</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="os-level-tuning.html">OS-level Tuning</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="webhooks.html">Webhooks</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="changes-feed.html">Changes Feed</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="integrating-external-stores.html">External Stores</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="stats-prometheus.html">Prometheus Feed</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="indexing.html">Indexing</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="setting-up-dr-cluster.html">Disaster Recovery</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="upgrading.html">Upgrade</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <span class="menu_title menu_text"></span>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Use Kubernetes</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="deploy-cluster-to-kubernetes.html">Deploy</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="#operator::tutorial-sync-gateway-manage.adoc">Manage a Sync Gateway Cluster</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="#operator::tutorial-sync-gateway-clients.adoc">Expose Sync Gateway to Couchbase Lite clients</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="server-compatibility-collections.html">Collections</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="server-compatibility-eventing.html">Eventing</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="server-compatibility-transactions.html">Transactions</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="server-compatibility-xdcr.html">XDCR</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Product Notes</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="release-notes.html">Release Notes</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="supported-environments.html">Supported Environments</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="compatibility.html">Compatibility Matrix</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <span class="menu_title menu_text">Legacy Features</span>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="legacy-sgreplicate-resolving-conflicts.html">SG-Replicate - Resolving Conflicts (depr)</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="legacy-sg-replicate.html">SG-Replicate</a>
    </span>
  </li>
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <a class="menu_title menu_link" href="legacy-logging-pre2-1.html">Legacy Logging Pre2 1</a>
    </span>
  </li>
</ul>
  </li>
  <li class="menu_list is-parent closed" data-depth="0">
    <span class="menu_line">
      <span class="in-toggle"></span>
      <a class="menu_title menu_link" href="glossary.html">Glossary</a>
    </span>
<ul class="menu_row">
  <li class="menu_list" data-depth="1">
    <span class="menu_line">
      <span class="menu_title menu_text"></span>
    </span>
  </li>
</ul>
  </li>
</ul>
      </div>
    </li>
  </ul>
</div>
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
  </div>
</aside>
<aside class="toc sidebar">
  <div class="sidebar-box">
    <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/ianbridge/CouchbaseDocs/bau/sgw/modules/ROOT/pages/access-control.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
    <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="index.html">Sync Gateway</a></li>
<li class="crumb"><a href="access-control.html">Access Control</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Access Control</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>How to implement Sync Gateway access controls in the Sync Function using access grants, users, roles and channels<br>
The sync function API provides several methods that you can use to validate and control user access to databases and documents.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p><em>Related  Topics</em>:  <a href="access-control-concepts.html" class="page">Concepts</a>  |
<a href="access-control-how.html" class="page">How-to</a>  |
<a href="sync-function-api.html" class="page">Sync Function API</a>
<a href="#sync-gateway::using-xattr-access-grants.adoc" class="page unresolved">Using Extended Attributes (XATTRs) for Access Grants</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a>Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the Couchbase Mobile ecosystem, every <a href="users.html" class="page">User</a> and <a href="roles.html" class="page">Role</a> is granted access to zero, one or more <a href="channels.html" class="page">Channels</a>.
It is this channels list that determines the documents users can access&#8201;&#8212;&#8201;as illustrated in <a href="#img-access-control-model">Figure 1</a></p>
</div>
<div class="paragraph">
<p>A user can only read documents that are in at least one of their assigned channels; whether directly or as part of an assigned role.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All users can implicitly access any document in the <a href="channels.html#lbl-public-channel" class="page">Public Channel</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once a user is granted access to a new channel, the <a href="changes-feed.html" class="page">Changes Feed</a> will include all existing documents in that channel, even those from earlier sequences than the current request&#8217;s <code>since</code> parameter.
So, the next replication pull request, will retrieve all documents to which the user now has access.</p>
</div>
<div id="img-access-control-model" class="imageblock">
<div class="content">
<img src="_images/access-control-triangle.png" alt="access control triangle" width="600">
</div>
<div class="title">Figure 1. Access Control Model</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="entities-and-concepts"><a class="anchor" href="#entities-and-concepts"></a>Entities and Concepts</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1">Channels</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><a href="channels.html" class="page">Channels</a> are a key part of Sync Gateway&#8217;s access control approach&#8201;&#8212;&#8201;see: <a href="#img-access-control-model">Figure 1</a></p>
</div>
<div class="paragraph">
<p>Every document is assigned to a channel (you can also think of these as tags).</p>
</div>
<div class="paragraph">
<p>For how to create and manage users&#8201;&#8212;&#8201;see <a href="#lbl-acc-ctl-channels">Channels</a>.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Users</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><a href="users.html" class="page">Users</a> granted access to a channel are able to access the documents assigned to that channel.</p>
</div>
<div class="paragraph">
<p>Users can also be assigned to zero or more roles.
A user inherits the channel access of all roles it belongs to.
This is very much like Unix groups, except that roles do not form a hierarchy.</p>
</div>
<div class="paragraph">
<p>For how to create and manage users&#8201;&#8212;&#8201;see <a href="#lbl-acc-ctl-users">Users</a>.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Roles</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p><a href="roles.html" class="page">Roles</a> enable the grouping togethers of users with similar characteristics, which makes the management of large user populations easier.</p>
</div>
<div class="paragraph">
<p>Roles are granted access to channels.
Any user assigned a role can access any channels (and documents within those channels) the role has been granted access to.</p>
</div>
<div class="paragraph">
<p>For how to create and manage users&#8201;&#8212;&#8201;see <a href="#lbl-acc-ctl-roles">Roles</a>.</p>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Entity Relationships</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>There is a many to many relationship between the entities, so:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Many documents to a channel</p>
</li>
<li>
<p>A document can be assigned to multiple channels</p>
</li>
<li>
<p>A user can be assigned to multiple roles</p>
</li>
<li>
<p>Roles and users can be granted access to multiple channels</p>
</li>
</ul>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Access Grants</dt>
<dd>
<div class="openblock">
<div class="content">

</div>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mechanism"><a class="anchor" href="#mechanism"></a>Mechanism</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are a number of ways in which you can control document distribution and user access, both statically a dynamically; these are itemized in <a href="#lst1">Ways to configure access</a> and illustrated in <a href="#img-channel-access">[img-channel-access]</a>.</p>
</div>
<div id="lst1" class="ulist">
<div class="title">Ways to configure access</div>
<ul>
<li>
<p>Statically&#8201;&#8212;&#8201;using the Sync Gateway Configuration File&#8217;s <a href="configuration-schema-static.html#databases-this_db-users-this_user-admin_channels" class="page">user admin_channels</a> setting</p>
</li>
<li>
<p>Dynamically</p>
<div class="ulist">
<ul>
<li>
<p>At the time of user creation with Admin REST Endpoint  <a href="rest-api-admin.html#/user/post\__db___user_" class="page">/{tkn-db}/_user</a> using <code>admin_channel</code></p>
</li>
<li>
<p>Using the Sync Function&#8217;s <a href="sync-function-api-access-cmd.html" class="page">access()</a>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div id="img-channel-access" class="exampleblock">
<div class="content">
<div class="imageblock">
<div class="content">
<img src="_images/channel-access-grant-all.png" alt="channel access grant all" width="600">
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Documents are assigned to channel using the Sync Function&#8217;s <a href="sync-function-api-channel-cmd.html" class="page">channel()</a> API.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>User are granted access to channel by one of the means defined in <a href="#lst1">Ways to configure access</a></td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lbl-replication"><a class="anchor" href="#lbl-replication"></a>Behavior</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="sync-gateway"><a class="anchor" href="#sync-gateway"></a>Sync Gateway</h3>
<div class="paragraph">
<p>A user can only read documents that are in at least one of their assigned channels; whether directly or as part of an assigned role.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
All users can implicitly access any document in the <a href="channels.html#lbl-public-channel" class="page">Public Channel</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once a user is granted access to a new channel, the <a href="changes-feed.html" class="page">Changes Feed</a> will include all existing documents in that channel, even those from earlier sequences than the current request&#8217;s <code>since</code> parameter.
So, the next replication pull request, will retrieve all documents to which the user now has access.</p>
</div>
<div class="paragraph">
<p>Revoking access to a channel means users who previously used the channel to get replicated documents will no longer see any synced updates.
However, documents already synced to the user&#8217;s device are not deleted.</p>
</div>
</div>
<div class="sect2">
<h3 id="couchbase-lite"><a class="anchor" href="#couchbase-lite"></a>Couchbase Lite</h3>
<div class="paragraph">
<p>By default, Couchbase Lite gets all the channels to which the configured user account has access.
This behavior is suitable for most apps that rely on <a href="authentication-users.html" class="page">User Authentication</a> and the <a href="sync-function-overview.html" class="page">Sync Function Overview</a> to specify which data to pull for each user.</p>
</div>
<div class="paragraph">
<p>Optionally, a Couchbase Lite "pull" replication can also specify a comma-separated list of channel names to receive documents from.
In this case, the replication from Sync Gateway will only pull documents tagged with those channels.
Client apps can use this ability to intelligently sync with a subset of the available documents from the database.</p>
</div>
</div>
<div class="sect2">
<h3 id="admin-rest-api"><a class="anchor" href="#admin-rest-api"></a>Admin REST API</h3>
<div class="paragraph">
<p>The Admin REST API is for administrator use only, and hence is <strong>not</strong> accessible from the clients directly.
To allow users to sign up, it is recommended to have an app server sitting alongside Sync Gateway that performs the user validation, creates a new user on this API and then returns the response to the application.</p>
</div>
<div class="paragraph">
<p>Additionally, this API can be used in conjunction with a 3rd party server for the authentication process (see <a href="authentication-users.html#custom-authentication" class="page">Custom authentication</a>).</p>
</div>
<div class="paragraph">
<p>Lastly, Sync Gateway supports <a href="authentication-users.html#openid-connect" class="page">OpenID Connect authentication</a>.
In this case, Sync Gateway can automatically create users for successfully authenticated users that don&#8217;t have an already existing user in Sync Gateway.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lbl-acc-ctl-channels"><a class="anchor" href="#lbl-acc-ctl-channels"></a>Channels</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="lbl-acc-ctl-users"><a class="anchor" href="#lbl-acc-ctl-users"></a>Users</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Users are one of the cornerstone concepts of <em>Sync Gateway</em> access control.
You can restrict document access to specific users and-or to users with specific roles.</p>
</div>
<div class="paragraph">
<p>As an entity it comprises a name, password, list of roles and a list of channels.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Sync Gateway users and roles have no relationship to Couchbase Server&#8217;s <a href="#server:learn:security/authorization-overview.adoc" class="page unresolved">RBAC (Role-base Access Control) users</a>.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="create-a-user"><a class="anchor" href="#create-a-user"></a>Create a User</h3>
<div class="paragraph">
<p>Each user must be created on Sync Gateway before it can be used for access control.
You can create and-or manage users statically using the <a href="configuration-schema-static.html" class="page">Static Configuration Schema</a> or dynamically through the <a href="rest-api-admin.html" class="page">Admin REST API</a>.</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_admin-rest-api"></a>Admin REST API</p>
</li>
<li>
<p><a id="tabset1_configuration-file"></a>Configuration File</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_admin-rest-api">
<div class="paragraph">
<p>Create a new user by sending a POST request to the Admin Rest Api <code>_user</code> endpoint (<a href="rest-api-admin.html#/user/post\__db___user_" class="page">/{tkn-db}/_user</a>).
Update existing users by sending a PUT instead; in this case include the user name at the end of the url.</p>
</div>
<div class="paragraph">
<p>The user credentials (<strong>username</strong>/<strong>password</strong>) are passed in the request body.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -vX POST "http://localhost:4985/mydatabase/_user/" -H
"accept: application/json" -H "Content-Type: application/json" -d
'{"name": "Edge1User", "password": "pass"}' <i class="conum" data-value="1"></i><b>(1)</b>

$ curl -vX PUT "http://localhost:4985/mydatabase/_user/Edge1User" -H
"accept: application/json" -H "Content-Type: application/json" -d
'{"name": "Edge1User", "admin_channels": ["RandomChannel"]}' <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Add new user "Edge1User", no <code>access_channel</code> or <code>role</code> is specified here.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Update existing user "Edge1User" and add <code>access_channels</code> data</td>
</tr>
</table>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_configuration-file">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Create users by hardcoding their credentials in the <a href="configuration-schema-static.html" class="page">Static Configuration Schema</a>.
This method is convenient for testing and to get started.
Use the <strong>Admin REST API</strong> for production system changes.</p>
</div>
<div class="paragraph">
<p>+</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "databases": {
    "mydatabase": {
      "users": { <i class="conum" data-value="1"></i><b>(1)</b>
        "GUEST": {"disabled": true},
        "Edge1User": {"password": "pass",
                      "admin_channels": ["RandomChannel"]},
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="configuration-schema-static.html#databases-this_db-users" class="page">databases.$db.users</a></td>
</tr>
</table>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we add the Edge1 role used in the example in this topic.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="lbl-acc-ctl-roles-add"><a class="anchor" href="#lbl-acc-ctl-roles-add"></a>Add Role to User</h3>
<div class="paragraph">
<p>You can add and remove roles from users using either the <a href="rest-api-admin.html" class="page">Admin REST API</a> or <a href="configuration-schema-static.html" class="page">Static Configuration Schema</a>.</p>
</div>
<div class="paragraph">
<p>Note that removing a role effectively revokes access to the channel that role is associated with and may mean users will lose access to required documents.</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset2_admin-rest-api"></a>Admin REST API</p>
</li>
<li>
<p><a id="tabset2_configuration"></a>Configuration</p>
</li>
<li>
<p><a id="tabset2_sync-function"></a>Sync Function</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset2_admin-rest-api">
<div class="paragraph">
<p>Add a role to an existing user by sending a PUT request to the Admin REST API <code>_role</code> endpoint (<a href="rest-api-admin.html#/user/post\__db___user_" class="page">/{tkn-db}/_user/{name}</a> ).</p>
</div>
<div class="paragraph">
<p>Specify the roles to be assigned in the <code>admin_roles</code> array.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -vX PUT "http://localhost:4985/mydatabase/_user/{user}" -H
"accept: application/json" -H "Content-Type: application/json" -d
'{ "admin_roles": ["Edge1"]}' <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>{user} is the user name to be updated, e.g. "Edge1User"</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>See also: <a href="rest-api-admin.html#/role/post__db___role" class="page">/{tkn-db}/_role/</a></p>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_configuration">
<div class="paragraph">
<p>Add a role to a user in the configuration file.
This method is convenient for testing and to get started.
Use the <strong>Admin REST API</strong> for production systems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "databases": {
    "mydatabase": {
      "users": { <i class="conum" data-value="1"></i><b>(1)</b>
        "GUEST": {"disabled": true},
        "Edge1User": {"password": "pass", "admin_roles": ["Edge1"],
                      "admin_channels": ["RandomChannel"]},
        "Edge2User": {"password": "pass", "admin_roles": ["Edge2"]}
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="configuration-schema-static.html#databases-this_db-users-this_user-admin_roles" class="page">databases.$db.users.$user.admin_roles</a></td>
</tr>
</table>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset2_sync-function">
<div class="paragraph">
<p>You can also use the Sync Function&#8217;s <code>role(username, rolename)</code> function to assign roles to users programmatically.</p>
</div>
<div class="paragraph">
<p>Note that both role and user must already exist.
Nonexistent roles don’t cause an error, but have no effect on the user’s access privileges.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">role ("Edge1User", "role:Edge1");
role ("Edge2User", "role:Edge2":);</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lbl-acc-ctl-roles"><a class="anchor" href="#lbl-acc-ctl-roles"></a>Roles</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Roles are named collections of <a href="#lbl-acc-ctl-channels">Channels</a>.
As an entity they comprises a name and a list of channels.</p>
</div>
<div class="paragraph">
<p>Any user associated with a role inherits the right to access any of the channels in the role&#8217;s list.
This provides a convenient way to associate multiple channels with multiple users.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">TIP</dt>
<dd>
<p>Roles have a separate namespace from users, so it&#8217;s possible to have a user and a role with the same name.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="lbl-acc-ctl-roles-create"><a class="anchor" href="#lbl-acc-ctl-roles-create"></a>Create Role</h3>
<div class="paragraph">
<p>As with users, you create and-or manage roles using either the <a href="rest-api-admin.html" class="page">Admin REST API</a> or <a href="configuration-schema-static.html" class="page">Static Configuration Schema</a>.</p>
</div>
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset3_admin-rest-api"></a>Admin REST API</p>
</li>
<li>
<p><a id="tabset3_configuration-file"></a>Configuration File</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset3_admin-rest-api">
<div class="paragraph">
<p>Create a new role using the <a href="rest-api-admin.html#/role/post__db___role" class="page">/{tkn-db}/_role/</a> endpoint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">$ curl -vX POST "http://localhost:4985/mydatabase/_roler/" -H
"accept: application/json" -H "Content-Type: application/json" -d
'{"name": "Edge1", "admin_channels": ["channel1", "channel3"]]}' <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset3_configuration-file">
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Create users by hardcoding their credentials in the <a href="configuration-schema-static.html" class="page">Static Configuration Schema</a>.
This method is convenient for testing and to get started.
It is recommended to use the <strong>Admin REST API</strong> for production systems.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  "databases": {
    "mydatabase": {
      "roles": { <i class="conum" data-value="1"></i><b>(1)</b>
        "Edge1": {"admin_channels": ["channel1", "channel3"]}, <i class="conum" data-value="2"></i><b>(2)</b>
        "Edge2": {"admin_channels": ["channel2", "channel3"]},
        "GUEST": {"disabled": true}
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><a href="configuration-schema-static.html#databases-this_db-users" class="page">databases.$db.users</a></td>
</tr>
</table>
</div>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we add the Edge1 role used in the example in this topic.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="example"><a class="anchor" href="#example"></a>Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Consider the situation where two roles require, and are allowed, access to two distinct information flows and one shared flow&#8201;&#8212;&#8201;see <a href="#img-channels-example">Example 1</a>.</p>
</div>
<div class="paragraph">
<p>This can be achieved by:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Creating two roles (Edge1 and Edge2) for the two groups of users.</p>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Do this either by using the Admin REST API endpoint  <a href="rest-api-admin.html#/role/post__db___role" class="page">/{tkn-db}/_role/</a> or statically by adding the role to the database in the <a href="configuration-schema-static.html" class="page">Static Configuration Schema</a>.
In either case specify that role Edge1 can access <code>Channel1</code>, Edge2 can access <code>Channel2</code>, and both roles can access &amp; <code>Channel3</code>&#8201;&#8212;&#8201;see: <a href="access-control-how-create-roles.html" class="page">Create Roles</a></p>
</div>
</div>
</div>
</li>
<li>
<p>Adding the roles to the appropriate users, again using either the configuration file or API&#8201;&#8212;&#8201;see <a href="access-control-how-add-roles-to-users.html" class="page">Assign Roles to Users</a></p>
</li>
<li>
<p>Creating a Sync Function that</p>
<div class="ulist">
<ul>
<li>
<p>Identifies and assigns appropriate documents to the right channel (or channels)</p>
</li>
<li>
<p>Requires that any user accessing those channels has the right to do so; either directly or as in this case through a role assigned to them(Edge1 or Edge2).</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="img-channels-example" class="exampleblock">
<div class="title">Example 1. Access Control Example</div>
<div class="content">
<div class="paragraph">
<p>This example shows three channels; one shared and two private.
Here <em>Edge #1</em> and <em>Edge #2</em> represent two groups of Sync Gateway users with the assigned roles Edge1 and Edge2 respectively.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/channels-example-all.png" alt="channels example all" width="600">
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Documents are routed to the appropriate channels by Sync Function logic</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The Sync Function requires users (or one of their roles) has access to the channel</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lbl-sync-function"><a class="anchor" href="#lbl-sync-function"></a>Grant Access</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="methods"><a class="anchor" href="#methods"></a>Methods</h3>
<div class="paragraph">
<p>You can grant a user access to a channel statically by adding the appropriate channel to the user&#8217;s <code>admin_channels</code> property in the <a href="configuration-schema-static.html" class="page">Static Configuration Schema</a>.
Alternatively you can provide that same <code>admin_channels</code> property using the admin REST API endpoint (<a href="rest-api-admin.html#/user/post\__db___user_" class="page">/{tkn-db}/_user/{name}</a>).</p>
</div>
<div class="paragraph">
<p>However, the <a href="sync-function-overview.html" class="page">Sync Function Overview</a> is the preferred method for programmatically controlling document access and routing.
It can be programmed to derive appropriate access and routing information from document properties or, more securely, from a designated extended attribute (XATTR)&#8201;&#8212;&#8201;see: <a href="#sync-gateway::using-xattr-access-grants.adoc" class="page unresolved">Using XATTR Access Grants</a> for how to define the XATTR.</p>
</div>
<div class="paragraph">
<p>Note that access grants neither confer, nor constrain, the <strong>type</strong> of access.
Instead you can explicitly implement write access controls within the Sync Function; perhaps restricting updates to specific users or roles&#8201;&#8212;&#8201;for more on this see <a href="#lbl-control-write-access">Write Access</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="sync-function"><a class="anchor" href="#sync-function"></a>Sync Function</h3>
<div class="paragraph">
<p>The Sync Function exposes a number of helper functions to control access&#8201;&#8212;&#8201;see reference information in {sync-function&#8212;&#8203;xef}.
For example, to grant a user access to a channel use the <a href="sync-function-api-access-cmd.html" class="page">access()</a> helper function in the Sync Function&#8201;&#8212;&#8201;see <a href="#ex-helper">Example 2</a>.</p>
</div>
<div class="paragraph">
<p>The <code>access()</code> function can also operate on roles.
If a user name string begins with <code>role:</code> then the remainder of the string is interpreted as a role name.
There&#8217;s no ambiguity here, because ":" is an illegal character in a user or role name.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Because anonymous requests are authenticated as the user "GUEST", you can make a channel and its documents public by calling <code>access</code> with a username of <code>GUEST</code>.
</td>
</tr>
</table>
</div>
<div id="ex-helper" class="exampleblock">
<div class="title">Example 2. Using the Access helper function</div>
<div class="content">
<div class="paragraph">
<p>In this example documents with a type of <code>chatroom</code> are a shared resource that represents a membership list.
The list identifies all users (<code>doc.members</code> list ) to be allowed access to documents being sync&#8217;d using a specific "chatroom" channel.
The channel name is conveyed in a Metadata object, XATTRS.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function (doc, olddoc, meta) {
  if (doc.type == "chatroom") {  <i class="conum" data-value="1"></i><b>(1)</b>
    access(doc.members, <i class="conum" data-value="2"></i><b>(2)</b>
      meta.xattrs.channelXattr);  <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example:</p>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A chat room is represented by a document with a <code>type</code> property set to <code>chatroom</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here the chatroom document&#8217;s <code>members</code> property contains the names of all valid chatroom users.
These users need to be granted access to the chat channel</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Here the chat message channel is picked up from the XATTR key <code>channelXattr</code> and the 'access()' function used to grants all user in <code>members</code> access to that channel.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lbl-inspect-access"><a class="anchor" href="#lbl-inspect-access"></a>Inspect Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the admin REST API to see what channels a user has access to.
Issue an <a href="rest-api-admin.html#/database/get
__db___all_docs" class="page">/\{tkn-db}/_user/\{name}</a> request.
Here&#8217;s an example of the response.
The output shows that the user <code>pupshaw</code> has access to channels <code>all</code> and <code>hoopy</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
    "admin_channels": [
        "all"
    ],
    "admin_roles": [
        "froods"
    ],
    "all_channels": [
        "all",
        "hoopy"
    ],
    "name": "pupshaw",
    "roles": [
        "froods"
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>all_channels</code> property of a user account determines the channels a user can access.
Its value is derived from the union of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The user&#8217;s <code>admin_channels</code> property, which is set using the Admin REST API.</p>
</li>
<li>
<p>The channels the user has been granted access to by <code>access()</code> calls from sync functions invoked for current revisions of documents.</p>
</li>
<li>
<p>The <code>all_channels</code> properties of any roles the user belongs to. These are themselves computed using the above rules.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="lbl-control-write-access"><a class="anchor" href="#lbl-control-write-access"></a>Write Access</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the Sync Function&#8217;s helper functions to control who or what can make document updates.</p>
</div>
<div class="paragraph">
<p>You can require that the user making the change has a specific name, role or channel access&#8201;&#8212;&#8201;as shown in <a href="#ex-check-write-access">Example 3</a>&#8201;&#8212;&#8201;by using any combination  of:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="sync-function-api-require-user-cmd.html" class="page">requireUser()</a></p>
</li>
<li>
<p><a href="sync-function-api-require-role-cmd.html" class="page">requireRole()</a></p>
</li>
<li>
<p>{sync-function-api-require-channel}</p>
</li>
</ul>
</div>
<div id="ex-check-write-access" class="exampleblock">
<div class="title">Example 3. Control Write Access</div>
<div class="content">
<div class="paragraph">
<p>Here the simple Sync Function validates whether the user modifying a document is a valid owner by checking if they are recorded as an owner of the old document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">function (doc, oldDoc, meta) {
  if (oldDoc) {
    requireUser(oldDoc.owner); <i class="conum" data-value="1"></i><b>(1)</b>
  }
  if (meta.xattr.channelxattr) {
    requireAccess(meta.xattr.channelxattr); <i class="conum" data-value="2"></i><b>(2)</b>
  } else
    {
      throw("No channel access granted")
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>If the user making the change is not an owner of the pre-change document, an exception is thrown and the update is rejected with an error.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Here we check the designated xattr for the document channel(s) and require the user making the change to have access to on or more of the channels.
If the xattr is not set we throw an exception.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>See <a href="#ex-helpers">Example 4</a> for more helper function examples.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When sending a change to Sync Gateway through the <a href="rest-api-admin.html" class="page">Admin REST API</a>, the Sync Function executes with <em>admin privileges</em>. Calls to <code>requireUser</code>, <code>requireAccess</code> and <code>requireRole</code> will be no-ops, and will always appear successful.
</td>
</tr>
</table>
</div>
<div id="ex-helpers" class="exampleblock">
<div class="title">Example 4. Helper Function examples</div>
<div class="content">
<div class="paragraph">
<p>This example shows how to use some of the helper functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">requireUser("snej") <i class="conum" data-value="1"></i><b>(1)</b>

requireUser(["snej", "jchris", "tleyden"]) <i class="conum" data-value="2"></i><b>(2)</b>

requireRole("admin") <i class="conum" data-value="3"></i><b>(3)</b>

requireRole(["admin", "old-timer"]) <i class="conum" data-value="4"></i><b>(4)</b>

requireAccess("events") <i class="conum" data-value="5"></i><b>(5)</b>

requireAccess(["events", "messages"]) <i class="conum" data-value="6"></i><b>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>throw an error if username is not "snej"</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>throw if username is not in the list</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>throw an error unless the user has the "admin" role</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>throw an error unless the user has one of those roles</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>throw an error unless the user has access to read the "events" channel</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>throw an error unless the can read one of these channels</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="related-content"><a class="anchor" href="#related-content"></a>Related Content</h2>
<div class="sectionbody">
<div class="card-row three-column-row">
<div class="sect5 column">
<h6 id=""><a class="anchor" href="#"></a></h6>
<div class="ulist">
<div class="title">Learn more &#8230;&#8203;</div>
<ul>
<li>
<p><a href="#sync-gateway::sync-function.adoc" class="page unresolved">Sync Function</a></p>
</li>
<li>
<p><a href="import-filter.html" class="page">Import filter</a></p>
</li>
<li>
<p><a href="sync-inter-syncgateway-overview.html" class="page">Inter-Sync Gateway Replication</a></p>
</li>
<li>
<p><a href="sync-with-couchbase-server.html" class="page">Sync with Couchbase Server</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-2"><a class="anchor" href="#-2"></a></h6>
<div class="ulist">
<div class="title">Reference material &#8230;&#8203;</div>
<ul>
<li>
<p><a href="rest-api.html" class="page">Public REST API</a></p>
</li>
<li>
<p><a href="rest-api-admin.html" class="page">Admin REST API</a></p>
</li>
<li>
<p><a href="rest-api-metrics.html" class="page">Metrics REST API</a></p>
</li>
<li>
<p><a href="rest-api-client-app.html" class="page">Use the REST API?</a></p>
</li>
</ul>
</div>
</div>
<div class="sect5 column">
<h6 id="-3"><a class="anchor" href="#-3"></a></h6>
<div class="ulist">
<div class="title">Community</div>
<ul>
<li>
<p><a href="https://forums.couchbase.com/c/mobile/14">Forum</a>  <strong>|</strong>  <a href="https://blog.couchbase.com/">Blog</a>   <strong>|</strong>  <a href="https://docs.couchbase.com/tutorials/index.html">Tutorials</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Sync Function Blogs</div>
<ul>
<li>
<p><a href="https://blog.couchbase.com/augment-your-sync-function-with-roles-in-couchbase-sync-gateway/">Using roles in sync functions</a></p>
</li>
<li>
<p><a href="https://blog.couchbase.com/data-synchronization-offline-first-apps-couchbase/">Tutorial: Getting Started with Data Synchronization using Couchbase Mobile for Offline-First Apps</a></p>
</li>
<li>
<p><a href="https://blog.couchbase.com/tag/sync-function/">Sync Function (category)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2021 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../_/js/site.js"></script>
<script async src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../_/js/vendor/fontawesome.js"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
</body>
</html>
