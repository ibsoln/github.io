<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv=content-security-policy content="default-src 'none'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https:; style-src 'self' 'unsafe-inline' https:; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https:; img-src 'self' data: https:; connect-src 'self' https:; worker-src blob:;">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>CouchbaseCluster Resource | Couchbase Docs</title>
<link rel="canonical" href="https://ibsoln.github.io/stage/3.0-GA/operator/current/resource/couchbasecluster.html">
<link rel="stylesheet" href="../../_/css/site.css">
<script src="../../_/js/vendor/jquery.js"></script>
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">


<meta name="dcterms.subject" content="operator">
<meta name="dcterms.identifier" content="2.0">
<meta name="page-url" content="/operator/2.0/reference-couchbasecluster.html">
<meta name="generator" content="Antora 3.0.0-alpha.5">
<link rel="icon" href="../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">
              <ul class="navbar-brand-list">
                <li class="brand-logo">
                  <a class="navbar-brand" href="https://www.couchbase.com">
                    <img src="../../_/img/couchbase-logo.svg" alt="Couchbase" />
                  </a>
                </li>
                <li>
                  <a class="navbar-brand cb-documentation" href="https://ibsoln.github.io/stage/3.0-GA/home/index.html">
                    <img src="../../_/img/cb-documentation.svg" alt="Couchbase Documentation" class="cb-docs" />
                    <img src="../../_/img/cb-docs-hover.svg" alt="Couchbase Documentation" class="hide cb-hover-docs" />
                  </a>
                </li>
              </ul>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a href="https://ibsoln.github.io/stage/3.0-GA/home/index.html" class="nav-link">
                      <i class="fas fa-home"></i>
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/server.html">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/mobile.html">
                      Mobile Stage
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/cloud.html">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../home/sdk.html">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="../../tutorials/index.html">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <a class="btn btn-primary btn-grey-reverse" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Download'});" href="https://www.couchbase.com/downloads">
                  Downloads
                  <i class="far fa-arrow-to-bottom fa-fw"></i>
                </a>
                <a href="https://cloud.couchbase.com/sign-up" class="btn btn-primary" onclick="(window.dataLayer=window.dataLayer||[]).push({'event':'customEvent', 'category':'CTA', 'action':'Button Click',  'label':'Free Trial'});" >
                  Start Free Trial
                  <i class="far fa-cloud fa-fw"></i>
                </a>

              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<aside class="nav left-sidebar">
  <div class="nav-container">
    <a href="#" class="menu-expand-toggle"><span>Navigation</span><i class="fas fa-times-circle"></i><i class="fas fa-chevron-circle-left"></i></a>
<div class="components">
  <div class="components_group-title">
    Cloud-Native
  </div>
  <ul class="components_list">
    <li class="components_list-items">
      <div class="component_list-version">
        <span class="component_list_title">Autonomous Operator</span>
        <select class="version_list" data-component="operator">
          <option value="2.2" data-url="../current/overview.html">2.2</option>
          <option value="2.0" data-url="overview.html" selected>2.0</option>
        </select>
      </div>
      <div class="version_items hide" data-version="2.2">
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Introduction</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/overview.html">Introduction</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/whats-new.html">What&#8217;s New?</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/best-practices.html">Guidelines and Best Practices</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/prerequisite-and-setup.html">Prerequisites and System Requirements</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/prerequisite-cloud.html">Public Cloud Prerequisites</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/install-kubernetes.html">Install the Operator on Kubernetes</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/install-openshift.html">Install the Operator on OpenShift</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Learn</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Kubernetes Concepts</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-kubernetes-networking.html">Kubernetes Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-persistent-volumes.html">Persistent Volumes</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-kubernetes-upgrade.html">Kubernetes Automated Upgrade</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Operator Concepts</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-operator.html">Operator Architecture</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-operator-logging.html">Operator Logging</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Couchbase Cluster Concepts</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-label-selection.html">Couchbase Resource Label Selection</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-rbac.html">Couchbase Resource RBAC</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-user-rbac.html">Couchbase User RBAC</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-memory-allocation.html">Couchbase Memory Allocation</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-mds.html">Couchbase Multi-Dimensional Scaling</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-scheduling.html">Couchbase Scheduling and Isolation</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-sizing.html">Couchbase Sizing</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-vertical-scaling.html">Couchbase Cluster Vertical Scaling</a>
  </span>
</li>
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="../current/concept-couchbase-autoscaling.html">Couchbase Cluster Auto-scaling</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-couchbase-autoscaling-best-practices.html">Auto-scaling Best Practices</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-couchbase-networking.html">Couchbase Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-tls.html">Couchbase TLS</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-credential-rotation.html">Couchbase Credential Rotation</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-server-groups.html">Couchbase Server Groups</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-upgrade.html">Couchbase Upgrades</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-hibernation.html">Couchbase Cluster Hibernation</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-couchbase-logging.html">Couchbase Logging</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/concept-backup.html">Couchbase Backup and Restore</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Manage</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Operator</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-operator-upgrade.html">Upgrade the Operator</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-manage-operator-logging.html">Manage Operator Logging</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-roll-your-own.html">Create Your Own Operator Images</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Couchbase Cluster</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Lifecycle</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-couchbase-create.html">Create a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-couchbase-update.html">Modify a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-couchbase-upgrade.html">Upgrade a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-couchbase-delete.html">Delete a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-couchbase-scale.html">Scale a Couchbase Deployment</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Configure</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-persistent-volumes.html">Configure Persistent Volumes</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-backup.html">Configure Backup &amp; Restore</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-mds.html">Configure Multi-Dimensional Scaling</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-couchbase-autoscaling.html">Configure Couchbase Cluster Auto-scaling</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-xdcr.html">Configure XDCR</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-public-networking.html">Configure Public Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-nodeport-networking.html">Configure Node Port Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-server-groups.html">Configure Server Groups</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-admin-password-rotation.html">Rotate the Administrator Password</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-tls.html">Configure TLS</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-tls-client-certificates.html">Configure Client Certificate Authentication</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-tls-rotation.html">Rotate TLS Certificates</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-prometheus.html">Configure Prometheus Metrics Collection</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-manage-couchbase-logging.html">Manage Couchbase Logging</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-couchbase-log-forwarding.html">Configure Log Forwarding</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-non-root-install.html">Configure Non-Root Installs</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Connect</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-ui.html">Access the Couchbase User Interface</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-client-sdks.html">Configure Client SDKs</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Kubernetes</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/howto-storage-class.html">Create a Lazy Bound Storage Class</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Helm</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/helm-setup-guide.html">Helm Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/helm-managing-guide.html">Helm Management</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Reference</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Resource Types</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-resources.html">Resource Documentation</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbaseautoscaler.html">CouchbaseAutoscaler Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbasebackuprestore.html">CouchbaseBackupRestore Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbasebackup.html">CouchbaseBackup Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbasebucket.html">CouchbaseBucket Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbasecluster.html">CouchbaseCluster Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbaseephemeralbucket.html">CouchbaseEphemeralBucket Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbasegroup.html">CouchbaseGroup Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbasememcachedbucket.html">CouchbaseMemcachedBucket Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbasereplication.html">CouchbaseReplication Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbaserolebinding.html">CouchbaseRoleBinding Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/resource/couchbaseuser.html">CouchbaseUser Resource</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Operator</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-admission-cli.html">Dynamic Admission Controller Deployment Settings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-admission-rbac.html">Dynamic Admission Controller RBAC Settings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-operator-configuration.html">Operator Deployment Settings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-operator-rbac.html">Operator RBAC Settings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-operator-logging.html">Operator Logging</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Couchbase Cluster</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-reference-architecture.html"><code>CouchbaseCluster</code> Reference Architecture</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-couchbasecluster-events.html"><code>CouchbaseCluster</code> Events</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/reference-couchbasecluster-services.html"><code>CouchbaseCluster</code> Services</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Helm</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/helm-couchbase-config.html">Couchbase Helm Chart Specification</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Tools</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tools/cbopcfg.html">cbopcfg</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tools/cbopinfo.html">cbopinfo</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Tutorials</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Authentication and Authorization</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-rbac-auth.html">Authenticating with Couchbase and LDAP</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Autoscaling</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-autoscale-data.html">Autoscaling Couchbase Data Service</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-autoscale-index.html">Autoscaling Couchbase Index Service</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-autoscale-query.html">Autoscaling Couchbase Query Service</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Backup</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-velero-backup.html">Backup with VMware Velero</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Cloud Platforms</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-aks.html">Installing AKS</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-eks.html">Installing EKS</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-gke.html">Installing GKE</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Logging</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-couchbase-log-forwarding.html">Forwarding Couchbase Logs with Fluent Bit</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Metering</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-metering-kubernetes.html">Metering Couchbase Resources In Kubernetes</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-metering.html">Metering Couchbase Resources In OpenShift</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Monitoring</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-prometheus.html">Quick Start with Prometheus Monitoring</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Networking</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-remote-dns.html">Inter-Kubernetes Networking with Forwarded DNS</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-public-addressability.html">Public Networking with External DNS</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Persistent Volumes</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-volume-expansion.html">Persistent Volume Expansion</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Sync Gateway</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-sync-gateway.html">Connecting Sync-Gateway to a Couchbase Cluster</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-sync-gateway-clients.html">Exposing Sync-Gateway to Couchbase Lite Clients</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-sync-gateway-manage.html">Managing Sync Gateway Cluster </a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">TLS</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-tls.html">Creating TLS Certificates</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/tutorial-cert-manager.html">Using a Certificate Manager</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Release Notes</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="../current/release-notes.html">Release Notes</a>
  </span>
</li>
</ul>
</li>
</ul>
      </div>
      <div class="version_items hide" data-version="2.0">
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Introduction</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="overview.html">Introduction</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="whats-new.html">What&#8217;s New?</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="best-practices.html">Guidelines and Best Practices</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="prerequisite-and-setup.html">Prerequisites and System Requirements</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="prerequisite-cloud.html">Public Cloud Prerequisites</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="install-kubernetes.html">Install the Operator on Kubernetes</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="install-openshift.html">Install the Operator on OpenShift</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Learn</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Kubernetes Concepts</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-kubernetes-networking.html">Kubernetes Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-persistent-volumes.html">Persistent Volumes</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-kubernetes-upgrade.html">Kubernetes Automated Upgrade</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Operator Concepts</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-operator.html">Couchbase Operator Architecture</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-operator-logging.html">Couchbase Operator Logging</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Couchbase Cluster Concepts</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-label-selection.html">Couchbase Resource Label Selection</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-rbac.html">Couchbase Resource RBAC</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-user-rbac.html">Couchbase User RBAC</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-memory-allocation.html">Couchbase Memory Allocation</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-mds.html">Couchbase Multi-Dimensional Scaling</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-scheduling.html">Couchbase Scheduling and Isolation</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-sizing.html">Couchbase Sizing</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-vertical-scaling.html">Couchbase Cluster Vertical Scaling</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-couchbase-networking.html">Couchbase Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-tls.html">Couchbase TLS</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-server-groups.html">Couchbase Server Groups</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="concept-upgrade.html">Couchbase Upgrades</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Manage</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Operator</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-operator-upgrade.html">Upgrade the Operator</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-troubleshooting.html">View Operator Logs</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-roll-your-own.html">Create Your Own Operator Images</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Couchbase Cluster</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Lifecycle</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-couchbase-create.html">Create a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-couchbase-update.html">Modify a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-couchbase-upgrade.html">Upgrade a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-couchbase-delete.html">Delete a Couchbase Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-couchbase-scale.html">Scale a Couchbase Deployment</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Configure</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-persistent-volumes.html">Configure Persistent Volumes</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-persistent-volume-resize.html">Resize Persistent Volumes</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-backup.html">Configure Backup &amp; Restore</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-mds.html">Configure Multi-Dimensional Scaling</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-xdcr.html">Configure XDCR</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-public-networking.html">Configure Public Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-nodeport-networking.html">Configure Node Port Networking</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-server-groups.html">Configure Server Groups</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-tls.html">Configure TLS</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-tls-client-certificates.html">Configure Client Certificate Authentication</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-tls-rotation.html">Rotate TLS Certificates</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-prometheus.html">Configure Prometheus Metrics Collection</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-non-root-install.html">Configure Non-Root Installs</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Connect</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-ui.html">Access the Couchbase User Interface</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-client-sdks.html">Configure Client SDKs</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Kubernetes</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="howto-storage-class.html">Create a Lazy Bound Storage Class</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Helm</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="helm-setup-guide.html">Helm Deployment</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="helm-managing-guide.html">Helm Management</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Reference</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Resource Types</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-current-page is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link is-current-page" href="reference-couchbasecluster.html">CouchbaseCluster Resource</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasecluster-status.html">CouchbaseCluster Status</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasecluster-events.html">CouchbaseCluster Events</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="2">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <a class="menu_title menu_link" href="reference-couchbasebackup.html">CouchbaseBackup Resource</a>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasebackuprestore.html">CouchbaseBackupRestore Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="3">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasebackup-status.html">CouchbaseBackup and CouchbaseBackupRestore Status</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasebucket.html">CouchbaseBucket Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbaseephemeralbucket.html">CouchbaseEphemeralBucket Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasememcachedbucket.html">CouchbaseMemcachedBucket Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasereplication.html">CouchbaseReplication Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbaseuser.html">CouchbaseUser Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasegroup.html">CouchbaseGroup Resource</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbaserolebinding.html">CouchbaseRoleBinding Resource</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Operator</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-admission-rbac.html">Dynamic Admission Controller RBAC Settings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-operator-configuration.html">Operator Deployment Settings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-operator-rbac.html">Operator RBAC Settings</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-operator-logging.html">Operator Logging</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Couchbase Cluster</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-couchbasecluster-services.html">CouchbaseCluster Services</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Helm</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="helm-couchbase-config.html">Couchbase Helm Chart Specification</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Tools</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-cbopcfg.html">cbopcfg</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="reference-cbopinfo.html">cbopinfo</a>
  </span>
</li>
</ul>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Tutorials</span>
  </span>
<ul class="menu_row">
<li class="menu_list is-parent closed" data-depth="1">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Sync Gateway</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-sync-gateway.html">Connecting Sync-Gateway to a Couchbase Cluster</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-sync-gateway-clients.html">Exposing Sync-Gateway to Couchbase Lite Clients</a>
  </span>
</li>
<li class="menu_list" data-depth="2">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-sync-gateway-manage.html">Managing Sync Gateway Cluster </a>
  </span>
</li>
</ul>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-tls.html">Creating TLS Certificates</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-remote-dns.html">Inter-Kubernetes Networking with Forwarded DNS</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-public-addressability.html">Public Networking with External DNS</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-velero-backup.html">Backup with VMware Velero</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-prometheus.html">Quick Start with Prometheus Monitoring</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-rbac-auth.html">Authenticating with Couchbase and LDAP</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-aks.html">Installing AKS</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-eks.html">Installing EKS</a>
  </span>
</li>
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="tutorial-gke.html">Installing GKE</a>
  </span>
</li>
</ul>
</li>
<li class="menu_list is-parent closed" data-depth="0">
  <span class="menu_line">
    <span class="in-toggle"></span>
    <span class="menu_title menu_text">Release Notes</span>
  </span>
<ul class="menu_row">
<li class="menu_list" data-depth="1">
  <span class="menu_line">
    <a class="menu_title menu_link" href="release-notes.html">Release Notes</a>
  </span>
</li>
</ul>
</li>
</ul>
      </div>
    </li>
  </ul>
</div>
  </div>
</aside>
<aside class="toc sidebar"
      data-title="Contents"
      data-levels="1">
  <div class="sidebar-box">
        <div class="toc-menu"></div>
    <div class="is-this-helpful-box">
      <h4> Is this page helpful?</h4>
      <div class="btn-row">
        <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                <i class="far fa-thumbs-up"></i>
            Yes

            </a>
        <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
      </div>
      <div class="any-feedback">
        <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
      </div>
      <div class="dialog-box" id="dialogBox">
        <form>
            <div class="form-group " id="additionalFeedbackBox">
              <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

              <div class="action-btn-row ">
                <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                  <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                  <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
              </div>


            </div>

        </form>

      </div>
    </div>
  </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-banner">
<i class="fas fa-file-alt"></i> <p>A newer version of this documentation is available.</p>
<a class="btn" href="../current/resource/couchbasecluster.html">View Latest</a>
</div>
<div class="article-header">
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="overview.html">Autonomous Operator</a></li>
<li class="crumb">Reference</li>
<li class="crumb">Resource Types</li>
<li class="crumb"><a href="reference-couchbasecluster.html">CouchbaseCluster Resource</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">CouchbaseCluster Resource</h1>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>To use the Couchbase Autonomous Operator to deploy a Couchbase Server cluster, you need to create a CouchbaseCluster configuration file that describes how the cluster should be configured and maintained by the Operator. Like all Kubernetes configurations, Couchbase Server clusters are defined using either YAML or JSON (YAML is preferred by Kubernetes) and then pushed into Kubernetes.</p>
</div>
<div class="paragraph">
<p>The following CouchbaseCluster configuration shows all of the available parameters.
(Note that this configuration is not valid and is meant for example purposes only.)</p>
</div>
<div class="listingblock">
<div class="title">All available CouchbaseCluster configuration parameters</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: couchbase.com/v2
kind: CouchbaseCluster
metadata:
  name: cb-example
spec:
  image: couchbase/server:6.5.1
  paused: false
  antiAffinity: true
  softwareUpdateNotifications: true
  serverGroups:
  - us-east-1a
  - us-east-1b
  - us-east-1c
  securityContext:
    runAsUser: 1000
    runAsNonRoot: true
    fsGroup: 1000
  platform: aws
  cluster:
    clusterName: cb-example
    dataServiceMemoryQuota: 256Mi
    indexServiceMemoryQuota: 256Mi
    searchServiceMemoryQuota: 256Mi
    eventingServiceMemoryQuota: 256Mi
    analyticsServiceMemoryQuota: 1Gi
    indexStorageSetting: memory_optimized
    autoFailoverTimeout: 120s
    autoFailoverMaxCount: 3
    autoFailoverOnDataDiskIssues: true
    autoFailoverOnDataDiskIssuesTimePeriod: 120s
    autoFailoverServerGroup: false
    autoCompaction:
      databaseFragmentationThreshold:
        percent: 30
        size: 1Gi
      viewFragmentationThreshold:
        percent: 30
        size: 1Gi
      parallelCompaction: false
      timeWindow:
        start: 02:00
        end: 06:00
        abortCompactionOutsideWindow: true
      tombstonePurgeInterval: 72h
  security:
    adminSecret: my-secret
    rbac:
      managed: true
      selector:
        matchLabels:
          cluster: cb-example
    ldap:
      hosts:
      - ldap.example.com
      bindDN: "cn=admin,dc=example,dc=com"
      bindSecret: cb-example-auth
      userDNMapping:
        template: "uid=%s,ou=People,dc=example,dc=com"
  networking:
    exposeAdminConsole: true
    adminConsoleServices:
    - data
    adminConsoleServiceType: LoadBalancer
    exposedFeatures:
    - xdcr
    exposedFeatureServiceType: LoadBalancer
    exposedFeatureTrafficPolicy: Local
    tls:
      static:
        serverSecret: couchbase-server-tls
        operatorSecret: couchbase-operator-tls
      clientCertificatePolicy: mandatory
      clientCertificatePaths:
      - path: san.email
        prefix: ""
        delimiter: "@"
      nodeToNodeEncryption: All
    dns:
      domain: couchbase-0.us-east-1.example.com
    serviceAnnotations:
      my-annotation: my-value
    loadBalancerSourceRanges:
    - "10.0.0.0/8"
  logging:
    logRetentionTime: 604800s
    logRetentionCount: 20
  servers:
  - size: 1
    name: all_services
    services:
    - data
    - index
    - query
    - search
    - eventing
    - analytics
    serverGroups:
    - us-east-1a
    env:
    - name: ENV1
      value: value
    envFrom:
    - secretRef:
        name: environment-secret
    resources:
      limits:
        cpu: 4
        memory: 8Gi
      requests:
        cpu: 2
        memory: 8Gi
    volumeMounts:
      default: couchbase
      data:  couchbase
      index: couchbase
      analytics:
      - couchbase
      - couchbase
    pod:
      metadata:
        labels:
          couchbase_services: all
        annotations:
          couchbase.acme.com: production
      spec:
        nodeSelector:
          instanceType: large
        tolerations:
        - key: app
          operator: Equal
          value: cbapp
          effect: NoSchedule
        priorityClassName: high-priority
        automountServiceAccountToken: false
        serviceAccountName: couchbase-pods
        imagePullSecrets:
        - name: my-pull-secret
        dnsPolicy: None
        dnsConfig:
          nameservers:
          - "10.0.0.2"
          searches:
          - cluster.local
  buckets:
    managed: true
    selector:
      matchLabels:
        cluster: cb-example
  xdcr:
    managed: true
    remoteClusters:
    - name: remote
      uuid: 611e50b21e333a56e3d6d3570309d7e3
      hostname: 10.1.0.2:31851
      authenticationSecret: my-xdcr-secret
      tls:
        secret: my-xdcr-tls-secret
      replications:
        selector:
          matchLabels:
            cluster: cb-example
  backup:
    managed: true
    image: couchbase/operator-backup:6.5.1-104
    serviceAccountName: couchbase-backup
    resources:
      requests:
        cpu: 100m
        memory: 100Mi
    selector:
      matchLabels:
        cluster: cb-example
    nodeSelector:
      class: couchbase-backup
    tolerations:
    - key: couchbase-backup
      operator: Exists
      effect: NoSchedule
  monitoring:
    prometheus:
      enabled: true
      image: couchbase/exporter:1.0.2
      authorizationSecret: cb-metrics-token
      resources:
        requests:
          cpu: 100m
          memory: 100Mi
  volumeClaimTemplates:
  - metadata:
      name: couchbase
    spec:
      storageClassName: "standard"
      resources:
        requests:
          storage: 1Gi</code></pre>
</div>
</div>
<!-- toc disabled -->
</div>
</div>
<div class="sect1">
<h2 id="top-level-definitions"><a class="anchor" href="#top-level-definitions"></a>Top-Level Definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following are the top-level parameters for a CouchbaseCluster configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: couchbase.com/v2
kind: CouchbaseCluster
metadata:
  name: cb-example
  namespace: default</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="apiversion"><a class="anchor" href="#apiversion"></a>apiversion</h3>
<div class="paragraph">
<p>This field specifies the API version for the Couchbase integration. As the integration changes over time, you can change the API version whenever new features are added. For any given release, the API versions that are supported by that Operator will be specified in the documentation. It is recommended that you upgrade to the latest API version whenever possible.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must be <code>couchbase.com/v2</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="kind"><a class="anchor" href="#kind"></a>kind</h3>
<div class="paragraph">
<p>This field specifies that this Kubernetes configuration will use the custom Couchbase controller to manage the cluster.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must always be set to <code>CouchbaseCluster</code>. The value of this field cannot be changed after the cluster is created.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="metadata-name"><a class="anchor" href="#metadata-name"></a>metadata.name</h3>
<div class="paragraph">
<p>This field sets the name of the Couchbase cluster.
It must be unique within the Kubernetes namespace.
This name controls how Operator managed resources are named.
The logical cluster name&#8201;&#8212;&#8201;as displayed in the Couchbase UI&#8201;&#8212;&#8201;may be changed with the <a href="#spec-cluster-clustername"><code>spec.cluster.clusterName</code></a> parameter.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field must be a valid DNS hostname string.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec"><a class="anchor" href="#spec"></a>spec</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the top-level parameters related to a Couchbase cluster deployment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  image: couchbase/server:6.5.1
  paused: false
  antiAffinity: true
  softwareUpdateNotifications: true
  serverGroups:
  - us-east-1a
  - us-east-1b
  - us-east-1c
  securityContext:
    runAsUser: 1000
    runAsNonRoot: true
    fsGroup: 1000
  platform: aws</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-image"><a class="anchor" href="#spec-image"></a>spec.image</h3>
<div class="paragraph">
<p>This field specifies the image that should be used.
For docker hub images for use on Kubernetes this should be similar to <code>couchbase/server:6.5.1</code>.
For Red Hat images for use with OCP this should be similar to <code>registry.connect.redhat.com/couchbase/server:6.5.1-1</code>.
Please check the relevant registry for the most up to date image tags.
You may use a different location if, for example, you have a local container registry.</p>
</div>
<div class="paragraph">
<p>Image tags must contain a valid semantic version in order to dynamically enable/disable Operator features and control upgrade paths.
For further information on upgrade constraints, please consult the <a href="concept-upgrade.html" class="page">upgrade documentation</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>image</code> field is required and must be a valid container image.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-paused"><a class="anchor" href="#spec-paused"></a>spec.paused</h3>
<div class="paragraph">
<p>This field specifies whether or not the Operator is currently managing this cluster.
This parameter may be set to <code>true</code> if you decide to make manual changes to the cluster.
By disabling Operator management, you can change the cluster configuration without having to worry about the Operator reverting the changes.
However, before re-enabling the Operator, ensure that the Kubernetes configuration matches the cluster configuration.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>paused</code> field is optional and defaults to <code>false</code> if not specified.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-antiaffinity"><a class="anchor" href="#spec-antiaffinity"></a>spec.antiAffinity</h3>
<div class="paragraph">
<p>This field specifies whether or not two pods in this cluster can be deployed on the same Kubernetes node. In a production setting this parameter should always be set to <code>true</code> in order to reduce the chance of data loss in case a Kubernetes node crashes.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>antiAffinity</code> field is optional and defaults to <code>false</code> if not specified.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-softwareupdatenotifications"><a class="anchor" href="#spec-softwareupdatenotifications"></a>spec.softwareUpdateNotifications</h3>
<div class="paragraph">
<p>This field specifies whether or not software update notifications are displayed in the Couchbase UI.  This provides a visual indication as to whether a software update is available and should be applied in order to increase functionality or fix defects.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>softwareUpdateNotifications</code> field is optional and defaults to false if not specified.  This setting can be modified at any point in the cluster life-cycle.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servergroups"><a class="anchor" href="#spec-servergroups"></a>spec.serverGroups</h3>
<div class="paragraph">
<p>Setting the server groups field enables automatic management of Couchbase server groups.  The end user is responsible for adding labels to their Kubernetes nodes which will be used to evenly distribute nodes across server groups so the cluster is tolerant to the loss of an entire data center (or any other desired failure domain).  Nodes are labeled with a key of <code>failure-domain.beta.kubernetes.io/zone</code> and an arbitrary name string.  Multiple nodes may have the same server group to allow multiple pods to be scheduled there regardless of anti-affinity settings.  An example of applying the label is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell hljs" data-lang="shell">kubectl label nodes ip-172-16-0-10 failure-domain.beta.kubernetes.io/zone=us-east-1a</code></pre>
</div>
</div>
<div class="paragraph">
<p>As the list of server groups to use is explicit the end user has flexibility in controlling exactly where pods will be scheduled e.g. one cluster may reside in one set of server groups, and another cluster in another set of server groups.</p>
</div>
<div class="paragraph">
<p>At present the scheduling simply stripes pods across the server groups; each new pod is run in a server group with the fewest existing cluster members.  This is performed on a per-server configuration basis to ensure individual classes of servers are equally distributed for high-availability.  For each class of server configuration you may choose override the set of server groups to schedule across; see the documentation under the <a href="#spec-servers-servergroups"><code>spec.servers.serverGroups</code></a> configuration key.</p>
</div>
<div class="paragraph">
<p>The server group feature also not support service redistribution at this time, so scaling the set of server groups will not result in any pods being 'moved' to make best use of the new topology or evacuated from a removed server group.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>serverGroups</code> field is optional.  If set pods will be scheduled across the specified set of server groups.  The server groups must be set at cluster creation time, and currently should be assumed to be immutable.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-securitycontext"><a class="anchor" href="#spec-securitycontext"></a>spec.securityContext</h3>
<div class="paragraph">
<p>This field is a Kubernetes <a href="https://v1-17.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.17/#podsecuritycontext-v1-core" target="_blank" rel="noopener"><code>PodSecurityContext</code></a> object which is attached to all pods that are created by the Operator. If unspecified, this will default to the <code>couchbase</code> user, mount attached volumes as that user, and ensure that the containers are running as non-root. You may override the default behavior if using a custom container image or for testing purposes.</p>
</div>
<div class="paragraph">
<p>For additional information, see the <a href="howto-non-root-install.html" class="page">non-root installation how-to</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>securityContext</code> field is optional. If set, this will be attached to all new pods that are created by the Operator.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-platform"><a class="anchor" href="#spec-platform"></a>spec.platform</h3>
<div class="paragraph">
<p>This field indicates which underlying cloud platform the Kubernetes cluster is running on and is used as a hint to correctly configure managed resources.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>platform</code> field is optional.  The Value must be one of <code>aws</code>, <code>gce</code> or <code>azure</code>.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-cluster"><a class="anchor" href="#spec-cluster"></a>spec.cluster</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object allows configuration of global Couchbase cluster settings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  cluster:
    clusterName: cb-example
    dataServiceMemoryQuota: 256Mi
    indexServiceMemoryQuota: 256Mi
    searchServiceMemoryQuota: 256Mi
    eventingServiceMemoryQuota: 256Mi
    analyticsServiceMemoryQuota: 1Gi
    indexStorageSetting: memory_optimized
    autoFailoverTimeout: 120s
    autoFailoverMaxCount: 3
    autoFailoverOnDataDiskIssues: true
    autoFailoverOnDataDiskIssuesTimePeriod: 120s
    autoFailoverServerGroup: false
    autoCompaction:
      databaseFragmentationThreshold:
        percent: 30
        size: 1Gi
      viewFragmentationThreshold:
        percent: 30
        size: 1Gi
      parallelCompaction: false
      timeWindow:
        start: 02:00
        end: 06:00
        abortCompactionOutsideWindow: true
      tombstonePurgeInterval: 72h</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-clustername"><a class="anchor" href="#spec-cluster-clustername"></a>spec.cluster.clusterName</h3>
<div class="paragraph">
<p>This field allows the cluster name&#8201;&#8212;&#8201;as displayed in the Couchbase UI&#8201;&#8212;&#8201;to be overridden.
This field will be set to <code>metadata.name</code> if not specified.
As <code>metadata.name</code> is required to be a valid DNS hostname, this field allows those limitations to be bypassed.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>field rules:</em> This field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-dataservicememoryquota"><a class="anchor" href="#spec-cluster-dataservicememoryquota"></a>spec.cluster.dataServiceMemoryQuota</h3>
<div class="paragraph">
<p>The amount of memory to assign&#8201;&#8212;&#8201;per-node&#8201;&#8212;&#8201;to the data service if it is present on a specific Couchbase node.
This parameter defaults to 256Mi if it is not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a resource quantity greater than or equal to 256Mi. The sum of all memory quotas must be no more than 80% of a pod&#8217;s available memory.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-indexservicememoryquota"><a class="anchor" href="#spec-cluster-indexservicememoryquota"></a>spec.cluster.indexServiceMemoryQuota</h3>
<div class="paragraph">
<p>The amount of memory to assign&#8201;&#8212;&#8201;per-node&#8201;&#8212;&#8201;to the index service if it is present on a specific Couchbase node.
This parameter defaults to 256Mi if it is not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a resource quantity greater than or equal to 256Mi. The sum of all memory quotas must be no more than 80% of a pod&#8217;s available memory.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-searchservicememoryquota"><a class="anchor" href="#spec-cluster-searchservicememoryquota"></a>spec.cluster.searchServiceMemoryQuota</h3>
<div class="paragraph">
<p>The amount of memory to assign&#8201;&#8212;&#8201;per-node&#8201;&#8212;&#8201;to the search service if it is present on a specific Couchbase node.
This parameter defaults to 256Mi if it is not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a resource quantity greater than or equal to 256Mi. The sum of all memory quotas must be no more than 80% of a pod&#8217;s available memory.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-eventingservicememoryquota"><a class="anchor" href="#spec-cluster-eventingservicememoryquota"></a>spec.cluster.eventingServiceMemoryQuota</h3>
<div class="paragraph">
<p>The amount of memory to assign&#8201;&#8212;&#8201;per-node&#8201;&#8212;&#8201;to the eventing service if present on a specific Couchbase node in Mi.
This parameter defaults to 256Mi if it is not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a resource quantity greater than or equal to 256Mi. The sum of all memory quotas must be no more than 80% of a pod&#8217;s available memory.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-analyticsservicememoryquota"><a class="anchor" href="#spec-cluster-analyticsservicememoryquota"></a>spec.cluster.analyticsServiceMemoryQuota</h3>
<div class="paragraph">
<p>The amount of memory to assign&#8201;&#8212;&#8201;per-node&#8201;&#8212;&#8201;to the analytics service if present on a specific Couchbase node in Mi.
This parameter defaults to 1Gi if it is not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a resource quantity greater than or equal to 1GI. The sum of all memory quotas must be no more than 80% of a pod&#8217;s available memory.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-indexstoragesetting"><a class="anchor" href="#spec-cluster-indexstoragesetting"></a>spec.cluster.indexStorageSetting</h3>
<div class="paragraph">
<p>Specifies the backend storage type to use for the index service. If the cluster already contains a Couchbase Server instance running the index service, then this parameter cannot be changed until all Couchbase instances running the index service are removed.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>indexStorageSetting</code> is optional and defaults to <code>memory_optimized</code>. Values allowed are <code>plasma</code> or <code>memory_optimized</code>. After the Couchbase cluster is deployed, the value of this field can only be changed if there are no Index nodes in the cluster.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autofailovertimeout"><a class="anchor" href="#spec-cluster-autofailovertimeout"></a>spec.cluster.autoFailoverTimeout</h3>
<div class="paragraph">
<p>Specifies the auto-failover timeout. The Operator relies on the CouchbaseCluster to auto-failover nodes before removing them, so setting this field to an appropriate value is important.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>autoFailoverTimeout</code> is optional and must be a duration in the range 5s-3600s.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autofailovermaxcount"><a class="anchor" href="#spec-cluster-autofailovermaxcount"></a>spec.cluster.autoFailoverMaxCount</h3>
<div class="paragraph">
<p>Specifies the maximum number of failover events we can tolerate before manual intervention is required.  If a bucket as 2 replicas we can tolerate 2 pods failing over.  Applies to entire server groups also.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>autoFailoverMaxCount</code> is required and must be in the range 1-3.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autofailoverondatadiskissues"><a class="anchor" href="#spec-cluster-autofailoverondatadiskissues"></a>spec.cluster.autoFailoverOnDataDiskIssues</h3>
<div class="paragraph">
<p>Specifies whether a node will automatically fail over on data disk issues.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>autoFailoverOnDataDiskIssues</code> is required and must be <code>true</code> or <code>false</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autofailoverondatadiskissuestimeperiod"><a class="anchor" href="#spec-cluster-autofailoverondatadiskissuestimeperiod"></a>spec.cluster.autoFailoverOnDataDiskIssuesTimePeriod</h3>
<div class="paragraph">
<p>Specifies the time period to wait before automatically failing over a node experiencing data disk issues.  This field&#8217;s units are in seconds.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>autoFailoverOnDataDiskIssuesTimePeriod</code> is only required if <code>autoFailoverOnDataDiskIssues</code> is also set to <code>true</code>.  It must be a duration in the range 5s-3600s.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autofailoverservergroup"><a class="anchor" href="#spec-cluster-autofailoverservergroup"></a>spec.cluster.autoFailoverServerGroup</h3>
<div class="paragraph">
<p>Specifies whether the cluster will automatically failover an entire server group.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>autoFailoverServerGroup</code> is optional, defaulting to false.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-cluster-autocompaction"><a class="anchor" href="#spec-cluster-autocompaction"></a>spec.cluster.autoCompaction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object allows configuration of global Couchbase auto-compaction settings.</p>
</div>
<div class="paragraph">
<p>It is far more efficient to append database updates to files rather than rewriting them.
This gives rise to stale data within the database file.
This is known as fragmentation.</p>
</div>
<div class="paragraph">
<p>Auto compaction is required periodically to reclaim disk space caused by fragmentation.
Auto compaction occurs automatically by default in Couchbase Server.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  cluster:
    autoCompaction:
      databaseFragmentationThreshold:
        percent: 30
        size: 1Gi
      viewFragmentationThreshold:
        percent: 30
        size: 1Gi
      parallelCompaction: false
      timeWindow:
        start: 02:00
        end: 06:00
        abortCompactionOutsideWindow: true
      tombstonePurgeInterval: 72h</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-databasefragmentationthreshold-percent"><a class="anchor" href="#spec-cluster-autocompaction-databasefragmentationthreshold-percent"></a>spec.cluster.autoCompaction.databaseFragmentationThreshold.percent</h3>
<div class="paragraph">
<p>This field defines the relative amount of fragmentation allowed in persistent database files before triggering compaction.
This field defaults to <code>30</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be an integer in the range 2-100.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-databasefragmentationthreshold-size"><a class="anchor" href="#spec-cluster-autocompaction-databasefragmentationthreshold-size"></a>spec.cluster.autoCompaction.databaseFragmentationThreshold.size</h3>
<div class="paragraph">
<p>This field defines the absolute amount of fragmentation allowed in persistent database files before triggering compaction.
This field is not set by default.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a Kubernetes <a href="https://godoc.org/k8s.io/apimachinery/pkg/api/resource#Quantity" target="_blank" rel="noopener">resource quantity</a>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-viewfragmentationthreshold-percent"><a class="anchor" href="#spec-cluster-autocompaction-viewfragmentationthreshold-percent"></a>spec.cluster.autoCompaction.viewFragmentationThreshold.percent</h3>
<div class="paragraph">
<p>This field defines the relative amount of fragmentation allowed in persistent view files before triggering compaction.</p>
</div>
<div class="paragraph">
<p>This field defaults to <code>30</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be an integer in the range 2-100.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-viewfragmentationthreshold-size"><a class="anchor" href="#spec-cluster-autocompaction-viewfragmentationthreshold-size"></a>spec.cluster.autoCompaction.viewFragmentationThreshold.size</h3>
<div class="paragraph">
<p>This field defines the absolute amount of fragmentation allowed in persistent view files before triggering compaction.
This field is not set by default.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a Kubernetes <a href="https://godoc.org/k8s.io/apimachinery/pkg/api/resource#Quantity" target="_blank" rel="noopener">resource quantity</a>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-parallelcompaction"><a class="anchor" href="#spec-cluster-autocompaction-parallelcompaction"></a>spec.cluster.autoCompaction.parallelCompaction</h3>
<div class="paragraph">
<p>This field defines whether auto-compaction should be performed in parallel.</p>
</div>
<div class="paragraph">
<p>Setting this field to <code>true</code> will potentially yield shorter compaction times.
This comes at the expense of far greater disk IO that may compete with normal database operation.
This field should only be used on storage capable of handling the greater IO requirements e.g. solid state.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-timewindow-start"><a class="anchor" href="#spec-cluster-autocompaction-timewindow-start"></a>spec.cluster.autoCompaction.timeWindow.start</h3>
<div class="paragraph">
<p>This field defines when an auto-compaction may start to run.</p>
</div>
<div class="paragraph">
<p>Auto compaction comes with a cost associated with disk IO.
It may be undesirable for it to run during core business hours as it competes with normal database operation.
This field allows auto-compaction to be limited to a specific time window when fewer resources are required by normal database operation.
This field is not set by default.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string in the form <code>HH:MM</code> where HH is in the range 0-23 and MM is in the range 0-59.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-timewindow-end"><a class="anchor" href="#spec-cluster-autocompaction-timewindow-end"></a>spec.cluster.autoCompaction.timeWindow.end</h3>
<div class="paragraph">
<p>This field defines when an auto-compaction may run until.</p>
</div>
<div class="paragraph">
<p>Auto compaction comes with a cost associated with disk IO.
It may be undesirable for it to run during core business hours as it competes with normal database operation.
This field allows auto-compaction to be limited to a specific time window when fewer resources are required by normal database operation.
This field is not set by default.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string in the form <code>HH:MM</code> where HH is in the range 0-23 and MM is in the range 0-59.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-timewindow-abortcompactionoutsidewindow"><a class="anchor" href="#spec-cluster-autocompaction-timewindow-abortcompactionoutsidewindow"></a>spec.cluster.autoCompaction.timeWindow.abortCompactionOutsideWindow</h3>
<div class="paragraph">
<p>This field defines whether to stop auto-compaction after the time window end.</p>
</div>
<div class="paragraph">
<p>By default an auto-compaction will run until completion.
In some situations it may be desirable to stop auto-compaction to free up resources for normal database operation.
This field defaults to <code>false</code> if not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-cluster-autocompaction-tombstonepurgeinterval"><a class="anchor" href="#spec-cluster-autocompaction-tombstonepurgeinterval"></a>spec.cluster.autoCompaction.tombstonePurgeInterval</h3>
<div class="paragraph">
<p>This field defines how frequently tombstones may be purged.</p>
</div>
<div class="paragraph">
<p>Couchbase Server maintains tombstones.
These are records of deleted documents.
Tombstones are retained so that eventually consistent consumers can observe document deletion in the event of a disconnection.
This field defaults to <code>72h</code> if not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a valid <a href="https://golang.org/pkg/time/#ParseDuration" target="_blank" rel="noopener">duration</a> in the range 1h-60d.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-security"><a class="anchor" href="#spec-security"></a>spec.security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object allows configuration of global Couchbase security settings and RBAC.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  security:
    adminSecret: my-secret
    rbac:
      managed: true
      selector:
        matchLabels:
          cluster: cb-example</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-adminsecret"><a class="anchor" href="#spec-security-adminsecret"></a>spec.security.adminSecret</h3>
<div class="paragraph">
<p>This field specifies the name of a Kubernetes Secret that should be used as the user name and password of the Couchbase super-user.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>adminSecret</code> field is required and should reference the name of a <a href="https://kubernetes.io/docs/concepts/configuration/secret/">Kubernetes Secret</a> that already exists. The value of this field cannot be changed after the cluster is created.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-security-rbac"><a class="anchor" href="#spec-security-rbac"></a>spec.security.rbac</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  security:
    rbac:
      managed: true
      selector:
        matchLabels:
          cluster: cb-example</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-rbac-managed"><a class="anchor" href="#spec-security-rbac-managed"></a>spec.security.rbac.managed</h3>
<div class="paragraph">
<p>This field specifies whether the Operator should manage Couchbase RBAC.
This field defaults to <code>false</code> allowing the user to manually manage RBAC settings with the <a href="howto-ui.html" class="page">Couchbase web console</a> or the Couchbase API.
If set to <code>true</code>, the Operator will search for <a href="reference-couchbaserolebinding.html" class="page"><code>CouchbaseRoleBinding</code></a> resources in the namespace under the control of the <a href="#spec-security-rbac-selector"><code>spec.security.rbac.selector</code></a> field.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-rbac-selector"><a class="anchor" href="#spec-security-rbac-selector"></a>spec.security.rbac.selector</h3>
<div class="paragraph">
<p>This field specifies which <a href="reference-couchbaserolebinding.html" class="page"><code>CouchbaseRoleBinding</code></a> resources are considered when the <a href="#spec-security-rbac-managed"><code>spec.security.rbac.managed</code></a> field is set to <code>true</code>.
If not specified all <a href="reference-couchbaserolebinding.html" class="page"><code>CouchbaseRoleBinding</code></a> resources are selected.
If specified, then only <a href="reference-couchbaserolebinding.html" class="page"><code>CouchbaseRoleBinding</code></a> resources containing the same labels as specified in the label selector are selected.</p>
</div>
<div class="paragraph">
<p>For additional information, see the <a href="concept-label-selection.html" class="page">Couchbase resource label selection</a> documentation.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules</em>: This field is optional and must be a Kubernetes <code>LabelSelector</code> object.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-security-ldap"><a class="anchor" href="#spec-security-ldap"></a>spec.security.ldap</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  security:
    ldap:
      hosts:
      - ldap.example.com
      port: 389
      bindDN: "cn=admin,dc=example,dc=com"
      bindSecret: cb-example-auth
      authenticationEnabled: true
      userDNMapping:
        template: "uid=%s,ou=People,dc=example,dc=com"
      authorizationEnabled: true
      groupsQuery: "cn=users,ou=Groups,dc=example,dc=com??base?"
      nestedGroupsEnabled: true
      encryption: StartTLSExtension
      tlsSecret: ldap-secret</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-hosts"><a class="anchor" href="#spec-security-ldap-hosts"></a>spec.security.ldap.hosts</h3>
<div class="paragraph">
<p>This field specifies list of LDAP hosts Operator should connect to for authentication.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must be a list of at least one hostname.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-port"><a class="anchor" href="#spec-security-ldap-port"></a>spec.security.ldap.port</h3>
<div class="paragraph">
<p>This field specifies the port Operator should use connect when connecting to hosts.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and default to <code>389</code> if not specified.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-binddn"><a class="anchor" href="#spec-security-ldap-binddn"></a>spec.security.ldap.bindDN</h3>
<div class="paragraph">
<p>This field specifies the Distinguished Name (DN) to bind to on the LDAP server for performing administrative tasks such as query and authentication.
If not specified, the operator will attempt to connect anonymously to the specified LDAP host(s).</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-bindsecret"><a class="anchor" href="#spec-security-ldap-bindsecret"></a>spec.security.ldap.bindSecret</h3>
<div class="paragraph">
<p>This field specifies the secret containing the password that the Operator should use to perform LDAP queries and authentication.
If specified the secret must refer to a Kubernetes secret containing a key named <code>password</code>.
If not specified, the operator will attempt to connect anonymously to the specified LDAP host(s).</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-authenticationenabled"><a class="anchor" href="#spec-security-ldap-authenticationenabled"></a>spec.security.ldap.authenticationEnabled</h3>
<div class="paragraph">
<p>This field specifies whether or not the Couchbase Server allows user authentication.
This defaults to <code>true</code> and the template specified in the <code>spec.security.ldap.userDNMapping</code> field will be used to search for the LDAP user to authenticate as an associated Couchbase Server user.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean.  The default value is <code>true</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-userdnmapping-template"><a class="anchor" href="#spec-security-ldap-userdnmapping-template"></a>spec.security.ldap.userDNMapping.template</h3>
<div class="paragraph">
<p>This field specifies list of templates to use for providing username to DN mapping.
The template may contain a placeholder specified as <code>%u</code> to represent the Couchbase user who is attempting to gain access.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string.  The <code>spec.secure.ldap.authenticationEnabled</code> field must also be <code>true</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-authorizationenabled"><a class="anchor" href="#spec-security-ldap-authorizationenabled"></a>spec.security.ldap.authorizationEnabled</h3>
<div class="paragraph">
<p>This field specifies whether or not the Couchbase Server is allowed to authorize authenticated LDAP users.
If set to <code>true</code>, the value of <code>spec.security.ldap.groupsQuery</code> will be used to check the LDAP group membership of a user in order to authorize them.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean.  The default value is <code>true</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-groupsquery"><a class="anchor" href="#spec-security-ldap-groupsquery"></a>spec.security.ldap.groupsQuery</h3>
<div class="paragraph">
<p>This field specifies the Distinguished Name (DN) of the LDAP group containing users which can be authorized.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string. The <code>spec.secure.ldap.authorizationEnabled</code> field must also be <code>true</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-encryption"><a class="anchor" href="#spec-security-ldap-encryption"></a>spec.security.ldap.encryption</h3>
<div class="paragraph">
<p>This field specifies the type of encryption to use for connection with the LDAP server.  If this value is set to <code>TLS</code> or <code>StartTLSExtension</code>, and a certificate is not specified for <code>spec.security.ldap.tlsSecret</code>, then the couchbase server will attempt to use its own certificate for encryption.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be either <code>None</code>, <code>TLS</code>, <code>StartTLSExtension</code>.
The default value is <code>None</code> (to connect without encryption — this is insecure, and therefore is not recommended).</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-security-ldap-tlssecret"><a class="anchor" href="#spec-security-ldap-tlssecret"></a>spec.security.ldap.tlsSecret</h3>
<div class="paragraph">
<p>This field specifies the Certificate to use for connecting with LDAP server when <code>spec.security.ldap.encryption</code> is either TLS or StartTLSExtension.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a kubernetes secret containing a certificate in PEM format.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-networking"><a class="anchor" href="#spec-networking"></a>spec.networking</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object allows configuration of network related options.
These options allow you to connect to Couchbase from outside the Kubernetes cluster, and secure network traffic with transport layer security (TLS).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  networking:
    exposeAdminConsole: true
    adminConsoleServices:
    - data
    adminConsoleServiceType: LoadBalancer
    exposedFeatures:
    - xdcr
    exposedFeatureServiceType: LoadBalancer
    exposedFeatureTrafficPolicy: Local
    dns:
      domain: couchbase-0.us-east-1.example.com
    serviceAnnotations:
      my-annotation: my-value
    loadBalancerSourceRanges:
    - "10.0.0.0/8"
    tls:
      static:
        serverSecret: couchbase-server-tls
        operatorSecret: couchbase-operator-tls
      clientCertificatePolicy: mandatory
      clientCertificatePaths:
      - path: san.email
        prefix: ""
        delimiter: "@"
      nodeToNodeEncryption: All</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-exposeadminconsole"><a class="anchor" href="#spec-networking-exposeadminconsole"></a>spec.networking.exposeAdminConsole</h3>
<div class="paragraph">
<p>This field specifies whether or not the Couchbase Server Web Console should be exposed externally. Exposing the web console is done using a NodePort service and the port for the service can be found in the describe output when describing this cluster. This parameter may be changed while the cluster is running and the Operator will create/destroy the NodePort service as appropriate.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>exposeAdminConsole</code> field is optional and defaults to <code>false</code> if not specified.  If set to <code>true</code> the specification must also have the <a href="#spec-networking-adminconsoleservices"><code>spec.networking.adminConsoleServices</code></a> property defined.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-adminconsoleservices"><a class="anchor" href="#spec-networking-adminconsoleservices"></a>spec.networking.adminConsoleServices</h3>
<div class="paragraph">
<p>When the Couchbase Server Web Console is exposed with the <a href="#spec-networking-exposeadminconsole"><code>spec.networking.exposeAdminConsole</code></a> property, by default, opening a browser session to the Web Console will be automatically load balanced across all pods in the cluster to provide high availability. However, the Web Console will display different features based on the services that are running on the particular pod that it&#8217;s connected to.</p>
</div>
<div class="paragraph">
<p>This property allows the UI service to be constrained to pods running one or more specific services. The services that you specify are subtractive in nature — they will only identify pods running all of those services — so care must be used. For example, if the cluster is deployed with multi-dimensional scaling, the data service on one set of pods, and the analytics service on another mutually exclusive set, then specifying <code>data</code> and <code>analytics</code> as your Web Console services list would result in the Web Console not being accessible — no pods match all the constraints, i.e. no pods are running both the data and analytics services.</p>
</div>
<div class="paragraph">
<p>If you require access to a specific pod running a specific service, this can also be achieved by using the <code>admin</code> option of the <a href="#spec-networking-exposedfeatures"><code>spec.networking.exposedFeatures</code></a> property.  This will allow access via a node port. You must connect directly to the IP address of the node that the pod is running on. The assigned node port is available via the cluster status structure returned by <code>kubectl describe</code>, or via the output of <code>kubectl get services</code>. Refer to the <a href="reference-couchbasecluster-services.html" class="page">services documentation</a> for more information.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>adminConsoleServices</code> list is optional and defaults to an empty list. Valid item names are <code>data</code>, <code>index</code>, <code>query</code>, <code>search</code>, <code>eventing</code>, and <code>analytics</code>, and must be unique. An empty list means that any node in the cluster may be chosen when connecting to the Couchbase Server Web Console.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-adminconsoleservicetype"><a class="anchor" href="#spec-networking-adminconsoleservicetype"></a>spec.networking.adminConsoleServiceType</h3>
<div class="paragraph">
<p>This field defines how the admin console service is exposed.  By default it will use a <code>NodePort</code> which exposes the console on a random port on all nodes in the cluster.  It is accessible only within the cluster or via an IP tunnel into the Kubernetes underlay network.  If set to <code>LoadBalancer</code> it will expose the default admin console port to the public internet via a load balancer on platforms which support this service type.  Only the TLS enabled port (18091) will be exposed to public networks.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>adminConsoleServiceType</code> field is optional and defaults to <code>NodePort</code>.  Allowed values are <code>NodePort</code> and <code>LoadBalancer</code>.  If this field is <code>LoadBalancer</code> then you must also define a <a href="#spec-networking-dns-domainm"><code>spec.dns.domain</code></a>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-exposedfeatures"><a class="anchor" href="#spec-networking-exposedfeatures"></a>spec.networking.exposedFeatures</h3>
<div class="paragraph">
<p>This field specified a list of per-pod features to expose on the cluster network (as opposed to the pod network).  These define sets of ports which are required to support the specified features.  The supported values are as follows:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">admin</dt>
<dd>
<p>Exposes the admin API and UI</p>
</dd>
<dt class="hdlist1">xdcr</dt>
<dd>
<p>Exposes the ports necessary to support XDCR via L3 connectivity at the cluster network layer.</p>
</dd>
<dt class="hdlist1">client</dt>
<dd>
<p>Exposes all client services.  These include data, views, query, full text search, analytics.</p>
</dd>
</dl>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>exposedFeatures</code> list is optional, no feature sets are exposed to the cluster network if unset.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-exposedfeatureservicetype"><a class="anchor" href="#spec-networking-exposedfeatureservicetype"></a>spec.networking.exposedFeatureServiceType</h3>
<div class="paragraph">
<p>This field defines how the per Couchbase node ports are exposed.  By default it will use a <code>NodePort</code> which exposes the <code>exposedFeatures</code> on random ports per service on the Kubernetes nodes running the cluster.  They are accessible only within the cluster or via an IP tunnel into the Kubernetes underlay network.  If set to <code>LoadBalancer</code> it will expose the default exposed service ports on the public internet via a load balancer on platforms which support this service type.  Only the TLS enabled ports will be exposed to public networks.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>exposedFeatureServiceType</code> field is optional and defaults to <code>NodePort</code>.  Allowed values are <code>NodePort</code> and <code>LoadBalancer</code>.  If this field is <code>LoadBalancer</code> then you must also define a <code>spec.dns.domain</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-exposedfeaturetrafficpolicy"><a class="anchor" href="#spec-networking-exposedfeaturetrafficpolicy"></a>spec.networking.exposedFeatureTrafficPolicy</h3>
<div class="paragraph">
<p>This field defines how traffic ingressing into Kubernetes is handled.
By default this is set to <code>Local</code> meaning that traffic from a public load balancer must be routed directly to the node upon which the destination <code>Pod</code> is resident.
This enforces consistent network performance by keeping the number of hops from the edge to the pod consistent.
Some environments may have external firewall rules in place that prevent the Operator from connecting to an externally advertised address to verify client connectivity before allowing data to reside on that node.
This field may be set to <code>Cluster</code> to work around this issue, masquerading connectivity checks as normal node-to-node Kubernetes traffic, but at the expense of inconsistent network paths.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>exposedFeatureTrafficPolicy</code> field is optional and defaults to <code>Local</code>.  Allowed values are <code>Local</code> and <code>Cluster</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-serviceannotations"><a class="anchor" href="#spec-networking-serviceannotations"></a>spec.networking.serviceAnnotations</h3>
<div class="paragraph">
<p>This field defines any custom annotations to be added to console and per-pod (exposed feature) services.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The serviceAnnotations field is optional.  If specified it must be a map of key/value pairs conforming to Kubernetes annotation rules.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-networking-dns"><a class="anchor" href="#spec-networking-dns"></a>spec.networking.dns</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section describes the configuration of the dynamic domain name system [DDNS].  When exposing services to the public internet we mandate that TLS is used to protect against plain text user names, passwords and data.  DDNS is used to dynamically populate the DNS with Couchbase nodes during the cluster lifecycle so they are addressable with stable names.</p>
</div>
<div class="paragraph">
<p>Given the example domain <code>couchbase-0.us-east-1.example.com</code> it will annotate the admin service as requiring the name <code>console.couchbase-0.us-east-1.example.com</code> to be added to the DNS when using the <em>LoadBalancer</em> service type.  When a pod is created with the name <code>couchbase-0000</code> it will annotate the per-pod exposed features service as requiring the name <code>couchbase-0000.couchbase-0.us-east-1.example.com</code> to be added to the DNS when using the <em>LoadBalancer</em> service type.</p>
</div>
<div class="paragraph">
<p>The user is required to use these annotations to actually create the DNS entries as the services are created, updated and modified.  The recommended solution is the <a href="https://github.com/kubernetes-incubator/external-dns">Kubernetes External DNS</a> integration.  As such services will be annotated with <code>external-dns.alpha.kubernetes.io/hostname</code>.</p>
</div>
<div class="paragraph">
<p>The DNS configuration can also be used with the <em>NodePort</em> external feature type.
This allows the cluster to be addressed with DNS over private networks e.g. through a VPN.
In this mode of operation the Operator does not enforce the use of TLS.
To create A records for your individual Couchbase server nodes, map the service DNS name annotation to the associated pod&#8217;s node IP address.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The individual DNS per-pod exposed service A records should be dynamically collated into an SRV record.  This provides a stable name for the cluster as nodes are added and removed during the cluster lifecycle, and service discovery.  The resource name for the given examples should be <code>_couchbases._tcp.couchbase-0.us-east-1.example.com</code>, with equal priority and weight and a port value of <code>11207</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
When creating your cluster TLS certificates you will need to add a wildcard entry in the subject alternate names list for your specified domain.  For the given examples this would be <code>DNS:*.couchbase-0.us-east-1.example.com</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Exposing database services to public networks is inherently dangerous.  XDCR and client connectivity can also be achieved with secure IPSEC tunnels.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  dns:
    domain: couchbase-0.us-east-1.example.com</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-dns-domain"><a class="anchor" href="#spec-networking-dns-domain"></a>spec.networking.dns.domain</h3>
<div class="paragraph">
<p>This field defines the DNS A records that should be dynamically added to the public DNS for console and per-pod services.  It must be a valid domain name which you have ownership of and the ability to dynamically update as services are created, updated and deleted by the Operator.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>domain</code> field is required when either the <code>exposedFeatureServiceType</code> or <code>adminConsoleServiceType</code> fields are configured as <em>LoadBalancer</em>.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-networking-tls"><a class="anchor" href="#spec-networking-tls"></a>spec.networking.tls</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This field is optional and controls whether the Operator uses TLS for communication with the cluster.
It also sets the TLS certificates that are used by Couchbase clients and XDCR.
Refer to the <a href="howto-tls.html" class="page">TLS documentation</a> for more information.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  networking:
    tls:
      static:
        serverSecret: couchbase-server-tls
        operatorSecret: couchbase-operator-tls
      clientCertificatePolicy: mandatory
      clientCertificatePaths:
      - path: san.email
        prefix: ""
        delimiter: "@"
      nodeToNodeEncryption: All</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-static-serversecret"><a class="anchor" href="#spec-networking-tls-static-serversecret"></a>spec.networking.tls.static.serverSecret</h3>
<div class="paragraph">
<p>This field defines the certificate and private key used by Couchbase Server services.</p>
</div>
<div class="paragraph">
<p>This field is required if any static TLS configuration is specified under <code>spec.networking.tls.static</code>.
This field references a secret containing a key <code>chain.pem</code> whose value is a wildcard certificate chain signed by the cluster CA defined in <code>spec.networking.tls.static.operatorSecret</code>, and <code>pkey.key</code> whose value is a private key corresponding to the leaf certificate.
The <a href="howto-tls.html" class="page">TLS documentation</a> contains detailed information on generating valid certificates for your cluster.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required when <code>spec.networking.tls.static</code> is defined and must be a string referencing a Kubernetes <code>Secret</code> resource.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-static-operatorsecret"><a class="anchor" href="#spec-networking-tls-static-operatorsecret"></a>spec.networking.tls.static.operatorSecret</h3>
<div class="paragraph">
<p>This field defines the CA certificate and optionally a client certificate and private key used to authenticate the Operator.</p>
</div>
<div class="paragraph">
<p>This field is required if any static TLS configuration is specified under <code>spec.networking.tls.static</code>.
This field references a secret containing a key <code>ca.crt</code> whose value is a CA certificate.
The CA certificate must be the root authority for a server certificate defined in <code>spec.networking.tls.static.member.serverSecret</code>.
The <a href="howto-tls.html" class="page">TLS documentation</a> contains detailed information on generating valid certificates for your cluster.</p>
</div>
<div class="paragraph">
<p>If <code>spec.networking.tls.clientCertificatePolicy</code> is set to <code>enable</code> then <code>operatorSecret</code> may contain a client certificate and private key.</p>
</div>
<div class="paragraph">
<p>If <code>spec.networking.tls.clientCertificatePolicy</code> is set to <code>mandatory</code> then <code>operatorSecret</code> must contain a client certificate and private key.</p>
</div>
<div class="paragraph">
<p>When using client certificates the secret must contain a key <code>couchbase-operator.crt</code> whose value is a client certificate chain signed by the cluster CA defined above, and <code>couchbase-operator.key</code> whose value is a private key corresponding the leaf client certificate.
The client certificate must resolve&#8201;&#8212;&#8201;with <code>spec.networking.tls.clientCertificatePaths[]</code>&#8201;&#8212;&#8201;to the administrative user name defined in <code>spec.security.adminSecret</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required when <code>spec.networking.tls.static</code> is defined and must be a string referencing a Kubernetes <code>Secret</code> resource.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-clientcertificatepolicy"><a class="anchor" href="#spec-networking-tls-clientcertificatepolicy"></a>spec.networking.tls.clientCertificatePolicy</h3>
<div class="paragraph">
<p>This field defines the client certificate policy that Couchbase Server should use.</p>
</div>
<div class="paragraph">
<p>If not defined Couchbase Server will use basic authentication&#8201;&#8212;&#8201;username and password&#8201;&#8212;&#8201;over server side TLS.</p>
</div>
<div class="paragraph">
<p>If set to <code>enable</code> then Couchbase Server will request a client certificate and the clients may return one in order to authenticate.
If a client certificate is not returned by the client Couchbase Server will fall back to basic authentication.
If you require certificate authentication by the Operator then you may define it in <code>spec.networking.tls.static.operatorSecret</code>.</p>
</div>
<div class="paragraph">
<p>If set to <code>mandatory</code> then Couchbase Server will request a client certificate and the client must return one in order to authenticate.
You must define the client certificate in <code>spec.networking.tls.static.operatorSecret</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be either <code>enable</code> or <code>mandatory</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-clientcertificatepaths"><a class="anchor" href="#spec-networking-tls-clientcertificatepaths"></a>spec.networking.tls.clientCertificatePaths[]</h3>
<div class="paragraph">
<p>This list defines how Couchbase Server should parse client certificates in order to extract a valid user.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> If using client certificates this list should contain at least one item.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-clientcertificatepaths-path"><a class="anchor" href="#spec-networking-tls-clientcertificatepaths-path"></a>spec.networking.tls.clientCertificatePaths[].path</h3>
<div class="paragraph">
<p>This field defines where to extract the username from.
Couchbase Server currently allows usernames to be defined in the certificate subject common name (CN), or subject alternative names (SAN).
Valid SANs that can be parsed are URI, DNS or EMAIL records.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must be either <code>subject.cn</code>, <code>san.uri</code>, <code>san.dns</code> or <code>san.email</code>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-clientcertificatepaths-prefix"><a class="anchor" href="#spec-networking-tls-clientcertificatepaths-prefix"></a>spec.networking.tls.clientCertificatePaths[].prefix</h3>
<div class="paragraph">
<p>This field defines whether the username is prefixed.</p>
</div>
<div class="paragraph">
<p>This allows, for example, a CN of <code>www.example.com</code> to be mapped to a username <code>example.com</code> by specifying a prefix of <code>www.</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-clientcertificatepaths-delimiter"><a class="anchor" href="#spec-networking-tls-clientcertificatepaths-delimiter"></a>spec.networking.tls.clientCertificatePaths[].delimiter</h3>
<div class="paragraph">
<p>This field defines whether the username is delimited.</p>
</div>
<div class="paragraph">
<p>This allows, for example, an EMAIL SAN of <code>jane.doe@example.com</code> to be mapped to the username <code>jane.doe</code> by specifying a delimiter of <code>@</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-networking-tls-nodetonodeencryption"><a class="anchor" href="#spec-networking-tls-nodetonodeencryption"></a>spec.networking.tls.nodeToNodeEncryption</h3>
<div class="paragraph">
<p>This field defines whether node-to-node encryption is enabled.</p>
</div>
<div class="paragraph">
<p>When set to <code>All</code>, all data between Couchbase server nodes is encrypted.
When set to <code>ControlPlaneOnly</code>, only internal Couchbase server messages are encrypted, user data is not.
If not specified, data between Couchbase Server nodes is not encrypted.</p>
</div>
<div class="paragraph">
<p>As with all encryption protocols, this setting may negatively affect performance with the increased data protection.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be either <code>All</code> or <code>ControlPlaneOnly</code>.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-logging"><a class="anchor" href="#spec-logging"></a>spec.logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object allows configuration of Operator logging functionality.
This ensures any persistent logs do not consume excessive amounts of resource or persist for too long.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  logging:
    logRetentionTime: 604800s
    logRetentionCount: 20</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-logging-logretentiontime"><a class="anchor" href="#spec-logging-logretentiontime"></a>spec.logging.logRetentionTime</h3>
<div class="paragraph">
<p>This field is used in conjunction with the <code>logs</code> persistent volume mount.  The value can be anything that can be parsed by the <a href="https://golang.org/pkg/time/#ParseDuration" target="_blank" rel="noopener">golang ParseDuration</a> function.  If specified this controls the retention period that log volumes are kept for after their associated pods have been deleted.  If not specified (the default) or zero e.g. 0s, log volumes are retained indefinitely.</p>
</div>
<div class="paragraph">
<p>It is recommended to specify this field when using ephemeral server classes so that potentially sensitive information is not retained indefinitely.  This allows compliance with data privacy legislation.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>logRetentionTime</code> field is optional and defaults to <code>""</code>.  If specified it must contain a decimal number and a unit suffix such as <code>s</code>, <code>m</code> or <code>h</code>.  The decimal number cannot be negative.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-logging-logretentioncount"><a class="anchor" href="#spec-logging-logretentioncount"></a>spec.logging.logRetentionCount</h3>
<div class="paragraph">
<p>This field is used in conjunction with the <code>logs</code> persistent volume mount.  If specified this controls the maximum number of log volumes that can be kept after their associated pods have been deleted.  If this threshold is passed, log volumes are deleted starting with the oldest first.  If not specified or zero, log volumes are retained indefinitely.</p>
</div>
<div class="paragraph">
<p>It is recommended to specify this field when using ephemeral server classes so an unlimited number of persistent volumes cannot be created.  This ensures storage quotas are not exhausted or significant costs are incurred.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>logRetentionCount</code> field is optional and defaults to <code>0</code>.  The value must be any non-negative integer.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-servers"><a class="anchor" href="#spec-servers"></a>spec.servers[]</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object allows the configuration of the Couchbase cluster topology.
Servers are grouped in to server classes also known as multi-dimensional scaling (MDS) groups.
You must specify at least one server class.
At least one server class must contain the <code>data</code> service.</p>
</div>
<div class="paragraph">
<p>Modifying any field in the <code>spec.servers</code> object that affects the underlying pod will trigger an <a href="concept-upgrade.html#upgrading-pods" class="page">upgrade</a>, as pods are immutable.
Fields that do not trigger an upgrade include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>size</code>&#8201;&#8212;&#8201;attribute modification triggers a scaling operation.</p>
</li>
<li>
<p><code>name</code>&#8201;&#8212;&#8201;attribute modification replaces the entire server class with a new one.</p>
</li>
<li>
<p><code>services</code>&#8201;&#8212;&#8201;attribute is immutable.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  servers:
  - size: 1
    name: all_services
    services:
    - data
    - index
    - query
    - search
    - eventing
    - analytics
    serverGroups:
    - us-east-1a
    env:
    - name: ENV1
      value: value
    envFrom:
    - secretRef:
        name: environment-secret
    resources:
      limits:
        cpu: 4
        memory: 8Gi
      requests:
        cpu: 2
        memory: 8Gi
    volumeMounts:
      default: couchbase
      data:  couchbase
      index: couchbase
      analytics:
      - couchbase
      - couchbase
    pod:
      metadata:
        labels:
          couchbase_services: all
        annotations:
          couchbase.acme.com: production
      spec:
        nodeSelector:
          instanceType: large
        tolerations:
        - key: app
          operator: Equal
          value: cbapp
          effect: NoSchedule
        priorityClassName: high-priority
        automountServiceAccountToken: false
        serviceAccountName: couchbase-pods
        imagePullSecrets:
        - name: my-pull-secret
        dnsPolicy: None
        dnsConfig:
          nameservers:
          - "10.0.0.2"
          searches:
          - cluster.local</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-size"><a class="anchor" href="#spec-servers-size"></a>spec.servers[].size</h3>
<div class="paragraph">
<p>This field specifies the number of nodes of this type that should be in the cluster. This allows the user to scale up different parts of the cluster as necessary. If this parameter is changed at runtime, the Operator will <a href="howto-couchbase-scale.html" class="page">automatically scale the cluster</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>size</code> is required and can be set to greater than or equal to 1.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-name"><a class="anchor" href="#spec-servers-name"></a>spec.servers[].name</h3>
<div class="paragraph">
<p>This field specifies a name for this group of servers.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>name</code> field is required and must be unique in comparison to the <code>name</code> field of other server definitions. The value of this field should not be changed after a server class has been defined.  See <a href="#spec-servers"><code>spec.servers[]</code></a> for more details.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-services"><a class="anchor" href="#spec-servers-services"></a>spec.servers[].services</h3>
<div class="paragraph">
<p>This field specifies a list of services that should be run on nodes of this type. Users can specify <code>data</code>, <code>index</code>, <code>query</code>, <code>search</code>, <code>eventing</code> and <code>analytics</code> in the list. At least one service must be specified and all clusters must contain at least one node specification that includes the data service.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>services</code> list is required and must contain at least one service. Valid values for services are <code>data</code>, <code>index</code>, <code>query</code>, <code>search</code>, <code>eventing</code> and <code>analytics</code>. The values of this list cannot be changed after a server has been defined.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-servergroups"><a class="anchor" href="#spec-servers-servergroups"></a>spec.servers[].serverGroups</h3>
<div class="paragraph">
<p>This controls the set of server groups to schedule pods in.  Functionality is identical to that defined in the top level specification, but overrides it and allows the end user to specify exactly where pods of individual server/service configuration are scheduled.  See the <a href="#spec-servergroups">main documentation</a> for details.</p>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-env"><a class="anchor" href="#spec-servers-env"></a>spec.servers[].env</h3>
<div class="paragraph">
<p>This field specifies the environment variables (as key-values pairs) that should be set when the pod is started. This section is optional.
Specified environment variables will be available in Couchbase server containers only.
The env field is defined by the Kubernetes <a href="https://v1-17.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.17/#envvar-v1-core" target="_blank" rel="noopener"><code>EnvVar</code></a> type.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field must be a map of key-value pairs where both are strings.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-envfrom"><a class="anchor" href="#spec-servers-envfrom"></a>spec.servers[].envFrom</h3>
<div class="paragraph">
<p>This field specifies a reference to either a <code>Secret</code> or <code>ConfigMap</code> which is used to create environment variables when the pod is started.
Specified environment variables will be available in Couchbase server containers only.
The envFrom filed is defined by the Kubernetes <a href="https://v1-17.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.17/#envfromsource-v1-core" target="_blank" rel="noopener"><code>EnvFromSource</code></a> type.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field must be an array of Kubernetes <code>EnvFromSource</code> types.  This field is optional.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-resources"><a class="anchor" href="#spec-servers-resources"></a>spec.servers[].resources</h3>
<div class="paragraph">
<p>Pod resources are specified using a Kubernetes <a href="https://v1-17.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.17/#resourcerequirements-v1-core" target="_blank" rel="noopener"><code>ResourceRequirements</code></a> type:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  servers:
  - resources:
      limits:
        cpu: 2
        memory: 8Gi
      requests:
        cpu: 1.5
        memory: 8Gi</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">limits</dt>
<dd>
<p>This field lets you reserve resources on a specific node. It defines the maximum amount of CPU and memory the pods created in this node specification can allocate.  Exceeding these limits will cause the offending pod to be terminated.</p>
</dd>
<dt class="hdlist1">requests</dt>
<dd>
<p>This field lets you reserve resources on a specific node. The requests section defines the minimum amount of CPU and memory the pods created in this node specification will reserve.</p>
</dd>
</dl>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In general, CPU limits are specified as the number of threads required on physical hardware (vCPUs if in the cloud), and memory is specified in bytes.
Refer to the Kubernetes documentation for more information about <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/" target="_blank" rel="noopener">managing compute resources</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-servers-volumemounts"><a class="anchor" href="#spec-servers-volumemounts"></a>spec.servers[].volumeMounts</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  servers:
  - volumeMounts:
      default: couchbase
      data:  couchbase
      index: couchbase
      analytics:
        - couchbase
        - couchbase</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>VolumeMounts</code> configuration specifies the claims to use for the storage that is used by the Couchbase Server cluster.</p>
</div>
<div class="sect2">
<h3 id="spec-servers-volumemounts-default"><a class="anchor" href="#spec-servers-volumemounts-default"></a>spec.servers[].volumeMounts.default</h3>
<div class="paragraph">
<p>This field is required when using persistent volumes. The value specifies the name of the <code>volumeClaimTemplate</code> that is used to create a persisted volume for the <code>default</code> path. This is always <code>/opt/couchbase/var/lib/couchbase</code>. The claim must match the name of a <code>volumeClaimTemplate</code> within the spec.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>default</code> volume mount may be specified for production clusters or those that require support.  Please consult <a href="best-practices.html#storage" class="page">the best practices guide</a> for more information. It must be specified with server classes running any of the <code>data</code>, <code>index</code> or <code>analytics</code> services.  It may however, be used with any service.  It cannot be specified at the same time as the <code>logs</code> volume mount for a specific server configuration.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-volumemounts-data"><a class="anchor" href="#spec-servers-volumemounts-data"></a>spec.servers[].volumeMounts.data</h3>
<div class="paragraph">
<p>This field is the name of the <code>volumeClaimTemplate</code> that is used to create a persisted volume for the <code>data</code> path. When specified, the data path will be <code>/mnt/data</code>. The claim must match the name of a <code>volumeClaimTemplate</code> within the spec. If this field is not specified, then a volume will not be created and the data directory will be part of the "default" volume claim.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>data</code> volume mount can only be specified when the <code>default</code> volume claim is also specified.  The <code>spec.servers.services</code> field must also contain the <code>data</code> service.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-volumemounts-index"><a class="anchor" href="#spec-servers-volumemounts-index"></a>spec.servers[].volumeMounts.index</h3>
<div class="paragraph">
<p>This field is the name of the <code>volumeClaimTemplate</code> that is used to create a persisted volume for the <code>index</code> path. When specified, the index path will be <code>/mnt/index</code>. The claim must match the name of a <code>volumeClaimTemplate</code> within the spec. If this field is not specified, then a volume will not be created and the data directory will be part of the "default" volume claim.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>index</code> volume mount can only be specified when the <code>default</code> volume claim is also specified.  The <code>spec.servers.services</code> field must also contain the <code>index</code> service.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-volumemounts-analytics"><a class="anchor" href="#spec-servers-volumemounts-analytics"></a>spec.servers[].volumeMounts.analytics[]</h3>
<div class="paragraph">
<p>This field is the name of any <code>volumeClaimTemplate</code> that is used to create a persisted volume for the <code>analytics</code> paths. When specified, the analytics paths will be <code>/mnt/analytics-00</code> (where <code>00</code> denotes the first path), with all subsequent paths having incrementing values. The claim must match the name of a <code>volumeClaimTemplate</code> within the spec. If this field is not specified, then a volume will not be created and the data directory will be part of the "default" volume claim.</p>
</div>
<div class="paragraph">
<p><em>Field rules:</em> The <code>analytics</code> volume mount can only be specified when the <code>default</code> volume claim is also specified.  The <code>spec.servers.services</code> field must also contain the <code>analytics</code> service.</p>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-volumemounts-logs"><a class="anchor" href="#spec-servers-volumemounts-logs"></a>spec.servers[].volumeMounts.logs</h3>
<div class="paragraph">
<p>This field is the name of the <code>volumeClaimTemplate</code> that is used to create a persisted volume for the <code>logs</code> path.  When specified, the logs path will be <code>/opt/couchbase/var/lib/couchbase/logs</code>. The claim must match the name of a <code>volumeClaimTemplate</code> within the spec. If this field is not specified, then a volume will not be created.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>logs</code> volume mount may be specified for production clusters that require support. Please consult <a href="best-practices.html#storage" class="page">the best practices guide</a> for more information.  It may only be specified with server classes not running any of the <code>data</code>, <code>index</code> or <code>analytics</code> services.  It cannot be specified at the same time as the <code>default</code> volume mount a specific server configuration.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-servers-pod"><a class="anchor" href="#spec-servers-pod"></a>spec.servers[].pod</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>pod</code> attribute is based on the Kubernetes <a href="https://v1-17.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.17/#podtemplatespec-v1-core" target="_blank" rel="noopener"><code>PodTemplateSpec</code></a> structure and allows all supported configuration parameters to be modified.
The Operator will override the following fields, therefore must not be explicitly set by the user:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>spec.command</code></p>
</li>
<li>
<p><code>spec.args</code></p>
</li>
<li>
<p><code>spec.containers</code></p>
</li>
<li>
<p><code>spec.initContainers</code></p>
</li>
<li>
<p><code>spec.restartPolicy</code></p>
</li>
<li>
<p><code>spec.hostname</code></p>
</li>
<li>
<p><code>spec.subdomain</code></p>
</li>
<li>
<p><code>spec.securityContext</code> (see <a href="#spec-securitycontext"><code>spec.securityContext</code></a>)</p>
</li>
<li>
<p><code>spec.antiAffinity</code> (if <a href="#spec-antiaffinity"><code>spec.antiAffinity</code></a> is set to <code>true</code>)</p>
</li>
<li>
<p><code>spec.volumes</code> (if <a href="#spec-servers-volumemounts"><code>spec.servers[].volumeMounts</code></a> is set)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following parameters are modified by the Operator to merge configuration required to function, and caution should be used when setting these parameters as they may be overwritten:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>metadata.labels</code></p>
</li>
<li>
<p><code>metadata.annotations</code></p>
</li>
<li>
<p><code>spec.nodeSelector</code> (if <a href="#spec-servergroups"><code>spec.serverGroups</code></a> or <a href="#spec-servers-servergroups"><code>spec.servers[].serverGroups</code></a> is set)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  servers:
   - pod:
      metadata:
        labels:
          couchbase_services: all
        annotations:
          couchbase.acme.com: production
      spec:
        nodeSelector:
          instanceType: large
        tolerations:
        - key: app
          operator: Equal
          value: cbapp
          effect: NoSchedule
        priorityClassName: high-priority
        automountServiceAccountToken: false
        serviceAccountName: couchbase-pods
        imagePullSecrets:
        - name: my-pull-secret
        dnsPolicy: None
        dnsConfig:
          nameservers:
          - "10.0.0.2"
          searches:
          - cluster.local</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-metadata-labels"><a class="anchor" href="#spec-servers-pod-metadata-labels"></a>spec.servers[].pod.metadata.labels</h3>
<div class="paragraph">
<p>Labels are key-value pairs that are attached to objects in Kubernetes. They are intended to specify identifying attributes of objects that are meaningful to the user and do not directly imply semantics to the core system. Labels can be used to organize and select subsets of objects. They do not need to be unique across multiple objects. This section is optional.</p>
</div>
<div class="paragraph">
<p>Labels added in this section will apply to all Couchbase server containers created in this cluster.
Note that by default the Operator will add labels to each pod that may override those stated by this field.
User supplied annotations should not use the <code>couchbase.com</code> key namespace.</p>
</div>
<div class="paragraph">
<p>For more information, see the Kubernetes documentation about <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/" target="_blank" rel="noopener">labels</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field cannot be changed after a server has been defined.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-metadata-annotations"><a class="anchor" href="#spec-servers-pod-metadata-annotations"></a>spec.servers[].pod.metadata.annotations</h3>
<div class="paragraph">
<p>Annotations are similar to labels but cannot be used for resource selection.
User supplied annotations should not use the <code>couchbase.com</code> key namespace.</p>
</div>
<div class="paragraph">
<p>For more information, see the Kubernetes documentation about <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/annotations/" target="_blank" rel="noopener">annotations</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field must be a map of key value pairs.  This field is optional and immutable.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-nodeselector"><a class="anchor" href="#spec-servers-pod-spec-nodeselector"></a>spec.servers[].pod.spec.nodeSelector</h3>
<div class="paragraph">
<p>This field specifies a key-value map of the constraints on node placement for pods. For a pod to be eligible to run on a node, the node must have each of the indicated key-value pairs as labels (it can have additional labels as well). If this section is not specified, then Kubernetes will place the pod on any available node.</p>
</div>
<div class="paragraph">
<p>For more information on isolating your Couchbase clusters from other workloads, see the <a href="concept-scheduling.html" class="page">pod scheduling concepts document</a>.
For more information on node selectors, see the Kubernetes documentation about <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#label-selectors" target="_blank" rel="noopener">label selectors</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a Kubernetes node selector object.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-tolerations"><a class="anchor" href="#spec-servers-pod-spec-tolerations"></a>spec.servers[].pod.spec.tolerations</h3>
<div class="paragraph">
<p>This field specifies conditions&#8201;&#8212;&#8201;that usually prevent pod scheduling or execution&#8201;&#8212;&#8201;that should be tolerated when scheduling a pod.
From the sample configuration file referenced in this topic, any node with a taint <code>app=cbapp:NoSchedule</code> would not usually allow the scheduler to start running any new pods upon it.
You may wish to taint nodes&#8201;&#8212;&#8201;marking them as dedicated&#8201;&#8212;&#8201;for running Couchbase Server, where you don&#8217;t also want other application pods to be running on the same node and causing interference.
In order to allow Couchbase pods to be scheduled to run on a tainted node the pod must tolerate all taints.</p>
</div>
<div class="paragraph">
<p>For more information on isolating your Couchbase clusters from other workloads, see the <a href="concept-scheduling.html" class="page">pod scheduling concepts document</a>.
For more information about tolerations, see the Kubernetes documentation on <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/" target="_blank" rel="noopener">taints and tolerations</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a list of Kubernetes toleration objects.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-priorityclassname"><a class="anchor" href="#spec-servers-pod-spec-priorityclassname"></a>spec.servers[].pod.spec.priorityClassName</h3>
<div class="paragraph">
<p>This field allows Couchbase server pods to be run with an increased priority over other pods.
Increased priority can evict lower priority pods from a node in order to accommodate resource requirements where a pod cannot be scheduled on any node.</p>
</div>
<div class="paragraph">
<p>For more information, see the Kubernetes documentation on <a href="https://kubernetes.io/docs/concepts/configuration/pod-priority-preemption/" target="_blank" rel="noopener">priority classes and preemption</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be the name of an existing <code>PriorityClass</code> resource.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-imagepullsecrets"><a class="anchor" href="#spec-servers-pod-spec-imagepullsecrets"></a>spec.servers[].pod.spec.imagePullSecrets</h3>
<div class="paragraph">
<p>Pods created by the Operator need to have permission to access the container images they run.
Normally Kubernetes will use public images hosted on <a href="https://hub.docker.com" target="_blank" rel="noopener">Docker hub</a> that do not require authentication and authorization.
When using private repositories&#8201;&#8212;&#8201;especially on Red Hat OpenShift&#8201;&#8212;&#8201;you will need to specify credentials to allow container image access.</p>
</div>
<div class="paragraph">
<p>This can be achieved in a number of different ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Associating an image pull secret with the <code>default</code> service account.
This may be a security risk as it will automatically apply to any containers created in the namespace.</p>
</li>
<li>
<p>Using the <a href="#spec-servers-pod-spec-imagepullsecrets"><code>spec.servers[].pod.spec.imagePullSecrets</code></a> attribute to explicitly specify secrets that are used for credentials.</p>
</li>
<li>
<p>Using the <a href="#spec-servers-pod-spec-serviceaccountname"><code>spec.servers[].pod.spec.serviceAccountName</code></a> attribute to run the pods as a specified service account.
This service account may implicitly be associated with secrets that are used for credentials.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For additional information, see the <a href="https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/" target="_blank" rel="noopener">Kubernetes documentation</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The value of this field is optional and must be a Kubernetes image pull secrets list.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-automountserviceaccounttoken"><a class="anchor" href="#spec-servers-pod-spec-automountserviceaccounttoken"></a>spec.servers[].pod.spec.automountServiceAccountToken</h3>
<div class="paragraph">
<p>By default Kubernetes will mount a secret into all containers in a pod.
This allows Kubernetes to provide a token that authenticates against the Kubernetes API from within a running container.
This behavior may be disabled&#8201;&#8212;&#8201;for security reasons&#8201;&#8212;&#8201;by changing this field to <code>false</code>.
If not specified this field will default to <code>true</code>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules</em>: The <code>automountServiceAccountToken</code> field is optional and must be a boolean.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-serviceaccountname"><a class="anchor" href="#spec-servers-pod-spec-serviceaccountname"></a>spec.servers[].pod.spec.serviceAccountName</h3>
<div class="paragraph">
<p>Pods created by the Operator need to have permission to access the container images they run.
Normally Kubernetes will use public images hosted on <a href="https://hub.docker.com" target="_blank" rel="noopener">Docker hub</a> that do not require authentication and authorization.
When using private repositories&#8201;&#8212;&#8201;especially on Red Hat OpenShift&#8201;&#8212;&#8201;you will need to specify credentials to allow container image access.</p>
</div>
<div class="paragraph">
<p>This can be achieved in a number of different ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Associating an image pull secret with the <code>default</code> service account.
This may be a security risk as it will automatically apply to any containers created in the namespace.</p>
</li>
<li>
<p>Using the <a href="#spec-servers-pod-spec-imagepullsecrets"><code>spec.servers[].pod.spec.imagePullSecrets</code></a> attribute to explicitly specify secrets that are used for credentials.</p>
</li>
<li>
<p>Using the <a href="#spec-servers-pod-spec-serviceaccountname"><code>spec.servers[].pod.spec.serviceAccountName</code></a> attribute to run the pods as a specified service account.
This service account may implicitly be associated with secrets that are used for credentials.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For additional information, see the <a href="https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/" target="_blank" rel="noopener">Kubernetes documentation</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules</em>: The <code>serviceAccountName</code> field is optional and must be string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-dnspolicy"><a class="anchor" href="#spec-servers-pod-spec-dnspolicy"></a>spec.servers[].pod.spec.dnsPolicy</h3>
<div class="paragraph">
<p>This field defines how Kubernetes populates Couchbase Server pods' DNS resolver.
By default, when not specified, this will use the builtin cluster DNS server.
This field allows the operator to inhibit the population of DNS configuration by Kubernetes.
Valid values are <code>None</code>.</p>
</div>
<div class="paragraph">
<p>For additional information on using custom DNS servers, see the <a href="concept-couchbase-networking.html#inter-kubernetes-networking-with-forwarded-dns" class="page">Couchbase networking concepts</a> documentation.
For additional information see <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-policy" target="_blank" rel="noopener">the Kubernetes documentation</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>dnsPolicy</code> field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-servers-pod-spec-dnsconfig"><a class="anchor" href="#spec-servers-pod-spec-dnsconfig"></a>spec.servers[].pod.spec.dnsConfig</h3>
<div class="paragraph">
<p>This object defines DNS configuration in addition to that defined by Kubernetes under the control of the DNS policy.
The <code>nameservers</code> sub-attribute is a list of DNS nameserver IP addresses.
The <code>searches</code> sub-attribute is a list of DNS search domains.</p>
</div>
<div class="paragraph">
<p>For additional information on using custom DNS servers, see the <a href="concept-couchbase-networking.html#inter-kubernetes-networking-with-forwarded-dns" class="page">Couchbase networking concepts</a> documentation.
For additional information see <a href="https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/#pod-s-dns-config" target="_blank" rel="noopener">the Kubernetes documentation</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> The <code>dnsConfig</code> field is optional and must be a valid Kubernetes DNS configuration object.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-buckets"><a class="anchor" href="#spec-buckets"></a>spec.buckets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object defines whether to manage buckets and how to select which bucket resources to use.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  buckets:
    managed: true
    selector:
      matchLabels:
        cluster: cb-example</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-buckets-managed"><a class="anchor" href="#spec-buckets-managed"></a>spec.buckets.managed</h3>
<div class="paragraph">
<p>This field specifies whether the Operator should manage Couchbase buckets.
This field defaults to <code>false</code> allowing the user to manually manage bucket settings with the <a href="howto-ui.html" class="page">Couchbase web console</a> or the Couchbase API.
If set to <code>true</code>, the Operator will search for <a href="reference-couchbasebucket.html" class="page"><code>CouchbaseBucket</code></a>, <a href="reference-couchbaseephemeralbucket.html" class="page"><code>CouchbaseEphemeralBucket</code></a> and <a href="reference-couchbasememcachedbucket.html" class="page"><code>CouchbaseMemcachedBucket</code></a> resources in the namespace under the control of the <a href="#spec-buckets-selector"><code>spec.buckets.selector</code></a> field.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-buckets-selector"><a class="anchor" href="#spec-buckets-selector"></a>spec.buckets.selector</h3>
<div class="paragraph">
<p>This field specifies which <a href="reference-couchbasebucket.html" class="page"><code>CouchbaseBucket</code></a>, <a href="reference-couchbaseephemeralbucket.html" class="page"><code>CouchbaseEphemeralBucket</code></a> and <a href="reference-couchbasememcachedbucket.html" class="page"><code>CouchbaseMemcachedBucket</code></a> resources are considered when the <a href="#spec-buckets-managed"><code>spec.buckets.managed</code></a> field is set to <code>true</code>.
If not specified all <a href="reference-couchbasebucket.html" class="page"><code>CouchbaseBucket</code></a>, <a href="reference-couchbaseephemeralbucket.html" class="page"><code>CouchbaseEphemeralBucket</code></a> and <a href="reference-couchbasememcachedbucket.html" class="page"><code>CouchbaseMemcachedBucket</code></a> resources are selected.
If specified, then only <a href="reference-couchbasebucket.html" class="page"><code>CouchbaseBucket</code></a>, <a href="reference-couchbaseephemeralbucket.html" class="page"><code>CouchbaseEphemeralBucket</code></a> and <a href="reference-couchbasememcachedbucket.html" class="page"><code>CouchbaseMemcachedBucket</code></a> resources containing the same labels as specified in the label selector are selected.</p>
</div>
<div class="paragraph">
<p>For additional information, see the <a href="concept-label-selection.html" class="page">Couchbase resource label selection</a> documentation.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules</em>: This field is optional and must be a Kubernetes <code>LabelSelector</code> object.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-xdcr"><a class="anchor" href="#spec-xdcr"></a>spec.xdcr</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object defines whether to manage XDCR, any remote clusters and replications to them.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As the Couchbase Server API does not expose XDCR passwords or TLS certificates these cannot be automatically rotated by the Operator.
In order to rotate these either manually update or delete and recreate the remote cluster.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  xdcr:
    managed: true
    remoteClusters:
    - name: remote
      uuid: 611e50b21e333a56e3d6d3570309d7e3
      hostname: 10.1.0.2:31851
      authenticationSecret: my-xdcr-secret
      tls:
        secret: my-xdcr-tls-secret
      replications:
        selector:
          matchLabels:
            cluster: cb-example</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-managed"><a class="anchor" href="#spec-xdcr-managed"></a>spec.xdcr.managed</h3>
<div class="paragraph">
<p>This field defines whether the Operator should manage XDCR remote clusters and replications.</p>
</div>
<div class="paragraph">
<p>If set to <code>true</code> the Operator will assume full control of all XDCR primitives.
Any existing XDCR remote clusters and replications will be deleted by the Operator unless matching configuration is provided.
This field defaults to <code>false</code> if not set.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters"><a class="anchor" href="#spec-xdcr-remoteclusters"></a>spec.xdcr.remoteClusters[]</h3>
<div class="paragraph">
<p>This list contains references to any remote clusters to replicate to.</p>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters-name"><a class="anchor" href="#spec-xdcr-remoteclusters-name"></a>spec.xdcr.remoteClusters[].name</h3>
<div class="paragraph">
<p>This field specifies a textual name for the remote cluster.
The name must be unique within the Couchbase cluster.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters-uuid"><a class="anchor" href="#spec-xdcr-remoteclusters-uuid"></a>spec.xdcr.remoteClusters[].uuid</h3>
<div class="paragraph">
<p>This field specifies the remote cluster UUID.</p>
</div>
<div class="paragraph">
<p>Every Couchbase cluster generates a unique cluster ID.
The UUID of a remote cluster managed by the Operator is available in the <code>CouchbaseCluster</code> resource in the <code>status.clusterId</code> field.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must be a Couchbase UUID string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters-hostname"><a class="anchor" href="#spec-xdcr-remoteclusters-hostname"></a>spec.xdcr.remoteClusters[].hostname</h3>
<div class="paragraph">
<p>This field specifies the hostname and port of the remote cluster.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is required and must be a valid DNS domain name and admin port (either plain text or TLS).</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters-authenticationsecret"><a class="anchor" href="#spec-xdcr-remoteclusters-authenticationsecret"></a>spec.xdcr.remoteClusters[].authenticationSecret</h3>
<div class="paragraph">
<p>This field specifies basic authentication on the remote cluster.</p>
</div>
<div class="paragraph">
<p>This field is only relevant if not using client certificate authentication.
If specified the authentication secret must refer to a Kubernetes secret containing the keys <code>username</code> and <code>password</code>.
The user on the remote cluster must have have the correct roles to allow XDCR to write to the target bucket(s).</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters-tls-secret"><a class="anchor" href="#spec-xdcr-remoteclusters-tls-secret"></a>spec.xdcr.remoteClusters[].tls.secret</h3>
<div class="paragraph">
<p>This field defines any TLS configuration required to establish a connection with the remote cluster.</p>
</div>
<div class="paragraph">
<p>This field references a Kubernetes secret containing remote cluster TLS information.
If replications to the remote cluster are to be encrypted then at least the CA certificate must be provided.
The CA certificate is specified by the key <code>ca</code>.</p>
</div>
<div class="paragraph">
<p>If the remote cluster requires client certificate authentication then the <code>certificate</code> and <code>key</code> keys are used to specify the client certificate chain and client certificate&#8217;s private key respectively.
Client certificate authentication cannot be used with basic authentication.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a string.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters-replications"><a class="anchor" href="#spec-xdcr-remoteclusters-replications"></a>spec.xdcr.remoteClusters[].replications[]</h3>
<div class="paragraph">
<p>This field is a list of replications from the local cluster to the remote cluster.</p>
</div>
</div>
<div class="sect2">
<h3 id="spec-xdcr-remoteclusters-replications-selector"><a class="anchor" href="#spec-xdcr-remoteclusters-replications-selector"></a>spec.xdcr.remoteClusters[].replications[].selector</h3>
<div class="paragraph">
<p>This field defines a label selector to choose which <a href="reference-couchbasereplication.html" class="page"><code>CouchbaseReplication</code></a> resources should be included for this remote cluster.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a Kubernetes <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/" target="_blank" rel="noopener">label selector</a>.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-backup"><a class="anchor" href="#spec-backup"></a>spec.backup</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object defines parameters and variables for automated backup.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  backup:
    managed: true
    image: couchbase/operator-backup:6.5.1-104
    serviceAccountName: couchbase-backup
    resources:
      requests:
        cpu: 100m
        memory: 100Mi
    selector:
      matchLabels:
        cluster: cb-example
    nodeSelector:
      class: couchbase-backup
    tolerations:
    - key: couchbase-backup
      operator: Exists
      effect: NoSchedule</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-backup-managed"><a class="anchor" href="#spec-backup-managed"></a>spec.backup.managed</h3>
<div class="paragraph">
<p>This field defines whether the Automated Backup feature is enabled for the cluster.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean value.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-backup-image"><a class="anchor" href="#spec-backup-image"></a>spec.backup.image</h3>
<div class="paragraph">
<p>This field defines the path to the backup utility image that the Autonomous Operator will run to perform a backup or restore.</p>
</div>
<div class="paragraph">
<p>If left unspecified, the dynamic admission controller will automatically populate it with the most recent container image that was available when the installed version of the Autonomous Operator was released.
The default image for open source Kubernetes comes from <a href="https://hub.docker.com/r/couchbase/operator-backup" target="_blank" rel="noopener">Docker Hub</a>, and the default image for OpenShift comes from the <a href="https://access.redhat.com/containers/#/vendor/couchbase" target="_blank" rel="noopener">Red Hat Container Catalog</a>.</p>
</div>
<div class="paragraph">
<p>If pulling directly from the the Red Hat Container Catalog, then the path will be something similar to <code>registry.connect.redhat.com/couchbase/operator-backup:6.5.1-104-1</code> (you can refer to the catalog for the most recent images).
If ImagePullSecrets are required to access the image, they are inherited from the Couchbase Server Pod and can be set explicitly with the <a href="#spec-servers-pod-spec-imagepullsecrets"><code>spec.servers[].pod.spec.imagePullSecrets</code></a> field or implicitly with a service account specified with the <a href="#spec-servers-pod-spec-serviceaccountname"><code>spec.servers[].pod.spec.serviceAccountName</code></a> field.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a valid path to a valid container image.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-backup-serviceaccountname"><a class="anchor" href="#spec-backup-serviceaccountname"></a>spec.backup.serviceAccountName</h3>
<div class="paragraph">
<p>This field specifies the name of a Kubernetes <code>ServiceAccount</code> that gives the backup and restore Pods the necessary permissions to read and create the required backup objects (running pods, jobs, CronJobs, events, etc).</p>
</div>
<div class="paragraph">
<p>If left unspecified, the dynamic admission controller will automatically default to the value of <code>couchbase-backup</code>.
(This is the default name given to the <code>ServiceAccount</code> when you run <code>cbopcfg</code> as part of the automated backup <a href="howto-backup.html" class="page">setup procedure</a>.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be the name of a valid Kubernetes Service Account.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-backup-resources"><a class="anchor" href="#spec-backup-resources"></a>spec.backup.resources</h3>
<div class="paragraph">
<p>This field defines resource requests and limits for the backup pods that performs backup operations.
Some environments may require these fields to be explicitly set when using Kubernetes <code>LimitRange</code> resources without namespace defaults.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a valid Kubernetes <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/" target="_blank" rel="noopener">resource descriptor</a>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-backup-selector"><a class="anchor" href="#spec-backup-selector"></a>spec.backup.selector</h3>
<div class="paragraph">
<p>This field defines a label selector to choose which <a href="reference-couchbasebackup.html" class="page"><code>CouchbaseBackup</code></a> and <a href="reference-couchbasebackuprestore.html" class="page"><code>CouchbaseBackupRestore</code></a> resources should be included for this cluster.</p>
</div>
<div class="paragraph">
<p>This field specifies which <code>CouchbaseBackup</code> and <code>CouchbaseBackupRestore</code> resources are considered when the <a href="#spec-backup-managed"><code>spec.backup.managed</code></a> field is set to <code>true</code>.
If not specified all <code>CouchbaseBackup</code> and <code>CouchbaseBackupRestore</code> resources are selected.
If specified, then only <code>CouchbaseBackup</code> and <code>CouchbaseBackupRestore</code> resources containing the same labels as specified in the label selector are selected.</p>
</div>
<div class="paragraph">
<p>For additional information, see the <a href="concept-label-selection.html" class="page">Couchbase resource label selection</a> documentation.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a Kubernetes <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/" target="_blank" rel="noopener">label selector</a>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-backup-nodeselector"><a class="anchor" href="#spec-backup-nodeselector"></a>spec.backup.nodeSelector</h3>
<div class="paragraph">
<p>This field defines affinity rules for the scheduling of <a href="reference-couchbasebackup.html" class="page"><code>CouchbaseBackup</code></a> and <a href="reference-couchbasebackuprestore.html" class="page"><code>CouchbaseBackupRestore</code></a> resources.</p>
</div>
<div class="paragraph">
<p>This field is formatted as per the <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector" target="_blank" rel="noopener">Kubernetes node selectors</a> documentation.
A node selector is a set of key/value pairs that a Kubernetes <code>Node</code> must be labeled with in order for backup and restore jobs to be scheduled onto.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector" target="_blank" rel="noopener">Kubernetes node selector</a>.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-backup-tolerations"><a class="anchor" href="#spec-backup-tolerations"></a>spec.backup.tolerations</h3>
<div class="paragraph">
<p>This field defines toleration of anti-affinity for the scheduling of <a href="reference-couchbasebackup.html" class="page"><code>CouchbaseBackup</code></a> and <a href="reference-couchbasebackuprestore.html" class="page"><code>CouchbaseBackupRestore</code></a> resources.</p>
</div>
<div class="paragraph">
<p>This field is formatted as per the <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/" target="_blank" rel="noopener">Kubernetes taints and tolerations</a> documentation.
Taints provide anti-affinity rules, forcing all pods to be unschedulable on nodes with that taint.
Tolerations allow backup and restore jobs to tolerate taints and be scheduled on these nodes that are now guaranteed to not have other pods running there.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a list of <a href="https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/" target="_blank" rel="noopener">Kubernetes tolerations</a>.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-monitoring"><a class="anchor" href="#spec-monitoring"></a>spec.monitoring</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This object defines any integrations with third party monitoring software.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  monitoring:
    prometheus:
      enabled: true
      image: couchbase/exporter:1.0.2
      authorizationSecret: cb-metrics-token
      resources:
        requests:
          cpu: 100m
          memory: 100Mi</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-monitoring-prometheus-enabled"><a class="anchor" href="#spec-monitoring-prometheus-enabled"></a>spec.monitoring.prometheus.enabled</h3>
<div class="paragraph">
<p>This field defines whether Prometheus metric collection is enabled for the cluster.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a boolean value.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-monitoring-prometheus-image"><a class="anchor" href="#spec-monitoring-prometheus-image"></a>spec.monitoring.prometheus.image</h3>
<div class="paragraph">
<p>This field defines the path to the Prometheus Exporter image that the Autonomous Operator will inject as a "sidecar" container in each Couchbase Server pod.</p>
</div>
<div class="paragraph">
<p>If left unspecified, the dynamic admission controller will automatically default to the most recent container image from Docker Hub (open source Kubernetes) or Red Hat Container Catalog (OpenShift) that was available when the installed version of the Autonomous Operator was released.
Refer to <a href="howto-prometheus.html" class="page">Configure Prometheus Metrics Collection</a> for more detailed instructions.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a valid path to a valid container image.</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-monitoring-prometheus-authorizationsecret"><a class="anchor" href="#spec-monitoring-prometheus-authorizationsecret"></a>spec.monitoring.prometheus.authorizationSecret</h3>
<div class="paragraph">
<p>This field specifies the name of a Kubernetes Secret that should contain a bearer token value that clients use to gain access to the Prometheus metrics.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be the name of a valid Kubernetes secret, with a key of "token".</p>
</div>
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="spec-monitoring-prometheus-resources"><a class="anchor" href="#spec-monitoring-prometheus-resources"></a>spec.monitoring.prometheus.resources</h3>
<div class="paragraph">
<p>This field defines resource requests and limits for the Prometheus Exporter "sidecar" container.
Some environments may require these fields to be explicitly set when using Kubernetes <code>LimitRange</code> resources without namespace defaults.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p><em>Field rules:</em> This field is optional and must be a valid Kubernetes <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/" target="_blank" rel="noopener">resource descriptor</a>.</p>
</div>
</blockquote>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spec-volumeclaimtemplates"><a class="anchor" href="#spec-volumeclaimtemplates"></a>spec.volumeClaimTemplates[]</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This list defines templates of persistent volume claims.
At runtime, the Operator will create a persistent volume from these templates for each pod referencing them.
Claims can request volumes from various types of storage systems as identified by the storage class name.
Volume claim templates are based on the <a href="https://v1-17.docs.kubernetes.io/docs/reference/generated/kubernetes-api/v1.17/#persistentvolumeclaim-v1-core" target="_blank" rel="noopener"><code>PersistentVolumeClaim</code></a> Kubernetes type.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">spec:
  volumeClaimTemplates:
    - metadata:
        name: couchbase
      spec:
        storageClassName: "standard"
        resources:
          requests:
            storage: 1Gi</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="spec-volumeclaimtemplates-metadata-name"><a class="anchor" href="#spec-volumeclaimtemplates-metadata-name"></a>spec.volumeClaimTemplates[].metadata.name</h3>
<div class="paragraph">
<p>The metadata name identifies the claim template. This name is used by the <code>volumeMounts</code> to reference which template to fulfill the mount request.</p>
</div>
</div>
<div class="sect2">
<h3 id="spec-volumeclaimtemplates-spec-storageclassname"><a class="anchor" href="#spec-volumeclaimtemplates-spec-storageclassname"></a>spec.volumeClaimTemplates[].spec.storageClassName</h3>
<div class="paragraph">
<p>The <code>storageClassName</code> is optional for a claim. A <code>storageClassName</code> provides a way for administrators to describe the classes of storage they offer. If no <code>storageClassName</code> is specified, then the default storage class is used.</p>
</div>
<div class="paragraph">
<p>Refer to the Kubernetes documentation for more information about <a href="https://kubernetes.io/docs/concepts/storage/storage-classes/" target="_blank" rel="noopener">storage classes</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="spec-volumeclaimtemplates-spec-resources"><a class="anchor" href="#spec-volumeclaimtemplates-spec-resources"></a>spec.volumeClaimTemplates[].spec.resources</h3>
<div class="paragraph">
<p>The minimum resources the volume should have. Only the storage requests are valid in this context.</p>
</div>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../_/img/couchbase-logo.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2022 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<template id="run-code-panel">
<div class="action-panel">
  <form class="action-panel-control" method="POST" action="https://couchbase.live/run" target="run-code-output">
    <input type="hidden" name="lang">
    <input type="hidden" name="code">
    <input type="hidden" name="from" value="docs">
    <div class="controls">
      <button class="control-button rerun" type="submit"><i class="fas fa-redo"></i></button>
      <span class="shell-name control-label">Output</span>
      <button class="control-button close"><i class="fas fa-times"></i> Close</button>
    </div>
  </form>
  <iframe class="run-code-output" name="run-code-output"></iframe>
</div>
</template>
<script id="site-script" src="../../_/js/site.js"></script>
<script defer src="../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script defer src="../../_/js/vendor/fontawesome.js" data-search-pseudo-elements="true"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
</body>
</html>
