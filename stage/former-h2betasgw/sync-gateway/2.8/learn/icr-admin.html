<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Replication Administration | Couchbase Docs</title>
<link rel="canonical" href="https://ibsoln.github.io/stage/h2betasgw2-slim/sync-gateway/2.8/learn/icr-admin.html">
<link rel="stylesheet" href="../../../_/css/site.css">
<script src="../../../_/js/vendor/jquery.js"></script>
<meta name="description" content="Inter-cluster replication (Sync Gateway to Sync Gateway) administration using SG-Replicate protocol">
<link rel="schema.dcterms" href="https://purl.org/dc/terms/">
<meta name="dcterms.subject" content="sync-gateway">
<meta name="dcterms.identifier" content="2.8">
<meta name="generator" content="Antora 2.3.3">
<link rel="icon" href="../../../_/img/favicon.ico" type="image/x-icon">
</head>
<body class="article">
<header class="header fixed-top">
  <div class="header-top-row">
      <div class="container">
          <nav class="navbar navbar-expand-md flex-nowrap justify-content-between navbar-new-top">

              <a class="navbar-brand" href="../../..">
                <img src="../../../_/img/couchbase-documentation-logo.svg" alt="Couchbase" />
              </a>
              <button class="navbar-burger" data-target="topbar-menu">
                <span></span>
                <span></span>
                <span></span>
              </button>

          </nav>
      </div>
  </div>
  <div class="header-bottom-row" id="topbar-menu">
    <div class="container">
        <nav  class="navbar navbar-new-bottom">

              <div class="navbar-collapse collapse" id="navbar2">
                <ul class="navbar-nav w-100 justify-content-start">
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      Server
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      Mobile
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      Cloud
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      SDKs
                    </a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="#">
                      Tutorials
                      <span class="arrow">
                        <i class="fas fa-arrow-right"></i>
                      </span>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="primary-action">
                <form class="navbar-item search">
                  <input type="text" placeholder="Search Docs" class="query" id="search-query" />
                  <button type="button" class="search-btn">
                    <i class="fas fa-search"></i>
                  </button>
                </form>
                <div class="parent-site">
                  <a href="https://www.couchbase.com">
                    Couchbase.com
                  </a>
                </div>
                <a class="btn btn-primary try-btn" href="https://www.couchbase.com/downloads">
                  Try Free
                </a>
              </div>

        </nav>
    </div>
   </div>
</header>
<div class="body container">
<nav class="nav">
<div class="left-sidebar-menu">
<div class="version-control-box">
<div class="component-frame">
<div class="frame-icon">
<img src="../../../_/img/server-icon.png" alt="">
</div>
<div class="frame-body">
<h4 class="title"><span class="">Sync Gateway  H2-BETA 15July20-0800</span></h4>
<a class="navbar-item component" href="icr-overview.html"> <span class="version">2.8</span></a>
</div>
</div>
</div>
<div class="nav-menu">
<ul class="nav-list">
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Learn</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="icr-overview.html">Inter-Cluster Replication</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="icr-conflict-resolution.html">Conflict Resolution</a>
</span>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Refer</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../refer/config-properties.html">Configuration Schema</a>
</span>
</li>
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<span class="in-toggle" data-depth="1"></span>
<span class="nav-text ">Sync Gateway API</span>
</span>
<ul class="nav-list">
<li class="nav-item " data-depth="2">

<span class="nav-line "  data-depth="2">
<a class="nav-link" href="../refer/rest-api-admin.html">Admin REST API</a>
</span>
</li>
</ul>
</li>
</ul>
</li>
<li class="nav-item " data-depth="0">

<span class="nav-line "  data-depth="0">
<span class="in-toggle" data-depth="0"></span>
<span class="nav-text ">Product Notes</span>
</span>
<ul class="nav-list">
<li class="nav-item  is-inactive " data-depth="1">

<span class="nav-line "  data-depth="1">
<a class="nav-link" href="../prodnotes/pn-change-log-config.html">Configuration Change Log</a>
</span>
</li>
</ul>
</li>
</ul>
</div>
<a href="#" class="menu-expand-toggle"> <span>Navigation</span> <i class="fas fa-times-circle"></i> <i class="fas fa-chevron-circle-left"></i></a>
</div></nav>
<aside class="toc sidebar">
  <div class="sidebar-box">
      <div class="tools" role="navigation">
<ul>
<li class="tool edit"><a href="file:///Users/ianbridge/CouchbaseDocs/bau/sgw/modules/ROOT/pages/learn/icr-admin.adoc" title="Edit Page" target="_blank" rel="noopener">Edit on GitHub</a></li>
</ul>
</div>
      <div class="toc-menu"></div>
        <div class="is-this-helpful-box">
          <h4> Is this page helpful?</h4>
            <div class="btn-row">
              <a href="#" class="like-btn helpful-btn" id="yesBtn" data-page-rating="like" >
                     <i class="far fa-thumbs-up"></i>
                 Yes

                 </a>
              <a href="#" class="dislike-btn helpful-btn" id="noBtn"  data-page-rating="dislike"> <i class="far fa-thumbs-down"></i> No</a>
            </div>
            <div class="any-feedback">
              <a href="#" class="btn any-feedback-btn" id="myCustomTrigger">Leave Additional Feedback? </a>
            </div>
            <div class="dialog-box" id="dialogBox">
              <form>
                  <div class="form-group " id="additionalFeedbackBox">
                    <textarea class="input-control feed-back-msg" rows="8" placeholder="Any Additonal Feedback?"></textarea>

                    <div class="action-btn-row ">
                      <a href="#" class="skip-btn" id="skipBtnMsg">Skip</a>
                       <button class="submit-btn btn blue-btn disabled" > Submit  </button>
                       <a href="#" class="info-btn"><i class="fas fa-info-circle"></i></a>
                    </div>


                  </div>

              </form>

            </div>
      </div>
   </div>

</aside>

<div class="feedback-modal modal-popup">
  <div class="modal-popup-dialogue">
    <div class="popup-header">
      <a href="#" class="close-popup"><i class="fa fa-times"></i></a>
    </div>
    <div class="popup-content">
      <p>
        Please use the form below to provide your feedback. Because your feedback is valuable to us,
         the information you submit in this form is recorded in our issue tracking system (JIRA), which is publicly available.
        You can track the status of your feedback using the ticket number displayed in the dialog once you submit the form.
      </p>
    </div>
  </div>
</div>

<main class="article" data-ceiling="topbar">
<div class="article-header">
<button class="nav-control"></button>
<nav class="crumbs" aria-label="breadcrumbs">
<ul>
<li class="crumb"><a href="icr-overview.html">Sync Gateway  H2-BETA 15July20-0800</a></li>
<li class="crumb"><a href="icr-admin.html">Replication Administration</a></li>
</ul>
</nav>
</div>
<article class="doc">
<div class="page-heading-title">
<h1 class="page">Replication Administration</h1>
<div class="labels">
<ul>
<li class="edition"><a href="https://www.couchbase.com/products/editions">Under Development</a></li>
<li class="status"><span>beta -- H2-SGW as at 10Jul20</span></li>
</ul>
</div>
</div>
<div class="contributor-list-box">
<span class="last-commit-date" id="commitdate">    </span>
<ul id="contributorList"></ul>
<span  id="otherContributor"> + </span>
</div><div id="preamble">
<div class="sectionbody">
<div class="quoteblock abstract">
<blockquote>
<div class="paragraph">
<p>Inter-cluster replication (Sync Gateway to Sync Gateway) administration using SG-Replicate protocol</p>
</div>
<div class="paragraph">
<p>This content covers the administration aspects of inter-cluster  replication</p>
</div>
<div class="paragraph">
<p><em>Related</em>&#8201;&#8212;&#8201;<a href="../refer/config-properties.html" class="page">Configuration Schema</a> | <a href="../refer/rest-api-admin.html" class="page">Admin REST API</a></p>
</div>
<div class="paragraph">
<p><em>Topic Group</em>&#8201;&#8212;&#8201;Inter-cluster Replication</p>
</div>
</blockquote>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="openblock pane__frame--orange">
<div class="title">Author&#8217;s Notes</div>
<div class="content">
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
CONTENT UNDER DEVELOPMENT
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>The Admin REST API provides a number of endpoints to assist in the monitoring, administration and management of replications.</p>
</div>
<div class="paragraph">
<p>You can use these to conduct Sync Gateway cluster administration, whether manually or by using automation (for example, scripts or a container orchestration system such as  Kubernetes).</p>
</div>
<div class="paragraph">
<p>Manual operation will typically take place where a cluster is malfunctioning and needs troubleshooting, or in demonstration and development environments.
For instance, in the process of debugging why a replication is slow, there would be a need to temporarily stop a replication and subsequently restart when the issue is resolved.  Another case would be if the parameters of the replication need to change.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest-api-admin-capabilities"><a class="anchor" href="#rest-api-admin-capabilities"></a>REST API Admin capabilities:</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the <code>_replication</code> endpoint to administrate replications  (<code>PUT</code>, <code>GET</code>, <code>DELETE</code>).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">List persistent and ad hoc replications</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>The list includes replications initiated using configuration or REST APi and can be in any state.</p>
</div>
<div class="exampleblock">
<div class="title">Example 1. Listing persistent and ad hoc replications</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Stop an active persistent or ad hoc replication</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>For example to offline an edge cluster without waiting for a long replication to complete. The convenience API means only the <code>replication_id</code> parameter is required.</p>
</div>
<div class="exampleblock">
<div class="title">Example 2. Stopping replications</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Reset a persistent replication</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>This is useful to escape a system state where one or more documents have failed to sync but where resuming from previous synced checkpoint would skip over those documents.</p>
</div>
<div class="exampleblock">
<div class="title">Example 3. Resetting replications</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Update a persistent continuous replication</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="exampleblock">
<div class="title">Example 4. Updating replications</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</dd>
<dt class="hdlist1">Remove a persistent or ad hoc replication</dt>
<dd>
<div class="openblock">
<div class="content">
<div class="paragraph">
<p>Behavior is unchanged, with exception of a convenience API that required only the <code>replication_id</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 5. Removing replications</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json"></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>See: <a href="../refer/rest-api-admin.html" class="page">Admin REST API</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cancel-a-replication"><a class="anchor" href="#cancel-a-replication"></a>Cancel a replication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>An active replication task is canceled by sending a POST request to the server endpoint <code>_replication</code>, with a JSON object.
The JSON object must contain the <code>"cancel": true</code> parameter and a valid <code>replication_id</code>.</p>
</div>
<div class="exampleblock">
<div class="title">Example 6. Canceling a replication</div>
<div class="content">
<div class="tabset is-loading">
<div class="ulist tabs">
<ul>
<li>
<p><a id="tabset1_using-replication_id"></a>Using replication_id</p>
</li>
<li>
<p><a id="tabset1_without-replication_id"></a>Without replication_id</p>
</li>
</ul>
</div>
<div class="content">
<div class="tab-pane" aria-labelledby="tabset1_using-replication_id">
<div class="paragraph">
<p>This example will cancel an active replication with a <code>replication_id</code> of "my-one-shot-replication", the <code>replication_id</code> value can be obtained by sending a request to <code>_active_tasks</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
    "cancel": true,
    "replication_id": "my-one-shot-replication"
}</code></pre>
</div>
</div>
</div>
<div class="tab-pane" aria-labelledby="tabset1_without-replication_id">
<div class="paragraph">
<p>This will cancel a replication that was started with same "source" and "target" values as those in the cancel request.
By omitting the "continuous" property it&#8217;s value will default to <strong>false</strong>, a replication must also have been started as a one-shot to match.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
    "cancel":true,
    "source": "db",
    "target": "db-copy"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>When an active task is canceled, the response returns the stats of the replication up to the point when it was stopped.</p>
</div>
<div class="exampleblock">
<div class="title">Example 7. Sample Stats Response</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-javascript hljs" data-lang="javascript">{
    "type":"replication",
    "replication_id":"3791d562153505408e0b2730603ed7c1",
    "continuous":true,
    "source":"http://0.0.0.0:4985/source",
    "target":"http://0.0.0.0:4985/target",
    "docs_read":12,
    "docs_written":12,
    "doc_write_failures":0,
    "start_last_seq":0,
    "end_last_seq":"28"
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 pane__frames cols-3">
<h2 id="related-content"><a class="anchor" href="#related-content"></a>Related Content</h2>
<div class="sectionbody">
<div class="ulist">
<div class="title">Learn more ...</div>
<ul>
<li>
<p></p>
</li>
<li>
<p><a href="icr-overview.html#introduction" class="page">Introducing Inter-Cluster Replication</a></p>
</li>
<li>
<p><a href="icr-delta-sync.html" class="page">Delta-sync</a></p>
</li>
<li>
<p><a href="icr-conflict-resolution.html" class="page">Conflict Resolution</a></p>
</li>
<li>
<p><a href="icr-replication-types.html" class="page">Replication Types</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Reference material ...</div>
<ul>
<li>
<p><a href="../refer/config-properties.html" class="page">Configuration Schema</a></p>
</li>
<li>
<p><a href="../refer/rest-api-public.html" class="page">Public REST API</a></p>
</li>
<li>
<p><a href="../refer/rest-api-admin.html" class="page">Admin REST API</a></p>
</li>
<li>
<p><a href="../advance/adv-rest-api-client.html" class="page">Use the REST API</a></p>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Additional Resources ...</div>
<ul>
<li>
<p><a href="https://forums.couchbase.com/c/mobile/14">Forum</a>  <strong>|</strong>  <a href="https://blog.couchbase.com/">Blog</a>   <strong>|</strong>  <a href="https://docs.couchbase.com/tutorials/index.html">Tutorials</a></p>
</li>
<li>
<p>Conflict Related Blogs: <a href="https://blog.couchbase.com/document-conflicts-couchbase-mobile/">Document Conflicts and Automatic Conflict Resolution</a>   <strong>|</strong>  <a href="https://blog.couchbase.com/conflict-resolution-couchbase-mobile/">Demystifying Conflict Resolution</a>  <strong>|</strong>  <a href="https://blog.couchbase.com/tag/conflict-resolution/">Conflict Resolution (category)</a></p>
</li>
</ul>
</div>
</div>
</div>
</article>
</main>
</div>
<footer class="footer">
  <div class="container">
    <div class="footer-links">
      <div class="col">
        <div class="footer-logo">
          <a href="https://www.couchbase.com" class="icon">
            <img src="../../../_/img/couchbase_logo_black.svg" alt="Couchbase">
          </a>
        </div>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://docs.couchbase.com" target="_blank" rel="noopener">Documentation</a></li>
          <li><a href="https://forums.couchbase.com" target="_blank" rel="noopener">Forums</a></li>
          <li><a href="https://support.couchbase.com" target="_blank" rel="noopener">Support</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://developer.couchbase.com" target="_blank" rel="noopener">Developer Portal</a></li>
          <li><a href="https://blog.couchbase.com" target="_blank" rel="noopener">Blog</a></li>
          <li><a href="https://www.couchbase.com/resources">Resources</a></li>
        </ul>
      </div>
      <div class="col">
        <ul>
          <li><a href="https://www.couchbase.com/get-started-developing-nosql">Get Started</a></li>
          <li><a href="https://www.couchbase.com/downloads">Downloads</a></li>
          <li><a href="https://learn.couchbase.com/store?utf8=%E2%9C%93&ss=1&ct=78327&commit=Filter" target="_blank" rel="noopener">Training</a></li>
        </ul>
      </div>
      <div class="col">
        <ul class="social-icons">
          <li>
            <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="facebook" class="cls-1" d="M29,0H3A2.652,2.652,0,0,0,0,3V29a2.652,2.652,0,0,0,3,3H16V18H12V14h4V12a6.452,6.452,0,0,1,6-6h4v4H22a2.151,2.151,0,0,0-2,2v2h6l-1,4H20V32h9a2.652,2.652,0,0,0,3-3V3A2.652,2.652,0,0,0,29,0Z"/></svg>
            <a href="https://www.facebook.com/Couchbase" class="icon">
            Facebook
            </a>
          </li>
          <li>
            <svg  width="14" height="14" viewBox="0 0 32.1 26.1"> <path id="twitter" class="cls-1" d="M32,7.1a11.836,11.836,0,0,1-3.8,1,6.462,6.462,0,0,0,2.9-3.6,12.606,12.606,0,0,1-4.2,1.6A6.492,6.492,0,0,0,22.1,4a6.594,6.594,0,0,0-6.6,6.6,7.719,7.719,0,0,0,.2,1.5A18.458,18.458,0,0,1,2.2,5.2a6.294,6.294,0,0,0-.9,3.3A6.765,6.765,0,0,0,4.2,14a6.109,6.109,0,0,1-3-.8v.1a6.543,6.543,0,0,0,5.3,6.4,4.678,4.678,0,0,1-1.7.2,4.869,4.869,0,0,1-1.2-.1,6.679,6.679,0,0,0,6.1,4.6,12.917,12.917,0,0,1-8.2,2.8,9.151,9.151,0,0,1-1.6-.1,18.438,18.438,0,0,0,10.1,3c12.1,0,18.7-10,18.7-18.7v-.8A13.336,13.336,0,0,0,32,7.2Z" transform="translate(0.1 -4)"/></svg>
            <a href="https://twitter.com/couchbase" class="icon">
              Twitter
            </a>
          </li>
          <li>
          <svg  width="14" height="14" viewBox="0 0 32 32"> <path id="linkedin" class="cls-1" d="M29,0H3A3.076,3.076,0,0,0,0,3V29a3.009,3.009,0,0,0,3,3H29a2.946,2.946,0,0,0,3-3V3A3.009,3.009,0,0,0,29,0ZM12,26H8V12h4ZM10,10a2,2,0,1,1,2-2A2.006,2.006,0,0,1,10,10ZM26,26H22V18a2,2,0,0,0-4,0v8H14V12h4v2.5c.8-1.1,2.1-2.5,3.5-2.5A4.736,4.736,0,0,1,26,17Z"/></svg>
              <a href="https://www.linkedin.com/company/couchbase" class="icon">
             Linkedin
            </a>
          </li>
        </ul>
      </div>
    </div>
    <div class="footer-terms">
      <div class="footer-terms-copyright">
          <span>© 2020 Couchbase, Inc. Couchbase, Couchbase Lite and the Couchbase logo are registered trademarks of Couchbase, Inc.</span>
      </div>
      <div class="footer-terms-links">
        <a href="https://www.couchbase.com/terms-of-use">Terms of Use</a>
        <a href="https://www.couchbase.com/privacy-policy">Privacy Policy</a>
        <a href="https://www.couchbase.com/cookie-policy">Cookie Policy</a>
        <a href="https://www.couchbase.com/support-policy">Support Policy</a>
        <a href="https://info.couchbase.com/unsubscribe-or-manage-preferences.html" target="_blank" rel="noopener">Marketing Preference Center</a>
      </div>
    </div>
  </div>
</footer>
<script src="../../../_/js/site.js"></script>
<script async src="../../../_/js/vendor/fontawesome-icon-defs.js"></script>
<script async src="../../../_/js/vendor/fontawesome.js"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
</body>
</html>
